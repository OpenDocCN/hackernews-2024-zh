- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: æœªåˆ†ç±»'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
  zh: 'category: æœªåˆ†ç±»'
- en: 'date: 2024-05-27 13:02:29'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
  zh: 'date: 2024-05-27 13:02:29'
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: Kuto, a reverse JS bundler
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kutoï¼Œä¸€ä¸ªåå‘JSæ‰“åŒ…å·¥å…·
- en: æ¥æºï¼š[https://samthor.au/2024/kuto/](https://samthor.au/2024/kuto/)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ¥æºï¼š[https://samthor.au/2024/kuto/](https://samthor.au/2024/kuto/)
- en: Kuto, a reverse JS bundler
  id: totrans-split-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kutoï¼Œä¸€ä¸ªåå‘JSæ‰“åŒ…å·¥å…·
- en: '[Kuto](https://kuto.dev) is a novel approach to shipping code on the web. It
    lets you re-use code a client *already has* for shipping updates.'
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
  zh: '[Kuto](https://kuto.dev) æ˜¯ä¸€ç§åœ¨ç½‘ç»œä¸Šäº¤ä»˜ä»£ç çš„æ–°æ–¹æ³•ã€‚å®ƒå…è®¸æ‚¨é‡å¤ä½¿ç”¨å®¢æˆ·ç«¯å·²æœ‰çš„ä»£ç ä»¥è¿›è¡Œæ›´æ–°ã€‚'
- en: 'For a ''real-world'' site with ~3mb of JS, updating the React dependency resulted
    in:'
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºä¸€ä¸ªæ‹¥æœ‰çº¦3mb JSçš„â€œçœŸå®ä¸–ç•Œâ€ç½‘ç«™ï¼Œæ›´æ–°Reactä¾èµ–é¡¹å¯¼è‡´ï¼š
- en: 71% smaller download
  id: totrans-split-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸‹è½½é‡å‡å°‘äº†71%
- en: 28% faster start time (on a ~5yo old phone, a [Pixel 3](https://en.wikipedia.org/wiki/Pixel_3)).
  id: totrans-split-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨~5å²çš„æ‰‹æœºä¸Šå¯åŠ¨æ—¶é—´å¿«äº†28%ï¼ˆ[Pixel 3](https://en.wikipedia.org/wiki/Pixel_3)ï¼‰ã€‚
- en: â€¦vs a single bundle, or any case where all the code is invalidated.
  id: totrans-split-11
  prefs: []
  type: TYPE_NORMAL
  zh: â€¦ä¸å•ä¸ªæ†ç»‘åŒ…æˆ–æ‰€æœ‰ä»£ç å¤±æ•ˆçš„ä»»ä½•æƒ…å†µç›¸æ¯”ã€‚
- en: Note that Kuto works really well on the final ESM bundles of real sites or apps,
    but probably *not* libraries themselves, even though Kuto's output will be valid.
    Kuto also works as a predictable 'chunk' generator for large bundles.
  id: totrans-split-12
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„ï¼ŒKutoåœ¨çœŸå®ç«™ç‚¹æˆ–åº”ç”¨ç¨‹åºçš„æœ€ç»ˆESMæ†ç»‘åŒ…ä¸Šæ•ˆæœéå¸¸å¥½ï¼Œä½†å¯èƒ½*ä¸*é€‚ç”¨äºåº“æœ¬èº«ï¼Œå°½ç®¡Kutoçš„è¾“å‡ºå°†æ˜¯æœ‰æ•ˆçš„ã€‚Kutoè¿˜ä½œä¸ºå¤§æ†ç»‘åŒ…çš„å¯é¢„æµ‹â€œå—â€ç”Ÿæˆå™¨è¿è¡Œã€‚
- en: If this is interesting to youâ€”do *you* have too much JavaScript?â€”then do the
    thing, and [do a Kuto on your code](https://kuto.dev). (Is Kuto a verb? Who knows.
    I'm trying it out.) âœ‚ï¸
  id: totrans-split-13
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœè¿™å¯¹æ‚¨æœ‰å…´è¶£â€”â€”æ‚¨æ˜¯å¦æœ‰å¤ªå¤šçš„JavaScriptï¼Ÿâ€”â€”é‚£ä¹ˆå°±å»åšå§ï¼Œå¹¶åœ¨æ‚¨çš„ä»£ç ä¸Šåšä¸€ä¸ªKutoã€‚ï¼ˆKutoæ˜¯ä¸€ä¸ªåŠ¨è¯å—ï¼Ÿè°çŸ¥é“ã€‚æˆ‘åœ¨è¯•éªŒã€‚ï¼‰âœ‚ï¸
- en: How does it work?
  id: totrans-split-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ
- en: Instead of focusing on minifying output or anything idempotent, Kuto takes a
    different route.
  id: totrans-split-15
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ä¸“æ³¨äºæœ€å°åŒ–è¾“å‡ºæˆ–ä»»ä½•å¹‚ç­‰æ“ä½œï¼ŒKutoé€‰æ‹©äº†ä¸€æ¡ä¸åŒçš„è·¯çº¿ã€‚
- en: 'On the first build:'
  id: totrans-split-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨ç¬¬ä¸€æ¬¡æ„å»ºæ—¶ï¼š
- en: Kuto splits source JS into a 'main' part, and a normally larger 'corpus' of
    code which has no side effects.
  id: totrans-split-17
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kutoå°†æºJSåˆ†æˆâ€œä¸»â€éƒ¨åˆ†å’Œé€šå¸¸æ›´å¤§çš„æ²¡æœ‰å‰¯ä½œç”¨çš„â€œä»£ç åº“â€ã€‚
- en: This corpus can be cached [forever](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#immutable),
    and a hashed timestamp is included in its output name.
  id: totrans-split-18
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™ä¸ªä»£ç åº“å¯ä»¥è¢«æ°¸ä¹…ç¼“å­˜ï¼ˆ[forever](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#immutable)ï¼‰ï¼Œå¹¶ä¸”å…¶è¾“å‡ºåç§°ä¸­åŒ…å«äº†ä¸€ä¸ªæ•£åˆ—æ—¶é—´æˆ³ã€‚
- en: 'On every further build:'
  id: totrans-split-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åœ¨æ¯æ¬¡è¿›ä¸€æ­¥æ„å»ºæ—¶ï¼š
- en: Kuto still splits out the source JS
  id: totrans-split-20
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kutoä»ç„¶å°†æºJSæ‹†åˆ†å‡ºæ¥
- en: It identifies code from any existing corpus that can be used to 'satisfy' the
    source JS
  id: totrans-split-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: å®ƒå¯ä»¥ä»ä»»ä½•ç°æœ‰çš„ä»£ç åº“ä¸­è¯†åˆ«å¯ä»¥ç”¨æ¥â€œæ»¡è¶³â€æºJSçš„ä»£ç ã€‚
- en: Each corpus will either stay the same or *shrink* as functions, statements etc
    change
  id: totrans-split-22
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ¯ä¸ªä»£ç åº“å°†ä¼šä¿æŒä¸å˜æˆ–*ç¼©å°*ï¼Œå¦‚å‡½æ•°ã€è¯­å¥ç­‰çš„å˜åŒ–
- en: Any code that cannot be satisfied is put into a brand new corpus, which can
    also be cached forever.
  id: totrans-split-23
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»»ä½•æ— æ³•æ»¡è¶³çš„ä»£ç å°†è¢«æ”¾å…¥ä¸€ä¸ªå…¨æ–°çš„ä»£ç åº“ä¸­ï¼Œè¿™ä¹Ÿå¯ä»¥æ°¸ä¹…ç¼“å­˜ã€‚
- en: 'This is a little complicated. Here''s a ~~gif~~ video:'
  id: totrans-split-24
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æœ‰ç‚¹å¤æ‚ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª~~gif~~è§†é¢‘ï¼š
- en: <https://storage.googleapis.com/hwhistlr.appspot.com/assets/kuto-demo.mp4>
  id: totrans-split-25
  prefs: []
  type: TYPE_NORMAL
  zh: <https://storage.googleapis.com/hwhistlr.appspot.com/assets/kuto-demo.mp4>
- en: Kuto will build an additional corpus when something changes
  id: totrans-split-26
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æŸäº›å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒKutoå°†æ„å»ºä¸€ä¸ªé¢å¤–çš„ä»£ç åº“
- en: After each build, you're likely to generate another corpus with changed code.
    (This will eventually be an issue with fragmentation, more on this later.)
  id: totrans-split-27
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯æ¬¡æ„å»ºåï¼Œæ‚¨å¾ˆå¯èƒ½ä¼šç”Ÿæˆå¦ä¸€ä¸ªå…·æœ‰æ›´æ”¹ä»£ç çš„ä»£ç åº“ã€‚ ï¼ˆè¿™æœ€ç»ˆå°†æˆä¸ºç¢ç‰‡åŒ–çš„é—®é¢˜ï¼Œç¨åè¯¦è¿°ã€‚ï¼‰
- en: Why does it work?
  id: totrans-split-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆå®ƒæœ‰æ•ˆï¼Ÿ
- en: Each corpus, once fetched by a client, can be cached forever. However, on every
    build, that corpus *may* shrink in size. New clients will get the smaller version.
    (Kuto's corpuses have a hashed timestamp, and you *do* have to set up your webserver
    to send the [right headers](https://web.dev/articles/love-your-cache) here).
  id: totrans-split-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªä»£ç åº“ä¸€æ—¦è¢«å®¢æˆ·ç«¯è·å–ï¼Œå°±å¯ä»¥æ°¸ä¹…ç¼“å­˜ã€‚ç„¶è€Œï¼Œæ¯æ¬¡æ„å»ºæ—¶ï¼Œè¯¥ä»£ç åº“*å¯èƒ½*ä¼šç¼©å°ã€‚æ–°å®¢æˆ·ç«¯å°†è·å¾—æ›´å°çš„ç‰ˆæœ¬ã€‚ï¼ˆKutoçš„ä»£ç åº“å…·æœ‰æ•£åˆ—æ—¶é—´æˆ³ï¼Œå¹¶ä¸”æ‚¨ç¡®å®éœ€è¦è®¾ç½®æ‚¨çš„WebæœåŠ¡å™¨ä»¥å‘é€æ­£ç¡®çš„[æ ‡å¤´](https://web.dev/articles/love-your-cache)ã€‚ï¼‰
- en: Butâ€¦this breaks all we know about caching responses on the web! I've changed
    an immutable file! ğŸ¤¯
  id: totrans-split-30
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯â€¦è¿™æ‰“ç ´äº†æˆ‘ä»¬å¯¹Webç¼“å­˜å“åº”çš„æ‰€æœ‰äº†è§£ï¼æˆ‘æ”¹å˜äº†ä¸€ä¸ªä¸å¯å˜çš„æ–‡ä»¶ï¼ğŸ¤¯
- en: The result is that older clients will have bigger files, and newer clients will
    have smaller ones, even for the same filename. But that bigger file simply has
    now-deprecated code. Kuto's primary thesis is that disk I/O to load a slightly
    bigger file than you need is faster than compling anew.
  id: totrans-split-31
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“æœæ˜¯è€å®¢æˆ·ç«¯å°†æœ‰æ›´å¤§çš„æ–‡ä»¶ï¼Œæ–°å®¢æˆ·ç«¯å°†æœ‰æ›´å°çš„æ–‡ä»¶ï¼Œå³ä½¿æ˜¯ç›¸åŒçš„æ–‡ä»¶åã€‚ä½†æ˜¯é‚£ä¸ªæ›´å¤§çš„æ–‡ä»¶ç°åœ¨åªæ˜¯æœ‰è¿‡æ—¶ä»£ç ã€‚Kutoçš„ä¸»è¦è®ºç‚¹æ˜¯ï¼ŒåŠ è½½æ¯”æ‚¨éœ€è¦çš„ç¨å¤§æ–‡ä»¶çš„ç£ç›˜I/Oé€Ÿåº¦æ¯”é‡æ–°ç¼–è¯‘è¦å¿«ã€‚
- en: (Note that at least [v8-based browsers](https://v8.dev/blog/code-caching-for-devs)
    cache the bytecode of the source, which provides the speed benefit. If you were
    compiling anew every time, Kuto wouldn't help.)
  id: totrans-split-32
  prefs: []
  type: TYPE_NORMAL
  zh: ï¼ˆè¯·æ³¨æ„è‡³å°‘ [åŸºäº v8 çš„æµè§ˆå™¨](https://v8.dev/blog/code-caching-for-devs) ç¼“å­˜æºä»£ç çš„å­—èŠ‚ç ï¼Œä»è€Œæä¾›é€Ÿåº¦ä¼˜åŠ¿ã€‚
    å¦‚æœæ¯æ¬¡é‡æ–°ç¼–è¯‘ï¼ŒKuto å°†æ— æ³•å¸®åŠ©ã€‚ï¼‰
- en: 'Aside the remarkably bonkers way this leverages your browser, Kuto also basically
    performs code-splitting in a completely predictable, useful and automated fashion.
    Other bundlers either require you to:'
  id: totrans-split-33
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤äº†è¿™ç§æ˜¾è‘—ç–¯ç‹‚çš„æ–¹å¼åˆ©ç”¨æ‚¨çš„æµè§ˆå™¨å¤–ï¼ŒKuto è¿˜åŸºæœ¬ä¸Šä»¥å®Œå…¨å¯é¢„æµ‹ã€æœ‰ç”¨å’Œè‡ªåŠ¨åŒ–çš„æ–¹å¼æ‰§è¡Œä»£ç æ‹†åˆ†ã€‚ å…¶ä»–æ†ç»‘å™¨è¦ä¹ˆè¦æ±‚æ‚¨ï¼š
- en: (not codesplit an output bundle at all)
  id: totrans-split-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ï¼ˆå®Œå…¨ä¸å¯¹è¾“å‡ºæ†ç»‘åŒ…è¿›è¡Œä»£ç æ‹†åˆ†ï¼‰
- en: explicitly mark dependencies to be put into their own bundle
  id: totrans-split-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ˜ç¡®æ ‡è®°ä¾èµ–é¡¹ä»¥æ”¾å…¥è‡ªå·±çš„æ†ç»‘åŒ…ä¸­ã€‚
- en: put code in bundles on (effectively) random boundaries, just trying to restrict
    the size of each 'chunk'.
  id: totrans-split-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨ï¼ˆå®é™…ä¸Šï¼‰éšæœºè¾¹ç•Œä¸Šæ”¾ç½®ä»£ç æ†ç»‘åŒ…ï¼Œè¯•å›¾é™åˆ¶æ¯ä¸ªâ€œå—â€çš„å¤§å°ã€‚
- en: No really, how does it work?
  id: totrans-split-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸æ˜¯çœŸçš„ï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ
- en: The above explanation was fairly high-level. At a lower level, Kuto looks for
    code with no side effects to include in its corpuses, and it uses circular dependencies
    to ensure they're safe to call.
  id: totrans-split-38
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸Šé¢çš„è§£é‡Šç›¸å½“é«˜çº§ã€‚ åœ¨æ›´ä½çš„çº§åˆ«ä¸Šï¼ŒKuto å¯»æ‰¾æ²¡æœ‰å‰¯ä½œç”¨çš„ä»£ç ï¼Œå°†å…¶åŒ…å«åœ¨å…¶è¯­æ–™åº“ä¸­ï¼Œå¹¶ä½¿ç”¨å¾ªç¯ä¾èµ–ç¡®ä¿å…¶å®‰å…¨è°ƒç”¨ã€‚
- en: No Side Effects
  id: totrans-split-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ²¡æœ‰å‰¯ä½œç”¨
- en: 'Turns out, defining a function has no side effects. No, really! The *definition*
    of a function does nothing except creates a variable:'
  id: totrans-split-40
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“æœï¼Œå®šä¹‰å‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ã€‚ ä¸ï¼ŒçœŸçš„ï¼ å‡½æ•°çš„*å®šä¹‰*é™¤äº†åˆ›å»ºä¸€ä¸ªå˜é‡å¤–ä»€ä¹ˆä¹Ÿä¸åšï¼š
- en: '[PRE0]'
  id: totrans-split-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Since `foo` isn''t *actually called*, and we declare it in a module scope,
    nothing happens. Until we run `foo`, it might as well be:'
  id: totrans-split-42
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äº `foo` *å®é™…ä¸Šæ²¡æœ‰è¢«è°ƒç”¨*ï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨æ¨¡å—èŒƒå›´å†…å£°æ˜å®ƒï¼Œæ‰€ä»¥ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿã€‚ ç›´åˆ°è¿è¡Œ `foo`ï¼Œå®ƒå¯èƒ½å¦‚åŒï¼š
- en: '[PRE1]'
  id: totrans-split-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Kuto takes this theory to the extreme, putting classes into the same form, and
    even arbitrary statements. We *hand wave* can hoist statements to be within a
    function.
  id: totrans-split-44
  prefs: []
  type: TYPE_NORMAL
  zh: Kuto å°†è¿™ä¸€ç†è®ºæ¨å‘æè‡´ï¼Œå°†ç±»æ”¾å…¥ç›¸åŒçš„å½¢å¼ä¸­ï¼Œç”šè‡³æ˜¯ä»»æ„è¯­å¥ã€‚ æˆ‘ä»¬*æ‰‹åŠ¿*å¯ä»¥å°†è¯­å¥æå‡ä¸ºå‡½æ•°å†…éƒ¨ã€‚
- en: Circular Dependencies
  id: totrans-split-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¾ªç¯ä¾èµ–
- en: Each corpus contains silo'ed^ functions which reference back to the main file
    in order to work out their dependencies. A good way to see this is to check out
    Kuto itself and run its "./release.sh" script, which builds Kuto itself this way.
  id: totrans-split-46
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªè¯­æ–™åº“éƒ½åŒ…å«ç‹¬ç«‹çš„^å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¼•ç”¨ä¸»æ–‡ä»¶ä»¥è§£æå®ƒä»¬çš„ä¾èµ–å…³ç³»ã€‚ æŸ¥çœ‹ Kuto æœ¬èº«å¹¶è¿è¡Œå…¶ "./release.sh" è„šæœ¬æ˜¯æŸ¥çœ‹æ­¤è¿‡ç¨‹çš„å¥½æ–¹æ³•ï¼Œè¿™æ ·æ„å»º
    Kuto æœ¬èº«ã€‚
- en: 'For a trivial site that appends a custom element to your page, where the custom
    element has changed and been rebuilt, this might look like:'
  id: totrans-split-47
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºä¸€ä¸ªç®€å•çš„ç½‘ç«™ï¼Œè¿½åŠ è‡ªå®šä¹‰å…ƒç´ åˆ°æ‚¨çš„é¡µé¢ï¼Œå…¶ä¸­è‡ªå®šä¹‰å…ƒç´ å·²æ›´æ”¹å¹¶é‡æ–°æ„å»ºï¼Œå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š
- en: '[PRE2]'
  id: totrans-split-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This all looks awkwardâ€¦and it is, but the output isn't really meant for human
    consumption, but we benefit from ESM's "seen as a bug" feature of circular dependencies.
  id: totrans-split-49
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆå°´å°¬â€¦â€¦ç¡®å®æ˜¯è¿™æ ·ï¼Œä½†è¾“å‡ºå¹¶ä¸æ˜¯çœŸæ­£ä¸ºäººç±»æ¶ˆè´¹è®¾è®¡çš„ï¼Œè€Œæ˜¯å› ä¸º ESM çš„â€œè¢«è§†ä¸ºé”™è¯¯â€ç‰¹æ€§è€Œä»ä¸­å—ç›Šï¼Œå¾ªç¯ä¾èµ–ã€‚
- en: ^Kuto will in future reference *between* corpuses
  id: totrans-split-50
  prefs: []
  type: TYPE_NORMAL
  zh: ^Kuto å°†åœ¨å°†æ¥å¼•ç”¨ *ä¹‹é—´* çš„è¯­æ–™åº“
- en: Should I use this?
  id: totrans-split-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æˆ‘åº”è¯¥ä½¿ç”¨è¿™ä¸ªå—ï¼Ÿ
- en: Maybe!
  id: totrans-split-52
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è®¸ï¼
- en: 'Kuto is new, and while the science says it works, it''s a bit weird. And as
    I''ve mentioned above, it works really well on:'
  id: totrans-split-53
  prefs: []
  type: TYPE_NORMAL
  zh: Kuto æ˜¯æ–°äº§å“ï¼Œè™½ç„¶ç§‘å­¦è¯´å®ƒæœ‰æ•ˆï¼Œä½†æœ‰ç‚¹å¥‡æ€ªã€‚ æ­£å¦‚æˆ‘ä¸Šé¢æåˆ°çš„ï¼Œå®ƒåœ¨ä»¥ä¸‹æ–¹é¢è¡¨ç°è‰¯å¥½ï¼š
- en: single bundle output sites
  id: totrans-split-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å•ä¸€æ†ç»‘åŒ…è¾“å‡ºç½‘ç«™
- en: that have a large JS bundle (maybe >1mb?)
  id: totrans-split-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é‚£äº›å…·æœ‰å¤§å‹ JS åŒ…ï¼ˆä¹Ÿè®¸ >1mbï¼Ÿï¼‰çš„ç½‘ç«™ã€‚
- en: â€¦which are made up of lots of top-level ESM code, such as functions and classes
  id: totrans-split-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: â€¦â€¦è¿™äº›éƒ½ç”±è®¸å¤šé¡¶çº§ ESM ä»£ç ç»„æˆï¼Œä¾‹å¦‚å‡½æ•°å’Œç±»
- en: 'You will need to:'
  id: totrans-split-57
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦åšçš„æ˜¯ï¼š
- en: use a regular bundler first
  id: totrans-split-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¦–å…ˆä½¿ç”¨å¸¸è§„çš„æ†ç»‘å·¥å…·
- en: keep or have access to your old build artifactsâ€”Kuto doesn't know what you *already
    shipped* by magic ğŸª„
  id: totrans-split-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¿ç•™æˆ–è®¿é—®æ‚¨çš„æ—§æ„å»ºå·¥ä»¶ â€”â€” Kuto ä¸çŸ¥é“æ‚¨å·²ç»é€šè¿‡é­”æœ¯ğŸª„*å·²ç»å‘è´§*ä»€ä¹ˆã€‚
- en: trade off a slightly larger *first load* for a better update experience
  id: totrans-split-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ›´å¥½çš„æ›´æ–°ä½“éªŒï¼Œéœ€è¦åœ¨ç¨å¤§çš„*é¦–æ¬¡åŠ è½½*ä¹‹é—´æƒè¡¡ã€‚
- en: The other issue with this is that more and more browsers are moving to a world
    where cache is regularly evicted. If your visitors don't have your site cached,
    then Kuto *is* pointlessâ€”every load is slightly more expensive for an update that
    never happens. YMMV.
  id: totrans-split-61
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œè¶Šæ¥è¶Šå¤šçš„æµè§ˆå™¨æ­£å‘ç¼“å­˜å®šæœŸåˆ é™¤çš„ä¸–ç•Œè¿ˆè¿›ã€‚ å¦‚æœæ‚¨çš„è®¿é—®è€…æ²¡æœ‰ç¼“å­˜æ‚¨çš„ç½‘ç«™ï¼Œåˆ™ Kuto *æ¯«æ— æ„ä¹‰* â€”â€”æ¯æ¬¡åŠ è½½å¯¹äºæ°¸è¿œä¸ä¼šå‘ç”Ÿçš„æ›´æ–°éƒ½ç¨å¾®æ˜‚è´µã€‚
    ä¸ªäººç»éªŒå¯èƒ½æœ‰æ‰€ä¸åŒã€‚
- en: Regardless, the tool emits a few statistics, including how much overhead the
    initial load costing you, and what % of code is able to be identifed as having
    "no side effects" and put into a corpus. And to be clear, running Kuto on tiny
    codebases has no benefitâ€”the 'cost' of parsing a few kb of JS is trivial, even
    for potato phones. ğŸ¥”
  id: totrans-split-62
  prefs: []
  type: TYPE_NORMAL
  zh: æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸ªå·¥å…·ä¼šè¾“å‡ºä¸€äº›ç»Ÿè®¡æ•°æ®ï¼ŒåŒ…æ‹¬åˆå§‹åŠ è½½ç»™ä½ å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œä»¥åŠèƒ½å¤Ÿè¯†åˆ«ä¸ºå…·æœ‰â€œæ— å‰¯ä½œç”¨â€çš„ä»£ç å æ€»ä»£ç çš„ç™¾åˆ†æ¯”ã€‚éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œåœ¨å°å‹ä»£ç åº“ä¸Šè¿è¡Œ
    Kuto æ²¡æœ‰ä»»ä½•å¥½å¤„â€”â€”å³ä½¿åœ¨åœŸè±†æ‰‹æœºä¸Šè§£æå‡  kb çš„ JS ä»£ç æˆæœ¬å¾®ä¹å…¶å¾®ã€‚ğŸ¥”
- en: So you can experiment and see if it works for you. My view is that Kuto will
    help for enterprise apps (because the JS is bloated, and no-one *really* cares)
    or social media (because power users come *so often*).
  id: totrans-split-63
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ä½ å¯ä»¥è¿›è¡Œå®éªŒï¼Œçœ‹çœ‹å®ƒå¯¹ä½ æ˜¯å¦æœ‰æ•ˆã€‚æˆ‘è®¤ä¸º Kuto å¯¹ä¼ä¸šåº”ç”¨ç¨‹åºä¼šæœ‰æ‰€å¸®åŠ©ï¼ˆå› ä¸º JS å¤ªè‡ƒè‚¿ï¼Œæ²¡æœ‰äºº*çœŸæ­£*å…³å¿ƒï¼‰ï¼Œæˆ–è€…ç¤¾äº¤åª’ä½“ï¼ˆå› ä¸ºç”µåŠ›ç”¨æˆ·*å¦‚æ­¤é¢‘ç¹*å‡ºç°ï¼‰ã€‚
- en: Fragmentation
  id: totrans-split-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: åˆ†è£‚
- en: Kuto generates multiple files over time. Right now, it actually only uses the
    top 4 (by size) previous bundles, although this is configurable by flag. This
    isâ€¦not very good, and I'm yet to come up with a good automatic metric as to when
    to 'clean up' vs 're-use'.
  id: totrans-split-65
  prefs: []
  type: TYPE_NORMAL
  zh: Kuto éšæ—¶é—´ç”Ÿæˆå¤šä¸ªæ–‡ä»¶ã€‚ç°åœ¨ï¼Œå®ƒå®é™…ä¸Šåªä½¿ç”¨äº†å‰ 4 ä¸ªï¼ˆæŒ‰å¤§å°æ’åºï¼‰ä¹‹å‰çš„æ†ç»‘åŒ…ï¼Œå°½ç®¡å¯ä»¥é€šè¿‡æ ‡å¿—è¿›è¡Œé…ç½®ã€‚è¿™â€¦â€¦ä¸å¤ªå¥½ï¼Œæˆ‘è¿˜æ²¡æœ‰æƒ³å‡ºä¸€ä¸ªå¥½çš„è‡ªåŠ¨åº¦é‡æ ‡å‡†æ¥å†³å®šä½•æ—¶â€œæ¸…ç†â€è€Œä¸æ˜¯â€œé‡ç”¨â€ã€‚
- en: 'Consider this though: if you just don''t provide Kuto with historic bundles,
    itâ€¦ obviously can''t use them. So you can decide whether that typo fix generating
    a 100-byte file is worth it for the *next build*.'
  id: totrans-split-66
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†è¯·è€ƒè™‘è¿™ä¸€ç‚¹ï¼šå¦‚æœä½ åªæ˜¯ä¸å‘ Kuto æä¾›å†å²æ†ç»‘åŒ…ï¼Œé‚£å®ƒâ€¦â€¦æ˜¾ç„¶å°±æ— æ³•ä½¿ç”¨å®ƒä»¬äº†ã€‚å› æ­¤ï¼Œä½ å¯ä»¥å†³å®šæ˜¯å¦ä¸º*ä¸‹ä¸€ä¸ªæ„å»º*å€¼å¾—ä¿®æ­£ä¸€ä¸ª 100 å­—èŠ‚çš„æ–‡ä»¶ä¸­çš„æ‹¼å†™é”™è¯¯ã€‚
- en: Why Only 28% Faster?
  id: totrans-split-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆåªå¿«äº† 28%ï¼Ÿ
- en: Ignoring some of the possible downsides, there's a big question for me at play.
    My test case above showed 71% reduction in size, but only 28% increase in speed.
    ğŸ¤”
  id: totrans-split-68
  prefs: []
  type: TYPE_NORMAL
  zh: å¿½ç•¥ä¸€äº›å¯èƒ½çš„è´Ÿé¢å½±å“ï¼Œæˆ‘åœ¨æ­¤é¢ä¸´ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚æˆ‘çš„æµ‹è¯•æ¡ˆä¾‹æ˜¾ç¤ºä½“ç§¯å‡å°‘äº† 71%ï¼Œä½†é€Ÿåº¦åªå¢åŠ äº† 28%ã€‚ğŸ¤”
- en: I have a suspicion that v8's assembly of a bunch of module code *is still quite
    costly*. Yes, it's great that huge chunks of static code can be outsourced and
    cached forever, but in the end, your website still needs to assemble it all together.
  id: totrans-split-69
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æ€€ç–‘ v8 å¯¹ä¸€å †æ¨¡å—ä»£ç çš„æ±‡ç¼–*ä»ç„¶ç›¸å½“æ˜‚è´µ*ã€‚æ˜¯çš„ï¼Œå°†å¤§å—é™æ€ä»£ç å¤–åŒ…å¹¶æ°¸ä¹…ç¼“å­˜æ˜¯å¾ˆæ£’çš„ï¼Œä½†æœ€ç»ˆï¼Œä½ çš„ç½‘ç«™ä»ç„¶éœ€è¦å°†æ‰€æœ‰è¿™äº›ç»„ä»¶æ±‡ç¼–åœ¨ä¸€èµ·ã€‚
- en: An Ask
  id: totrans-split-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªé—®é¢˜
- en: I would love to hear from you if Kuto makes a material difference to the way
    you bundle and update your code, even in just a theoretical test environment.
    Please feel free to contact me, including filing [a GitHub issue](https://github.com/samthor/kuto/issues/new),
    if you can give me some sweet, sweet numbers.
  id: totrans-split-71
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœ Kuto å¯¹ä½ çš„ä»£ç æ†ç»‘å’Œæ›´æ–°æ–¹å¼äº§ç”Ÿäº†å®è´¨æ€§å½±å“ï¼Œå³ä½¿åœ¨ç†è®ºæµ‹è¯•ç¯å¢ƒä¸­ï¼Œæˆ‘ä¹Ÿå¾ˆæ„¿æ„å¬åˆ°ä½ çš„æƒ³æ³•ã€‚å¦‚æœä½ èƒ½æä¾›ä¸€äº›ç”œç”œçš„æ•°æ®ï¼Œæ¬¢è¿éšæ—¶è”ç³»æˆ‘ï¼ŒåŒ…æ‹¬æäº¤
    [GitHub issue](https://github.com/samthor/kuto/issues/new)ã€‚
- en: Thanks
  id: totrans-split-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: è°¢è°¢
- en: Thanks for reading! Kuto has been incredibly interesting to build, yet honestly
    it's only taken me a few days of full-time engineering to make it work. It's been
    an idea I've been noodling on for a few years, and I'm really proud to have it
    come to fruition. ğŸ‡
  id: totrans-split-73
  prefs: []
  type: TYPE_NORMAL
  zh: è°¢è°¢é˜…è¯»ï¼Kuto çš„æ„å»ºè¿‡ç¨‹éå¸¸æœ‰è¶£ï¼Œä½†è€å®è¯´ï¼Œæˆ‘åªèŠ±äº†å‡ å¤©å…¨èŒå·¥ç¨‹çš„æ—¶é—´å°±è®©å®ƒè¿è¡Œèµ·æ¥äº†ã€‚è¿™ä¸ªæƒ³æ³•æˆ‘å·²ç»æ€è€ƒäº†å‡ å¹´ï¼Œç°åœ¨çœ‹åˆ°å®ƒå¾—ä»¥å®ç°ï¼Œæˆ‘æ„Ÿåˆ°éå¸¸è‡ªè±ªã€‚ğŸ‡
