- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: 未分类'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
  zh: 类别：未分类
- en: 'date: 2024-05-27 14:50:56'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
  zh: 日期：2024-05-27 14:50:56
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: DNSSEC vulnerability puts big chunk of the internet at risk • The Register
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DNSSEC漏洞将互联网的大部分内容置于风险之中 • The Register
- en: 来源：[https://www.theregister.com/2024/02/13/dnssec_vulnerability_internet/](https://www.theregister.com/2024/02/13/dnssec_vulnerability_internet/)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 来源：[https://www.theregister.com/2024/02/13/dnssec_vulnerability_internet/](https://www.theregister.com/2024/02/13/dnssec_vulnerability_internet/)
- en: Updated A single packet can exhaust the processing capacity of a vulnerable
    DNS server, effectively disabling the machine, by exploiting a 20-plus-year-old
    design flaw in the DNSSEC specification.
  id: totrans-split-6
  prefs: []
  type: TYPE_NORMAL
  zh: 更新 一份单一数据包可以利用DNSSEC规范中20多年的设计缺陷耗尽易受攻击的DNS服务器的处理能力，有效地使其失效。
- en: That would make it trivial to take down a DNSSEC-validating DNS resolver that
    has yet to be patched, upsetting all the clients relying on that service and make
    it seem as though websites and apps were offline.
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
  zh: 这将使尚未修补的DNSSEC验证的DNS解析器易受攻击，扰乱所有依赖该服务的客户端，并使网站和应用看似处于离线状态。
- en: The academics who found this flaw – associated with the German National Research
    Center for Applied Cybersecurity (ATHENE) in Darmstadt – claimed DNS server software
    makers briefed about the vulnerability described it as "the worst attack on DNS
    ever discovered."
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
  zh: 发现这一缺陷的学术界人士，来自德国应用网络安全研究国家中心（ATHENE）位于达姆施塔特，称DNS服务器软件制造商已被告知该漏洞被描述为“有史以来对DNS的最严重攻击”。
- en: Identified by Professor Haya Schulmann and Niklas Vogel of the Goethe University
    Frankfurt; Elias Heftrig of Fraunhofer SIT; and Professor Michael Waidner at the
    Technical University of Darmstadt and Fraunhofer SIT, the security hole has been
    named [KeyTrap](https://www.presseportal.de/pm/173495/5713546), designated [CVE-2023-50387](https://kb.isc.org/docs/cve-2023-50387),
    and assigned a CVSS severity rating of 7.5 out of 10.
  id: totrans-split-9
  prefs: []
  type: TYPE_NORMAL
  zh: 由法兰克福大学的Haya Schulmann教授和Niklas Vogel、Fraunhofer SIT的Elias Heftrig、以及达姆施塔特技术大学和Fraunhofer
    SIT的Michael Waidner教授发现，这一安全漏洞被命名为[KeyTrap](https://www.presseportal.de/pm/173495/5713546)，指定为[CVE-2023-50387](https://kb.isc.org/docs/cve-2023-50387)，并被评为10分中的7.5分的CVSS严重性评分。
- en: 'As of December 2023, approximately 31 percent of web clients worldwide used
    DNSSEC-validating DNS resolvers and, like other applications relying on those
    systems, would feel the effects of a KeyTrap attack: With those DNS servers taken
    out by the flaw, clients relying on them would be unable to resolve domain and
    host names to IP addresses to use, resulting in a loss of connectivity.'
  id: totrans-split-10
  prefs: []
  type: TYPE_NORMAL
  zh: 截至2023年12月，全球约31%的网络客户端使用DNSSEC验证的DNS解析器，像其他依赖这些系统的应用一样，将会感受到KeyTrap攻击的影响：由于这些DNS服务器受到漏洞的影响，依赖它们的客户端将无法解析域名和主机名到IP地址，导致连接丢失。
- en: The researchers said lone DNS packets exploiting KeyTrap could stall public
    DNSSEC-validated DNS services, such as those provided by Google and Cloudflare,
    by making them do calculations that overtax server CPU cores.
  id: totrans-split-11
  prefs: []
  type: TYPE_NORMAL
  zh: 研究人员称利用KeyTrap的单一DNS数据包可能使Google和Cloudflare等公共DNSSEC验证的DNS服务陷入停滞，通过让它们进行超负荷计算来达到这一目的。
- en: This disruption of DNS could not only deny people's access to content but could
    also interfere with other systems, including spam defenses, cryptographic defenses
    (PKI), and inter-domain routing security (RPKI), the researchers assert.
  id: totrans-split-12
  prefs: []
  type: TYPE_NORMAL
  zh: 这种DNS中断不仅可能阻止人们访问内容，还可能干扰其他系统，包括垃圾邮件防御、加密防御（PKI）和跨域路由安全（RPKI），研究人员指出。
- en: '"Exploitation of this attack would have severe consequences for any application
    using the Internet including unavailability of technologies such as web-browsing,
    e-mail, and instant messaging," they claimed. "With KeyTrap, an attacker could
    completely disable large parts of the worldwide internet."'
  id: totrans-split-13
  prefs: []
  type: TYPE_NORMAL
  zh: 他们声称：“利用此攻击将对使用互联网的任何应用程序产生严重后果，包括技术不可用，如网页浏览、电子邮件和即时通讯。”“使用KeyTrap，攻击者可以完全禁用全球互联网的大部分内容。”
- en: A non-public technical paper on the vulnerability provided to *The Register*,
    titled, "The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNS,"
    describes how an assault would be carried out. It basically involves asking a
    vulnerable DNSSEC-validating DNS resolver to look up an address that causes the
    server to contact a malicious nameserver that sends a reply that causes the resolver
    to consume most or all of its own CPU resources.
  id: totrans-split-14
  prefs: []
  type: TYPE_NORMAL
  zh: 针对这一漏洞提供给《注册》的一份非公开技术论文，标题为《关于DNS的KeyTrap拒绝服务算法复杂性攻击》，描述了攻击将如何进行。基本上，它涉及请求一个有漏洞的DNSSEC验证DNS解析器查找一个地址，导致服务器联系一个恶意域名服务器发送回复，使解析器消耗大部分或全部CPU资源。
- en: With KeyTrap, an attacker could completely disable large parts of the worldwide
    Internet
  id: totrans-split-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用 KeyTrap，攻击者可以完全禁用全球互联网的大部分。
- en: '"To initiate the attacks our adversary causes the victim resolver to look up
    a record in its malicious domain," the due-to-be-published paper states. "The
    attacker’s nameserver responds to the DNS queries with a malicious record set
    (RRset), according to the specific attack vector and zone configuration."'
  id: totrans-split-16
  prefs: []
  type: TYPE_NORMAL
  zh: '"为了发起攻击，我们的对手导致受害者解析器在其恶意域名中查找记录，" 即将发布的论文声明。 "攻击者的名称服务器用恶意记录集（RRset）回应 DNS
    查询，根据特定的攻击向量和区域配置。"'
- en: 'The attack works, the paper explains, because [the DNSSEC spec](https://datatracker.ietf.org/doc/rfc2535/)
    follows [Postel’s Law](https://www.cs.tufts.edu/comp/117/assts/postel): "The nameservers
    should send all the available cryptographic material, and the resolvers should
    use any of the cryptographic material they receive until the validation is successful."'
  id: totrans-split-17
  prefs: []
  type: TYPE_NORMAL
  zh: 该文章解释说，这种攻击有效，因为[DNSSEC 规范](https://datatracker.ietf.org/doc/rfc2535/)遵循[Postel
    法则](https://www.cs.tufts.edu/comp/117/assts/postel)："域名服务器应发送所有可用的加密材料，而解析器应使用它们接收到的任何加密材料，直到验证成功为止。"
- en: This requirement, to ensure availability, means DNSSEC-validating DNS resolvers
    can be forced to do a lot of work if presented with colliding key-tags and colliding
    keys that must be validated.
  id: totrans-split-18
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保可用性，DNSSEC 验证的 DNS 递归解析器如果收到必须验证的碰撞密钥标签和碰撞密钥，就会被迫做大量工作。
- en: '"Our complexity attacks are triggered by feeding the DNS resolvers with specially
    crafted DNSSEC records, which are constructed in a way that exploits validation
    vulnerabilities in cryptographic validation logic," the paper explains.'
  id: totrans-split-19
  prefs: []
  type: TYPE_NORMAL
  zh: '"我们的复杂性攻击是通过向 DNS 递归解析器提供特制的 DNSSEC 记录来触发的，这些记录是以一种利用加密验证逻辑中的验证漏洞的方式构建的，" 文章解释道。'
- en: '"When the DNS resolvers attempt to validate the DNSSEC records they receive
    from our nameserver, they get stalled. Our attacks are extremely stealthy, being
    able to stall resolvers between 170 seconds and 16 hours (depending on the resolver
    software) with a single DNS response packet."'
  id: totrans-split-20
  prefs: []
  type: TYPE_NORMAL
  zh: '"当 DNS 递归解析器尝试验证来自我们域名服务器的 DNSSEC 记录时，它们会被搁置。 我们的攻击非常隐蔽，能够通过单个 DNS 响应数据包在 170
    秒至 16 小时之间（取决于解析器软件）搁置解析器。"'
- en: The ATHENE boffins said they worked with all relevant vendors and major public
    DNS providers to privately disclose the vulnerability so a coordinated patch release
    would be possible. The last patch was finished today.
  id: totrans-split-21
  prefs: []
  type: TYPE_NORMAL
  zh: ATHENE 的专家表示，他们已与所有相关供应商和主要公共 DNS 提供商合作，以私下披露此漏洞，以便可能进行协调的补丁发布。 最后一个补丁今天完成。
- en: '"We are aware of this vulnerability and rolled out a fix in coordination with
    the reporting researchers," a Google spokesperson told *The Register*. "There
    is no evidence of exploitation and no action required by users at this time."'
  id: totrans-split-22
  prefs: []
  type: TYPE_NORMAL
  zh: '"我们知道这个漏洞，并与报告研究人员协调进行了修复，" Google 的一位发言人告诉*The Register*。 "目前没有利用的证据，用户目前不需要采取任何措施。"'
- en: Network research lab NLnet Labs published [a patch](https://nlnetlabs.nl/downloads/unbound/patch_CVE-2023-50387_CVE-2023-50868.diff)
    for its Unbound DNS software, addressing two vulnerabilities, one of which is
    KeyTrap. The other bug fixed, [CVE-2023-50868](https://nlnetlabs.nl/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt),
    referred to as the NSEC3 vulnerability, also allows denial of service through
    CPU exhaustion.
  id: totrans-split-23
  prefs: []
  type: TYPE_NORMAL
  zh: 网络研究实验室 NLnet Labs 发布了一个补丁，用于其 Unbound DNS 软件，解决了两个漏洞，其中一个是 KeyTrap。 另一个修复的
    bug，[CVE-2023-50868](https://nlnetlabs.nl/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt)，称为
    NSEC3 漏洞，还允许通过 CPU 耗尽进行拒绝服务。
- en: '"The KeyTrap vulnerability works by using a combination of keys (also colliding
    keys), signatures and number of RRSETs on a malicious zone," NLnet Labs [wrote](https://nlnetlabs.nl/news/2024/Feb/13/unbound-1.19.1-released/).
    "Answers from that zone can force a DNSSEC validator down a very CPU intensive
    and time costly validation path."'
  id: totrans-split-24
  prefs: []
  type: TYPE_NORMAL
  zh: '"KeyTrap 漏洞通过在恶意区域上使用密钥（也是碰撞密钥）、签名和 RRSET 的数量的组合来工作，" NLnet Labs [写道](https://nlnetlabs.nl/news/2024/Feb/13/unbound-1.19.1-released/)。
    "来自该区域的答案可以迫使 DNSSEC 验证器走上非常消耗 CPU 和时间的验证路径。"'
- en: PowerDNS, meanwhile, has an update [here](https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2024-01.html)
    to thwart KeyTrap exploitation.
  id: totrans-split-25
  prefs: []
  type: TYPE_NORMAL
  zh: PowerDNS 此时有一个更新[这里](https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2024-01.html)，以防止
    KeyTrap 的利用。
- en: '"An attacker can publish a zone that contains crafted DNSSEC related records.
    While validating results from queries to that zone using the RFC mandated algorithms,
    the Recursor’s resource usage can become so high that processing of other queries
    is impacted, resulting in a denial of service," the team wrote. "Note that any
    resolver following the RFCs can be impacted, this is not a problem of this particular
    implementation."'
  id: totrans-split-26
  prefs: []
  type: TYPE_NORMAL
  zh: '"攻击者可以发布一个包含精心设计的DNSSEC相关记录的区域。当使用RFC规定的算法验证对该区域的查询结果时，递归服务器的资源使用可能会变得非常高，从而影响其他查询的处理，导致服务拒绝，"
    团队写道。"请注意，任何遵循RFC的解析器都可能受到影响，这不是特定实现的问题。"'
- en: 'The fix for CVE-2023-50387 is just [one of six](https://seclists.org/oss-sec/2024/q1/125)
    vulnerabilities addressed in Internet Systems Consortium''s BIND 9 DNS software.
    The others include:'
  id: totrans-split-27
  prefs: []
  type: TYPE_NORMAL
  zh: CVE-2023-50387的修复仅仅是[互联网系统联盟的BIND 9 DNS软件](https://seclists.org/oss-sec/2024/q1/125)中解决的六个漏洞之一。其他漏洞包括：
- en: '[CVE-2023-4408](https://kb.isc.org/docs/cve-2023-4408): Parsing large DNS messages
    may cause excessive CPU load;'
  id: totrans-split-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[CVE-2023-4408](https://kb.isc.org/docs/cve-2023-4408): 解析大型DNS消息可能导致CPU负载过高；'
- en: '[CVE-2023-5517](https://kb.isc.org/docs/cve-2023-5517): Querying RFC 1918 reverse
    zones may cause an assertion failure when "nxdomain-redirect" is enabled;'
  id: totrans-split-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[CVE-2023-5517](https://kb.isc.org/docs/cve-2023-5517): 在启用“nxdomain-redirect”时，查询RFC
    1918反向区域可能导致断言失败；'
- en: '[CVE-2023-5679](https://kb.isc.org/docs/cve-2023-5679): Enabling both DNS64
    and serve-stale may cause an assertion failure during recursive resolution;'
  id: totrans-split-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[CVE-2023-5679](https://kb.isc.org/docs/cve-2023-5679): 启用DNS64和serve-stale可能在递归解析期间导致断言失败；'
- en: '[CVE-2023-6516](https://kb.isc.org/docs/cve-2023-6516): Specific recursive
    query patterns may lead to an out-of-memory condition;'
  id: totrans-split-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[CVE-2023-6516](https://kb.isc.org/docs/cve-2023-6516): 特定的递归查询模式可能导致内存不足；'
- en: '[CVE-2023-50868](https://kb.isc.org/docs/cve-2023-50868): Preparing an NSEC3
    closest encloser proof can exhaust CPU resources.'
  id: totrans-split-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[CVE-2023-50868](https://kb.isc.org/docs/cve-2023-50868): 准备NSEC3最接近封闭证明可能会耗尽CPU资源。'
- en: The requirements for the KeyTrap vulnerability date all the way back to 1999
    from the now obsolete RFC 2535, according to the research team that identified
    it. And by 2012, these elements appeared in [RFC 6781](https://datatracker.ietf.org/doc/rfc6781/)
    and [RFC 6840](https://datatracker.ietf.org/doc/rfc6840/), the implementation
    requirements for DNSSEC validation.
  id: totrans-split-33
  prefs: []
  type: TYPE_NORMAL
  zh: KeyTrap漏洞的要求可以追溯到1999年，根据研究团队的说法，这些要求来自现在已废弃的RFC 2535。到2012年，这些元素出现在[RFC 6781](https://datatracker.ietf.org/doc/rfc6781/)和[RFC
    6840](https://datatracker.ietf.org/doc/rfc6840/)中，这些是DNSSEC验证的实施要求。
- en: One packet suffices. You don't have to do more than that to disconnect an entire
    network
  id: totrans-split-34
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 只需一个数据包。你不必做更多，就可以断开整个网络的连接
- en: Since at least August 2000 – more than 23 years ago – KeyTrap has been present
    in the BIND 9 DNS resolver, and it surfaced seven years later in the Unbound DNS
    resolver.
  id: totrans-split-35
  prefs: []
  type: TYPE_NORMAL
  zh: 自2000年8月至少 – 超过23年前 – KeyTrap已存在于BIND 9 DNS解析器中，并且七年后出现在Unbound DNS解析器中。
- en: Dr Haya Shulman, a professor of computer science and one of the academics behind
    the KeyTrap research, told *The Register* in a phone interview the attack is simple
    and can be carried out by encoding it in a [zone file](https://dnsinstitute.com/documentation/dnssec-guide/ch04s02.html#signing-verify-zone-file).
  id: totrans-split-36
  prefs: []
  type: TYPE_NORMAL
  zh: Haya Shulman博士，计算机科学教授之一，也是KeyTrap研究背后的学术界人士之一，在电话采访中告诉《The Register》，这种攻击很简单，可以通过在[区域文件](https://dnsinstitute.com/documentation/dnssec-guide/ch04s02.html#signing-verify-zone-file)中编码来执行。
- en: '"The vulnerability is actually something that''s recommended in the DNSSEC
    standard," Prof Shulman explained. "One packet suffices. You don''t have to do
    more than that to disconnect an entire network."'
  id: totrans-split-37
  prefs: []
  type: TYPE_NORMAL
  zh: '"这个漏洞实际上是DNSSEC标准中推荐的内容，" Shulman教授解释道。"只需一个数据包。你不必做更多，就可以断开整个网络的连接。"'
- en: Prof Shulman said the patches that have been issued by various vendors break
    the standard. "The problem is this attack is not easy to solve," she said. "If
    we launch it against a patched resolver, we still get 100 percent CPU usage but
    it can still respond."
  id: totrans-split-38
  prefs: []
  type: TYPE_NORMAL
  zh: Shulman教授表示，各种供应商发布的补丁破坏了标准。"问题在于这种攻击不容易解决，" 她说道。"如果我们对已打过补丁的解析器发起攻击，我们仍然会得到100%的CPU使用率，但它仍然可以响应。"
- en: The ATHENE team observed that while the flaw remained undetected for decades,
    its obscurity isn't surprising because DNSSEC validation requirements are so complicated.
    So too is mitigating the vulnerability and completely eliminating it will require
    a revision of the DNSSEC standard. ®
  id: totrans-split-39
  prefs: []
  type: TYPE_NORMAL
  zh: ATHENE团队观察到，虽然这个漏洞数十年来一直未被发现，但其难以理解并不令人意外，因为DNSSEC验证要求非常复杂。减轻这种漏洞的影响，并完全消除它需要对DNSSEC标准进行修订。
- en: Updated to add on February 16
  id: totrans-split-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更新日期为2月16日
- en: You can now download the [technical paper here](https://www.athene-center.de/fileadmin/content/PDF/Technical_Report_KeyTrap.pdf)
    as a PDF.
  id: totrans-split-41
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以作为PDF文件下载[技术报告](https://www.athene-center.de/fileadmin/content/PDF/Technical_Report_KeyTrap.pdf)。
- en: Also, Akamai exec Sven Dummer thanked the research team for not only discovering
    the flaw but also working with DNS providers and software makers to coordinate
    the patching and redeployment of systems to avoid mass exploitation.
  id: totrans-split-42
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，Akamai执行官Sven Dummer感谢研究团队不仅发现了漏洞，还与DNS提供商和软件制造商合作，协调补丁的安装和系统重新部署，以避免大规模利用。
- en: '"You might not know it, but the global internet dodged a bullet: KeyTrap is
    a vulnerability in key infrastructure that is needed for the internet to function
    — and one of the worst ever discovered," he [opined](https://www.linkedin.com/posts/svenhdummer_cve-2023-50387-and-cve-2023-50868-dns-exploit-activity-7164147641054949377-4qwQ/).'
  id: totrans-split-43
  prefs: []
  type: TYPE_NORMAL
  zh: '"你可能不知道，但全球互联网躲过了一劫：KeyTrap是互联网必不可少的关键基础设施的一个漏洞 —— 也是有史以来发现的最糟糕的漏洞之一，" 他[评论道](https://www.linkedin.com/posts/svenhdummer_cve-2023-50387-and-cve-2023-50868-dns-exploit-activity-7164147641054949377-4qwQ/)。'
- en: '"With KeyTrap, an attacker could completely disable large parts of the worldwide
    internet."'
  id: totrans-split-44
  prefs: []
  type: TYPE_NORMAL
  zh: '"使用KeyTrap，攻击者可以完全禁用全球互联网的大部分内容。"'
