<!--yml

category: 未分类

date: 2024-05-27 14:34:23

-->

# 摩托罗拉的 6809：最佳 8 位？ - 由 Babbage 撰写

> 来源：[https://thechipletter.substack.com/p/motorolas-6809-the-best-8-bit](https://thechipletter.substack.com/p/motorolas-6809-the-best-8-bit)

*欢迎来到 Chip Letter。本周的短篇‘Chiplet’文章关于[Morris Chang、TSMC 和日本](https://thechipletter.substack.com/p/morris-chang-tsmc-and-japan)。目前仅供高级订阅者使用，下周将对所有人解锁。*

*下周的完整文章，**解密 GPU 计算软件**，是[解密 GPU 计算架构](https://thechipletter.substack.com/p/demystifying-gpu-compute-architectures)的补充，将探讨编程 GPU 的软件生态系统的故事。*

*今天，我们系列关于 8 位设计的最后一篇文章，聚焦于可能是 8 位时代最先进设计的摩托罗拉 6809。*

摩托罗拉 6809 的晶片图像 - 由Pauli Rautakorpi创作 - 自己的作品，CC BY 3.0，https://commons.wikimedia.org/w/index.php?curid=29982942

“这是一个故事。这是关于计算机的故事，具体来说是微型计算机的故事，以及一个特定的微处理器 - 其中革命性的社会变革潜伏在背后。这个故事本来可能是虚构的，但碰巧是真实的。”

Byte Magazine 论摩托罗拉 6809。

这是我们关于摩托罗拉 6800 8 位微处理器系列的第三篇，也是最后一篇文章。在[第一部分](https://thechipletter.substack.com/p/motorolas-pioneering-8-bit-6800-origins)，我们看到一个位于亚利桑那州凤凰城的小而才华横溢的团队开发了 6800。在[第二部分](https://thechipletter.substack.com/p/leaving-arizona)，摩托罗拉的管理层试图强迫该团队迁至德克萨斯州奥斯汀。该团队的大部分成员离开了摩托罗拉，其中包括 Chuck Peddle 和 Bill Mensch，他们加入了宾夕法尼亚州的 MOS Technology 公司，创造了 6502。

6800 在 1970 年代末的家用计算机激增竞争中败给了 6502。更便宜且功能更强大的 6502 被用于苹果 II、Commodore 的 PET 和 64、BBC 微机等许多流行设计中。

但这并不是 6800 系列的终结。摩托罗拉在奥斯汀重新建立了团队，并吸引了包括通用汽车在内的大客户，后者将 6800 用于其新的发动机控制系统。

> 当时通用汽车每年可能出货 6,000,000 辆车：每月 500,000 辆车。这是一个每个系统使用大约四个芯片的系统。这是一个大生意。

并且随着通用汽车的交易，6800 突然成为一个非常大的生意。

> ... 摩托罗拉的微处理器销量从零增长到了约 2.5 亿美元，几乎一夜之间，也许一年到一年半左右。并且利润丰厚。

有了大客户和成功的盈利业务，6800系列的演变继续进行。1989年Motorola微处理器数据手册概述了当时所有设计变体的概况。

而且[Retro StackExchange](https://retrocomputing.stackexchange.com/questions/11911/whats-the-timeline-of-motorola-6800-family-cpus-from-1974-to-1979)对这些关键变种有很好的描述。

> **6800**: "于1974年3月宣布，并在同年年底开始全面生产。" "M6800微计算机系统最终在1974年11月开始生产。"
> 
> **68A00**, **68B00**: "这些新型号在1976年7月就已经推出。"
> 
> **6802**, **6808**: 添加了内置时钟（仅6802）和128字节的RAM。于1977年3月3日宣布。
> 
> **6801**, **6803**: 添加了16位的“D”寄存器，作为A和B的串联，以及各种新指令，包括乘法。通常情况下，这款或者非常相似的微控制器早在1977年就被通用汽车公司使用；
> 
> **6809**: 我能找到的最早提及月份的记录是在一篇Elsevier期刊上。这似乎不太可能是最初的公告，但很可能是在投入生产之前很久。（6809并没有在1977年12月的《Byte》杂志背页上销售。）
> 
> **6805**: 专为控制器应用优化；不兼容的体系结构变化，如X寄存器减少到8位。它可能早在1977年或1978年就在Motorola内部存在：“这是‘77-‘78时间段--他们过来说，‘嘿，我们想要一个这个6805变种的CMOS版本。’（M14605是CMOS 6805。它和几个6805变种在1979年发布的数据手册中有详细资料。archive.org上有1980年的《M6805 M14605系列用户手册》。
> 
> **68HC05**: "05系列的低功耗变种," "在1979年12月发货。"
> 
> 如果你对这个编号方案中的“空缺”感到好奇：**6804**是1982年左右发布的6805的成本降低型修改版。**6806**和**6807**的命名从未使用过，据我所知。**6810**是一个RAM芯片。**6811**是1984年推出的6801扩展版。**6812**进一步扩展了6811，但直到1990年代才出现。从6820开始的零件从一开始就是外围设备。

一般来说，这些都是对原始6800微处理器的轻微变种，调整了指令集，增加了一些额外的RAM，或者采用了更先进的制造工艺。

其中一种新设计比其他更为雄心勃勃。那就是6809。

到了1977年，Motorola看到关键竞争对手正在研发更先进的16位设计。英特尔于1978年推出了8086，而智微（Zilog）正在研发Z8000。因此，奥斯汀的团队开始研发一种能与英特尔和智微的新设计竞争的先进16位设计。

> …那时候我个人的感觉是，我们将要取代小型计算机，如果你愿意的话。它将非常高端，可能会卖几百美元，两三百美元，但它对我们的客户来说非常有价值，并且有非常高的利润率，会带来很多其他类型的部件。

那种设计最终成为了16/32位的摩托罗拉68000，最终成为英特尔8086的主要竞争对手。

这种设计的复杂性和成本使得摩托罗拉面临了一个缺口。然而，许多客户并不愿意为像68000这样先进的CPU付费。到那时，摩托罗拉已经在6800设计上有了广泛的变体。但这些变体无法解决6800架构比其主要的8位竞争对手如6502和Z80弱的问题。因此，为了更好地竞争这些设计，摩托罗拉创建了一种新的8位架构，即6809。

6809被设计为与6800的‘源代码’兼容。用6800汇编语言编写的程序可以在6809上汇编和运行。然而，为6800创建的机器码不能在6809上运行，因为许多6800‘操作码’的含义已经改变。

在我们讨论指令集之前，先来看看6809的实现情况。更复杂的68000将大量使用‘微码’。然而，更简单的6809可以采用与6800基本相同的设计方法。‘可编程逻辑阵列’或‘PLA’将控制6809的大部分操作。我们可以将6800和6809并排放置，看到它们在布局上的相似之处，PLA在顶部，逻辑在中部，寄存器和‘算术逻辑单元’在底部。

6800 vs 6809芯片照片：由Pauli Rautakorpi制作 - 自己的作品，CC BY 3.0，https://commons.wikimedia.org/w/index.php?curid=53469083

6809团队如何决定在架构中添加哪些功能？与[John Cocke](https://thechipletter.substack.com/p/the-first-risc-john-cocke-and-the)和开创性的RISC架构IBM 801类似，他们着手分析现有的6800程序。他们的结论是？

> 最常见的指令明显是加载和存储指令，占所有6800指令的38%以上。其次是子程序调用和返回占13%，条件分支占11%，无条件跳转和分支占6.5%……与预期不同的是，算术和逻辑指令的使用率并不高。因此，改进数据移动（如加载和存储）的功能和效能将带来最大的投资回报，其次是改进子程序链接和参数传递。

然而，值得注意的是，他们的分析仅限于对6800机器代码中操作次数的“静态”检查，而非对哪些指令最常执行的“动态”分析，例如因为它们在循环内重复执行。

分析的其他结论包括：

> …索引指令的偏移量显示，93%的偏移量要么为0，要么小于32。

而且大多数不为零。

因此，6809增加了一些指令，可以将整数加到16位索引寄存器中。来自Rodnay Zak的‘Programming the 6809’：

其他新增功能包括：

##### 直接页寄存器

使6502如此成功的其中一点是，它广泛使用‘零页’，或者内存位置0到255。由于寄存器数量非常有限，6502依赖于使用‘零页’来访问频繁使用的值。访问这些值更快，因为只需要一个地址字节来指定地址。6809通过添加一个新的8位“直接页”寄存器增强了零页的使用，允许将“零页”移动到16位地址空间中的任何位置。

##### ‘U’堆栈指针

6809添加了一个‘用户’堆栈指针寄存器 - 名为‘U’ - 作为现有‘S’堆栈指针的补充。

##### 分支相对寻址

在6800（以及Z80和6502）中，有“分支”指令，程序计数器会跳转到附近的地址，地址由单字节“偏移量”确定。要跳转到超出此范围的地址，必须为目标代码指定两字节的“绝对地址”。这意味着代码通常不能是“位置无关的”，它必须被写入以存储在内存中预定的一组位置。

6809通过添加能够分支到完整64K内存范围内的地址的能力改变了这一点，方法是指定一个将添加到程序计数器的两字节值。这意味着编译或汇编的代码可能是“位置无关的”，并且可以在内存中的任何地址加载和运行。

##### D寄存器

“16位累加器D”是Motorola对A（最高有效字节）和B（最低有效字节）累加器组合的称呼。D寄存器可以通过单个指令加载。

##### 乘法指令

最后，对于一款8位处理器而言，6809首次添加了一个（8位）乘法指令。

> 包括一个乘法指令，可以在累加器A和B中乘以无符号二进制数，并将结果放入16位累加器D中。此无符号乘法指令还允许有符号或无符号多精度乘法。

到1979年初，摩托罗拉准备向世界推出6809，并以三篇Byte杂志文章的方式风靡一时。系列文章以可能在当时看来有些过分的文本开篇。

> 这是一个故事。这是关于计算机总体的故事，特别是微型计算机，尤其是关于一个特定的微处理器的故事——革命性的社会变革潜藏在背景中。这个故事本来可能是虚构的，但碰巧是真实的。

到1979年初，第一批16位微处理器已经问世或广为人知即将问世。6809引人注目，但并非革命性。幸运的是，接下来的文章系列更专注于为读者提供关于6809开发的有趣见解。

强调了6809项目的两位主要贡献者，乔尔·博尼（Joel Boney）和特里·里特（Terry Ritter），两人都在奥斯汀工作：

> 乔尔·博尼（Joel Boney）和特里·里特（Terry Ritter）就职于摩托罗拉6800微处理器设计组，位于德克萨斯州奥斯汀。乔尔负责软件输入到6800系列处理器和外设设计中，并且是M6809的共同架构师。特里·里特是微组件架构师，负责规格化6809高级微处理器。

设计6809的任务分解为几个独立的阶段：

> 复杂大规模集成（LSI）部件的设计可以方便地分为三个阶段：架构设计、逻辑和电路设计/架构审查，以及布局软件和硬件（面包板）模拟。每个阶段都有其自身的要求。
> 
> 逻辑设计包括制作逐周期流程图，并推导出实现指定设计所需的方程式和逻辑电路。
> 
> 布局是实际的任务，即安排晶体管和互连以实现逻辑图。电路设计结果将指示适当的晶体管尺寸和多晶硅宽度；现在必须按最小面积排列它们。尽一切可能制作可以在集成电路的许多地方使用的通用逻辑“单元”，但面积最小化是主要关注点。

布局绘图仪器现场操作 - 来源于1979年3月的Byte杂志

> 芯片的布局最终仅存在于计算机数据库中。每个单元都被数字化到计算机中，可以根据需要任意定位、修改或复制。

Byte文章的完整副本可供高级订阅者在本文末尾下载，还包括所有关于6809的Byte系列文章的链接。

6809与竞争产品相比如何？罗德内·扎克斯（Rodnay Zaks）的《编程6809》一书（请参见本文末尾的链接）中提到：

> 当你掌握了本书中的材料后，你将理解到，当6809系统经过正确设计和编程时，可以以8位经济性实现接近16位性能。

这是一个非常大胆的说法！能够站得住脚吗？我们看了一下"Once More through the Sieve"中一系列当代系统的性能。

那篇文章关注的是1983年一篇Byte文章，对一系列系统的性能进行了简单测试。

那么6809与之比较如何？

在6809上运行的汇编语言版本的测试，花费了5.1秒，而Z80花费了6.8秒，6502花费了13.9秒（每种情况下的时钟速度未指定）。与首批16位处理器比较，5MHz的8088花费了4.1秒，8MHz的8086花费了2.9秒，但Motorola自家的8MHz 68000只需0.49秒即可完成。

因此，6809与Intel的8088竞争激烈，但在Motorola自家的68000面前完全不敌。

6809推出时备受瞩目，其性能接近Intel首批16位设计。这足以让它产生影响吗？它确实在早期引起了兴趣，包括在苹果Macintosh设计团队内。根据[folklore.org](https://www.folklore.org/Five_Different_Macs.html)

> “1979年末设计的第一块Macintosh数字板，根据杰夫·拉斯金的规格设计：它采用了Motorola 6809E微处理器，64K内存，并且拥有256x256的黑白位图图形显示。
> 
> 第一台Macintosh是一台可爱的小型计算机，但它受到了只有16位地址空间的6809微处理器的根本限制。

但是苹果已经在开发Lisa，它采用了68000，并且在Macintosh中重用了一些Lisa优化过的68000汇编源代码，因此6809很快就被其更强大的表兄所取代。

6809在生产计算机中最知名的用途或许是在Tandy Color Computer上。该设计有一个令人惊讶的起源故事：作为肯塔基农民终端项目“绿色拇指”的一部分。引自为美国国会制定的文件。

> "绿色拇指"，由肯塔基合作延伸服务和肯塔基大学农业学院测试的实验性视文本项目，始于1977年，旨在为农民提供实时天气、市场和农业信息。由于沃尔特·鲁迪斯特参议员（D-Ky.）的努力，农业部提供了20万美元，国家气象局提供了10万美元用于肯塔基两个县的试点项目。技术委员会确定了硬件规格后，进行了设备投标。Motorola赢得了用户终端或“绿色拇指盒子”的合同，而Western Union提供了两个县的主机计算机；Tandy Corporation的计算机部门后来与Motorola合作制造用户终端。从托德县和谢尔比县选出了200名农民参与这个试验，该项目于1980年3月开始运行。

这个设计被改进，以创建 Tandy 可以销售给家庭用户的计算机。虽然称为 Tandy TRS-80 Color，但它与使用 Z80 处理器的前身 TRS-80 模型几乎没有任何共同之处。

Motorola 提供了 Tandy Color 的所有关键组件，并向第三方提供了参考计算机设计。其他公司很容易使用该参考设计来构建自己版本的设计。其中一家这样做的公司位于距离奥斯汀数千英里之外的英国威尔士。威尔士国旗上有一条龙，因此被命名为 Dragon Data，并推出了基于 Motorola 6809 参考设计的家用计算机，Dragon 32。

Dragon 32 后来被拥有 64KB RAM 的 Dragon 64 所取代。早在 1980 年代初期，家用计算机市场开始萎缩，Dragon Data 很快陷入财政困境，并被一个西班牙初创公司收购，但该公司几年后也失败了。

针对更复杂和雄心勃勃的 8 位处理器，Motorola 投资于可以充分利用新设计能力的软件开发。因此，他们委托 Microware 开发了 6809 的 BASIC 解释器和操作系统。

> 第一个版本（“OS-9 Level One”），追溯至 1979-1980 年，是为 Motorola 6809 CPU 编写的汇编语言，其所有进程都在 CPU 的 64KB 地址空间内运行，没有内存管理单元。它是作为 6809 开发的一部分，由 Motorola 承包的 BASIC09 项目的支持操作系统开发的。

OS-9 将继续开发和移植，首先到 68000，然后到一系列其他处理器架构，包括 PowerPC、Arm 和 Intel 的 x86，并且今天仍在嵌入式应用中使用。

6809 还出现在几款街机游戏中，包括流行的‘Defender’。

6809 的架构改进了其前身，但仍然是一个架构上的死胡同。未来在于 8086、68000 和它们的后续产品。

与 Byte 文章的夸张描述相反，6809 并不是革命性的，它是进化的。作为一个 8 位设计，它有一些明显的局限性。

6809 的设计者并没有试图解决竞争对手 8 位设计中可能最重要的限制之一，即它们仅限于 64KB 内存。到了 1980 年代初期，即使是廉价的家用计算机也在使用整个 64K 地址空间。使用外部内存管理单元 6829，可以将 6809 的内存扩展到高达 2 MB。根据 6829 的手册，该芯片：

> • 将内存地址空间从 64K 扩展到 2 MB
> 
> • 提供任务隔离和写保护
> 
> • 提供高效的内存分配；每个 2K 字节有 1024 页

但也许限制了6809的采用最大因素是Motorola自家的68000，也于1979年推出。16/32位68000的野心意味着它与6800或6809没有任何共同之处，因此从6809到68000的合理升级路径并不存在。6809的架构虽然优于其前身，但仍然是一个架构的死胡同。未来属于8086、68000及其后继者。

* * *

经过付费墙后，完整的1979年1月《Byte》文章以及有关6809、TRS-80 Color和Dragon 32的进一步阅读链接。
