- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-29 12:48:10'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
- en: Easy privilege escalation exploit lands for Linux kernels • The Register
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://www.theregister.com/2024/03/29/linux_kernel_flaw/](https://www.theregister.com/2024/03/29/linux_kernel_flaw/)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A Linux privilege-escalation proof-of-concept exploit has been published that,
    according to the bug hunter who developed it, typically works effortlessly on
    kernel versions between at least 5.14 and 6.6.14.
  id: totrans-split-6
  prefs: []
  type: TYPE_NORMAL
- en: Running the exploit as a normal user on a vulnerable machine will grant you
    root access to the box, allowing you to do whatever you want on it. This can be
    used by rogue insiders or malware already on a computer to cause further damage
    and problems.
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
- en: This affects [Debian](https://security-tracker.debian.org/tracker/CVE-2024-1086),
    [Ubuntu](https://ubuntu.com/security/CVE-2024-1086), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=2262126),
    [Fedora](https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7LSPIOMIJYTLZB6QKPQVVAYSUETUWKPF/),
    and no doubt other Linux distributions. The flaw finder, known by the handle Notselwyn,
    issued a [highly detailed](https://pwning.tech/nftables/) technical report of
    the bug this week, and said their exploit had a success rate of 99.4 percent on
    kernel 6.4.16, for instance.
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
- en: The vulnerability is tracked as [CVE-2024-1086](https://nvd.nist.gov/vuln/detail/CVE-2024-1086).
    It is rated 7.8 out of 10 in terms of CVSS severity. It was [patched](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f342de4e2f33e0e39165d8639387aa6c19dff660)
    at the end of January, updates have been rolling out since then, and if you haven't
    yet upgraded your vulnerable kernel and local privilege escalation (LPE) is a
    concern, take a closer look at this thing.
  id: totrans-split-9
  prefs: []
  type: TYPE_NORMAL
- en: '"Never had I ever gotten so much joy developing a project, specifically when
    dropping the first root shell with the bug," Notselwyn enthused.'
  id: totrans-split-10
  prefs: []
  type: TYPE_NORMAL
- en: 'The flaw is a double-free bug in the Linux kernel''s netfilter component involving
    nf_tables. As the US National Vulnerability Database explained:'
  id: totrans-split-11
  prefs: []
  type: TYPE_NORMAL
- en: All of that can lead to a crash or arbitrary code execution in the kernel upon
    exploitation. Before heading out for the Easter weekend we'd suggest patching
    first, again if LPE is a critical issue for you, so the only headache that greets
    you on Monday morning is pain from too much chocolate.
  id: totrans-split-12
  prefs: []
  type: TYPE_NORMAL
- en: In their analysis, Notselwyn details the steps needed to drop a universal root
    shell on nearly all affected Linux kernels using CVE-2024-1086\. This includes
    a particularly interesting method that builds on an earlier Linux kernel universal
    exploit technique, dubbed [Dirty Pagetable](https://yanglingxi1993.github.io/dirty_pagetable/dirty_pagetable.html),
    that involves abusing heap-based bugs to manipulate page tables to gain unauthorized
    control over a system's memory and thus operation.
  id: totrans-split-13
  prefs: []
  type: TYPE_NORMAL
- en: 'The latest method has been called Dirty Pagedirectory, and Notselwyn says it
    allows unlimited, stable read/write access to all memory pages in a Linux system,
    which would give an attacker full control over the box:'
  id: totrans-split-14
  prefs: []
  type: TYPE_NORMAL
- en: Notselwyn has also shared the source code to an [exploit PoC](https://github.com/Notselwyn/CVE-2024-1086),
    which is "trivial" to run.
  id: totrans-split-15
  prefs: []
  type: TYPE_NORMAL
- en: Exploiting the bug requires that the unprivileged-user namespaces option be
    set to access nf_tables, which is enabled by default on Debian, Ubuntu, and other
    major distributions. An attacker would then need to trigger a double-free, scan
    the physical memory for the kernel base address, bypassing KASLR, and then access
    the modprobe_path kernel variable with read/write privileges.
  id: totrans-split-16
  prefs: []
  type: TYPE_NORMAL
- en: After overwriting the modprobe_path, the exploit starts a root shell, and then
    it's game over. ®
  id: totrans-split-17
  prefs: []
  type: TYPE_NORMAL
