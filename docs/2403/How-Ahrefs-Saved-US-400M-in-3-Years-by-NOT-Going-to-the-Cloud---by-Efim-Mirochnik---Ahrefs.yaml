- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: 未分类'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
  zh: 'category: 未分类'
- en: 'date: 2024-05-29 12:36:54'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
  zh: 'date: 2024-05-29 12:36:54'
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: How Ahrefs Saved US$400M in 3 Years by NOT Going to the Cloud | by Efim Mirochnik
    | Ahrefs
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何通过不去云中节省了4亿美元 | 作者：Efim Mirochnik | Ahrefs
- en: 来源：[https://tech.ahrefs.com/how-ahrefs-saved-us-400m-in-3-years-by-not-going-to-the-cloud-8939dd930af8?gi=10fa74faaed3](https://tech.ahrefs.com/how-ahrefs-saved-us-400m-in-3-years-by-not-going-to-the-cloud-8939dd930af8?gi=10fa74faaed3)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 来源：[https://tech.ahrefs.com/how-ahrefs-saved-us-400m-in-3-years-by-not-going-to-the-cloud-8939dd930af8?gi=10fa74faaed3](https://tech.ahrefs.com/how-ahrefs-saved-us-400m-in-3-years-by-not-going-to-the-cloud-8939dd930af8?gi=10fa74faaed3)
- en: How Ahrefs Saved US$400M in 3 Years by NOT Going to the Cloud
  id: totrans-split-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何通过不去云中节省了4亿美元的Ahrefs
- en: 'Clouds for IT infrastructure are so popular lately that moving into the cloud
    has become a trend. Infrastructure as a service (IaaS) cloud provides multiple
    advantages: flexibility, low time for deployment, easy scaling, instant presence
    in many regions of the world, and many others.'
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
  zh: 最近IT基础设施的云使用如此流行，以至于进入云已成为一种趋势。基础设施即服务（IaaS）云提供了多种优势：灵活性、快速部署时间、易于扩展、即时在世界多个地区的存在等等。
- en: Cloud service providers have become knowledgeable outsourcers of IT services,
    providing convenient and often easy-to-use services. With excellent marketing,
    conferences, certifications, and cherry-picked use case scenarios, it’s easy for
    one to think that clouds are the only reasonable destination for the IT of a modern
    business.
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
  zh: 云服务提供商已成为IT服务的知识性外包者，提供方便且通常易于使用的服务。凭借出色的营销、会议、认证和精心挑选的用例场景，人们很容易认为云是现代企业IT的唯一合理选择。
- en: 'But the costs of these outsourced cloud benefits are sometimes high. They’re
    so high we were concerned about whether our business could exist if our infrastructure
    was 100% in the cloud. This inspired us to make an actual comparison based on
    facts. And here they are:'
  id: totrans-split-9
  prefs: []
  type: TYPE_NORMAL
  zh: 但这些外包云服务的成本有时候很高。它们如此之高，以至于我们担心如果我们的基础设施100%在云中，我们的业务是否能够存在。这激发了我们根据事实进行实际比较。以下是具体情况：
- en: '**Ahrefs’ own hardware overview**'
  id: totrans-split-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**Ahrefs自有硬件概述**'
- en: Ahrefs has a rented colocation data center in Singapore with a rather homogenous
    infrastructure. So we decided to consolidate all the costs spent for this data
    center, divide them by the number of servers, and compare them to the cost of
    a similar installation in the Amazon Web Services (AWS) cloud (we use this as
    the leading IaaS example).
  id: totrans-split-11
  prefs: []
  type: TYPE_NORMAL
  zh: Ahrefs在新加坡租用了一个托管数据中心，其基础设施相对均匀。因此，我们决定汇总为此数据中心花费的所有成本，将其除以服务器数量，并将其与Amazon
    Web Services（AWS）云中类似安装的成本进行比较（我们将其用作领先的IaaS示例）。
- en: Ahrefs servers
  id: totrans-split-12
  prefs: []
  type: TYPE_NORMAL
  zh: Ahrefs服务器
- en: Our hardware is relatively new. The colocation contract started in the middle
    of 2020, during the peak of the COVID-19 lockdowns. All the installed equipment
    had been bought since then. Our servers in this data center have similar configurations.
    The only difference is in the CPUs of two generations with the same number of
    cores. We use high core-count CPUs, 2TB RAM, and 2x 100Gbps per server. On average,
    our servers have about 16x 15TB drives.
  id: totrans-split-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的硬件相对较新。云托管合同始于2020年中期，当时正值COVID-19封锁高峰期。所有安装的设备自那时以来都已购买。我们在这个数据中心的服务器配置相似，唯一的区别在于两代CPU核心数相同。我们使用高核心数的CPU，2TB内存和每台服务器的2x
    100Gbps。平均而言，我们的服务器大约有16x 15TB硬盘驱动器。
- en: For the monthly cost calculation, we assumed that all the hardware will be used
    for only five years. We decided to consider anything beyond five years a “freebie.”
    Based on this, the monthly part of the initial equipment cost is its original
    price divided by 5*12 = 60 months.
  id: totrans-split-14
  prefs: []
  type: TYPE_NORMAL
  zh: 对于月度成本计算，我们假设所有硬件只会使用五年。我们决定将五年后的任何内容视为“免费赠品”。基于此，初始设备成本的月度部分是其原始价格除以5*12 =
    60个月。
- en: All the current costs, such as rent and electricity, are as of October 2022\.
    Although inflation affects us too, trying to account for it makes these calculations
    much harder, so we’ve ignored it for now.
  id: totrans-split-15
  prefs: []
  type: TYPE_NORMAL
  zh: 所有当前的成本，如租金和电费，截至2022年10月。虽然通货膨胀也影响我们，但是试图考虑进去会使这些计算变得更加困难，所以我们目前忽略了这一点。
- en: 'Our colocation payments consist of two major parts: rent and *de facto* consumed
    metered electricity. The electricity price has significantly increased since the
    beginning of 2022\. But we calculated our monthly charges based on the latest,
    higher electricity charges, not on the average for the whole rental period, which
    would be lower. Therefore, this should give AWS an advantage.'
  id: totrans-split-16
  prefs: []
  type: TYPE_NORMAL
- en: Also, we pay for IP Transit and dark fiber between the data center and our point
    of presence.
  id: totrans-split-17
  prefs: []
  type: TYPE_NORMAL
- en: The following table shows our monthly spending per server. Server hardware takes
    up two-thirds of the overall monthly expenditure, while the data center rent with
    electricity (DC), internet service providers (ISP) with IP Transit, dark fiber
    (DF), and internal network hardware (Network HW) make up the remaining one-third.
  id: totrans-split-18
  prefs: []
  type: TYPE_NORMAL
- en: Our own on-premise hardware cost structure
  id: totrans-split-19
  prefs: []
  type: TYPE_NORMAL
- en: '**AWS cost structure**'
  id: totrans-split-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Since our colocation in review is in Singapore, we used AWS prices for their
    Asia Pacific (Singapore) region for comparison.
  id: totrans-split-21
  prefs: []
  type: TYPE_NORMAL
- en: The cost structure for AWS is different from the colocation. Unfortunately,
    AWS doesn’t provide an EC2 instance with the number of cores we have. So we found
    an EC2 configuration with half the cores and 1TB RAM. We then compared one Ahrefs
    server cost to the cost of two such EC2 instances.
  id: totrans-split-22
  prefs: []
  type: TYPE_NORMAL
- en: Also, we considered long-term EC2 usage. Thus, we compared the lowest price
    of a three-year reserved EC2 instance to five years of on-premises servers.
  id: totrans-split-23
  prefs: []
  type: TYPE_NORMAL
- en: 'Apart from EC2 instances, we added Elastic Block Storage (EBS). It is not an
    accurate replacement for directly attached storage, as we use big and fast NVMe
    drives in the servers. To make things simple, we chose cheaper *gp3* EBS (much
    slower than ours, though). Its cost consists of two parts: storage size and charges
    for IOPS.'
  id: totrans-split-24
  prefs: []
  type: TYPE_NORMAL
- en: 'We keep two copies of a data chunk on our servers. But we only order usable
    space in EBS that takes care of the replication for us. So we should consider
    the price of the *gp3* storage size equal to the size of our drives divided by
    2: (1*1TB + 16*15TB)/2 ≈ 120TB per server.'
  id: totrans-split-25
  prefs: []
  type: TYPE_NORMAL
- en: We didn’t add the cost of higher IOPS. We also discarded various limitations
    EBS *gp3* has; for example, *gp3* Max Throughput/Instance is 10GB/s. At the same
    time, the performance of a single PCIe Gen 4 NVMe drive is 6–7GB/s, and we have
    16 of those working in parallel. Thus, it’s not an apples-to-apples comparison.
    But this approach should significantly reduce the cost of storage in AWS, giving
    it a further advantage.
  id: totrans-split-26
  prefs: []
  type: TYPE_NORMAL
- en: Unlike in the colocation, AWS charges per GB downloaded, not for bandwidth.
    So we roughly estimated what our average download per server is and used the figure
    for the AWS network calculation.
  id: totrans-split-27
  prefs: []
  type: TYPE_NORMAL
- en: Bringing all three components together, we have the following cost distribution
    for AWS.
  id: totrans-split-28
  prefs: []
  type: TYPE_NORMAL
- en: AWS cost structure
  id: totrans-split-29
  prefs: []
  type: TYPE_NORMAL
- en: '**Own hardware vs. AWS**'
  id: totrans-split-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Upon consolidating the above tables, we see that the imaginary AWS spending
    is much, much higher.
  id: totrans-split-31
  prefs: []
  type: TYPE_NORMAL
- en: Own hardware vs. AWS EC2 monthly spending
  id: totrans-split-32
  prefs: []
  type: TYPE_NORMAL
- en: A replacement EC2 instance with similar usable SSD space in AWS would cost us
    roughly the same amount of money for 11.3 servers in a colocation data center.
    Accordingly, that means our 20-server rack would transform into just ~2 servers.
  id: totrans-split-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在 AWS 中用类似的可用 SSD 空间替换一个 EC2 实例，对我们而言，与合作数据中心的 11.3 台服务器大致需要相同金额。因此，这意味着我们的
    20 台服务器机架将转变为大约只有 2 台服务器。
- en: Cost of 20 Ahrefs servers compared to cost of 2 servers in AWS
  id: totrans-split-34
  prefs: []
  type: TYPE_NORMAL
  zh: 与 AWS 中的 2 台服务器成本相比，Ahrefs 的 20 台服务器成本
- en: So let’s say we run our 850 servers during the actual 2½ years of our data center
    usage. Once we compute the numbers, we can see a dramatic difference.
  id: totrans-split-35
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，假设我们在实际的 2½ 年数据中心使用期间运行了我们的 850 台服务器。一旦计算出数字，我们就能看到显著的差异。
- en: AWS vs. On-Prem costs for 850 servers within 30 months
  id: totrans-split-36
  prefs: []
  type: TYPE_NORMAL
  zh: 850 台服务器的 AWS 与本地成本在 30 个月内的比较
- en: We would need to pay AWS a whopping **~USD** **400 million** more to keep our
    infrastructure running in Singapore since 2020.
  id: totrans-split-37
  prefs: []
  type: TYPE_NORMAL
  zh: 自 2020 年以来，我们需要向 AWS 支付额外的**~USD 4 亿** 美元来维持我们在新加坡的基础设施运行。
- en: One may think, “Perhaps Ahrefs can afford this?”
  id: totrans-split-38
  prefs: []
  type: TYPE_NORMAL
  zh: 有人可能会想：“也许 Ahrefs 负担得起这个？”
- en: It’s true that Ahrefs is a profitable and sustainable company, so let’s take
    a look at its revenue and use it in our calculations. That being said, we are
    a private company and aren’t obliged to publish our financial data. But one can
    find some information about Ahrefs’ revenue in The Straits Times articles on Singapore’s
    fastest-growing companies in [2022](https://www.straitstimes.com/fastest-growing-companies-2022)
    and [2023](https://www.straitstimes.com/fastest-growing-companies-2023). These
    articles provide Ahrefs’ revenue figures for the years 2020 and 2021.
  id: totrans-split-39
  prefs: []
  type: TYPE_NORMAL
  zh: Ahrefs 确实是一家盈利和可持续发展的公司，因此让我们看看它的收入并在我们的计算中使用它。话虽如此，我们是一家私营公司，没有义务公布我们的财务数据。但人们可以在《海峡时报》的有关《新加坡最快增长的公司
    2022》和《2023》的文章中找到关于 Ahrefs 2020 年和 2021 年收入的一些信息。
- en: We can linearly extrapolate revenue for 2022 too. It is a rough estimate. But
    it is enough for us to draw some conclusions.
  id: totrans-split-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以对 2022 年的收入进行线性外推。这只是一个粗略的估算。但这已足以让我们得出一些结论。
- en: Ahrefs’ 2020–2022 revenue estimations
  id: totrans-split-41
  prefs: []
  type: TYPE_NORMAL
  zh: Ahrefs 2020–2022 年的收入估算
- en: From the table above, we can see that Ahrefs’ total revenue for the last three
    years was ~USD 257 million. But we also calculated that the AWS costs would be
    ~USD 448 million for such a data center replacement. Thus, the company revenue
    wouldn’t even be close to covering the 2½-year AWS usage costs.
  id: totrans-split-42
  prefs: []
  type: TYPE_NORMAL
  zh: 从上表中，我们可以看到 Ahrefs 过去三年的总收入约为 2.57 亿美元。但我们还计算出 AWS 成本将约为 4.48 亿美元用于替换这样一个数据中心。因此，公司的收入甚至不足以覆盖
    2½ 年 AWS 使用成本。
- en: What a stunning result!
  id: totrans-split-43
  prefs: []
  type: TYPE_NORMAL
  zh: 多么令人震惊的结果！
- en: But where would all our profit go?
  id: totrans-split-44
  prefs: []
  type: TYPE_NORMAL
  zh: 但我们的所有利润将去哪里？
- en: 'As per [this 20-year-old report by Dr. LJ Hart-Smith for Boeing](https://www.documentcloud.org/documents/69746-hart-smith-on-outsourcing.html):
    “If the prime manufacturer, or systems integrator, cannot make his fortune by
    giving all his work away, who does benefit? The subcontractors, of course.”'
  id: totrans-split-45
  prefs: []
  type: TYPE_NORMAL
  zh: 根据[这份由波音公司的 L.J. 哈特-史密斯博士于 20 年前撰写的报告](https://www.documentcloud.org/documents/69746-hart-smith-on-outsourcing.html)：“如果主要制造商或系统集成商不能通过放弃所有工作来赚取财富，那么谁会从中受益？当然是分包商。”
- en: It is good to remember that we already provided several advantages to AWS by
    using higher-than-average electricity costs for our colocation data center, calculating
    only the storage part of EBS, and ignoring how slow the EBS storage is. Also,
    this data center is not the only cost center for us. We spend money on other data
    centers, servers, services, people, offices, marketing activities, etc.
  id: totrans-split-46
  prefs: []
  type: TYPE_NORMAL
  zh: 值得记住的是，我们已经通过使用高于平均水平的电费来为我们的合作数据中心计算 EBS 的存储部分，并忽略了 EBS 存储的慢速性，为 AWS 提供了几个优势。此外，这个数据中心并不是我们的唯一成本中心。我们还在其他数据中心、服务器、服务、人员、办公室、市场活动等方面花费了资金。
- en: Therefore, Ahrefs would hardly survive if a cloud was our primary infrastructure
    destination.
  id: totrans-split-47
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果云是我们的主要基础设施目的地，Ahrefs 几乎无法生存。
- en: Other considerations
  id: totrans-split-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他考虑因素
- en: This article doesn’t take into account other aspects that would make the comparison
    even more complicated. These include people skills, financial controls, cash flow,
    capacity planning depending on the load type, etc.
  id: totrans-split-49
  prefs: []
  type: TYPE_NORMAL
  zh: 本文并未考虑到其他会使比较变得更加复杂的因素。这些因素包括人员技能、财务控制、现金流、根据负载类型的容量规划等。
- en: '**Conclusion**'
  id: totrans-split-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**结论**'
- en: Ahrefs has saved **~USD** **400 million** by ensuring its infrastructure is
    NOT 100% in the IaaS cloud during the last 2½ years. This figure is growing bigger,
    as currently we are starting another massive colocation data center with new hardware.
  id: totrans-split-51
  prefs: []
  type: TYPE_NORMAL
- en: While Ahrefs uses AWS benefits for hosting our frontend in different parts of
    the world, the vast majority of Ahrefs’ infrastructure iceberg hides in the colocation
    with owned hardware. **Ahrefs wouldn’t be profitable, or even exist, if our products
    were 100% on AWS.**
  id: totrans-split-52
  prefs: []
  type: TYPE_NORMAL
- en: If we used a cloud-only approach, our infrastructure costs would be 10+ times
    higher. But because we don’t do that, we can spend the money we saved on actual
    product improvements and developments. Consequently, having faster and better
    results means that our servers are much faster than what a cloud can provide (given
    its limitations). Our reports are also generated faster and are more comprehensive,
    as the time needed per report is shorter.
  id: totrans-split-53
  prefs: []
  type: TYPE_NORMAL
- en: On that note, I recommend CFOs, CEOs, and business owners interested in sustainable
    growth to consider and periodically re-evaluate cloud benefits vs. actual costs.
    While clouds are the natural go-to choice for an early-stage startup, staying
    100% in clouds with substantial infrastructure may sink a company as it and its
    infrastructure grow.
  id: totrans-split-54
  prefs: []
  type: TYPE_NORMAL
- en: And here comes the dilemma.
  id: totrans-split-55
  prefs: []
  type: TYPE_NORMAL
- en: It is complicated to leave a cloud once you are there. A cloud is convenient
    and locked in. Also, abandoning a cloud infrastructure due to higher costs may
    not be what the engineering team wants. They may rightly view a cloud as a much
    easier and more flexible environment compared to old-fashioned brick-and-mortar
    data centers with physical servers.
  id: totrans-split-56
  prefs: []
  type: TYPE_NORMAL
- en: For a more mature company, [migrating from the cloud to its own infrastructure](https://world.hey.com/dhh/we-stand-to-save-7m-over-five-years-from-our-cloud-exit-53996caa)
    is difficult. It will also be challenging to keep the company alive during the
    migration. But such a painful move may be what saves the company, as it can avoid
    paying an increasing cut of its revenue to cloud service providers.
  id: totrans-split-57
  prefs: []
  type: TYPE_NORMAL
- en: Big companies, FAANG in particular, vacuumed the job market for many years.
    They had been hiring engineers to run their enormous data centers and infrastructure,
    leaving only a few for smaller companies. But with the mass layoffs in Big Tech
    in recent months, this may be an opportunity to re-evaluate the approach to the
    cloud, consider a reverse migration from the cloud, and hire seasoned professionals
    of the data center world.
  id: totrans-split-58
  prefs: []
  type: TYPE_NORMAL
- en: And if you start a new company, consider buying a rack and server and putting
    them in your basement. That might improve your sustainability from day one.
  id: totrans-split-59
  prefs: []
  type: TYPE_NORMAL
