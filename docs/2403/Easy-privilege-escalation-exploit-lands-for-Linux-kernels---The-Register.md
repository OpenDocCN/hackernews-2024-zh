<!--yml

类别：未分类

日期：2024-05-29 12:48:10

-->

# Linux 内核易于特权提升利用登场 • The Register

> 来源：[https://www.theregister.com/2024/03/29/linux_kernel_flaw/](https://www.theregister.com/2024/03/29/linux_kernel_flaw/)

发布了一种 Linux 特权提升的概念验证利用程序，根据其开发者所述，通常可以轻松在至少 5.14 到 6.6.14 内核版本之间运行。

在受影响的机器上以普通用户身份运行该利用程序将授予您对系统的 root 访问权限，使您可以在其上进行任何想做的事情。这可能被内鬼或已在计算机上的恶意软件用来造成进一步的损害和问题。

这影响了[Debian](https://security-tracker.debian.org/tracker/CVE-2024-1086)、[Ubuntu](https://ubuntu.com/security/CVE-2024-1086)、[Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=2262126)、[Fedora](https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7LSPIOMIJYTLZB6QKPQVVAYSUETUWKPF/) 等 Linux 发行版。漏洞发现者，以 Notselwyn 的身份知名，发布了一份[高度详细](https://pwning.tech/nftables/)的漏洞技术报告，并表示他们的利用在例如内核 6.4.16 上有 99.4% 的成功率。

此漏洞被跟踪为[CVE-2024-1086](https://nvd.nist.gov/vuln/detail/CVE-2024-1086)。根据 CVSS 评估，其严重性评分为 7.8 分（满分 10 分）。在一月底已经[修补](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f342de4e2f33e0e39165d8639387aa6c19dff660)，自那时以来已经推出了更新，如果您尚未升级受影响的内核且本地特权升级（LPE）是一个关注点，请仔细研究此事。

“我从未像开发这个项目那样获得如此多的快乐，特别是当用这个漏洞第一次放置 root shell 时”，Notselwyn 兴奋地说道。

此漏洞是 Linux 内核的 netfilter 组件中的双重释放漏洞，涉及 nf_tables。正如美国国家漏洞数据库所解释的那样：

所有这些都可能导致内核在利用后崩溃或执行任意代码。在复活节周末前，我们建议优先打补丁，再次强调如果 LPE 对您至关重要，这样周一早晨迎接您的唯一头痛将是吃了太多巧克力引起的疼痛。

在他们的分析中，Notselwyn 详细说明了使用 CVE-2024-1086 在几乎所有受影响的 Linux 内核上放置通用 root shell 所需的步骤。这包括一种特别有趣的方法，建立在早期 Linux 内核通用利用技术的基础上，被称为[Dirty Pagetable](https://yanglingxi1993.github.io/dirty_pagetable/dirty_pagetable.html)，利用堆基础的漏洞来操纵页表，从而获取对系统内存及其操作的未经授权的控制。

最新的方法被称为Dirty Pagedirectory，Notselwyn称其允许在Linux系统中对所有内存页面进行无限制、稳定的读写访问，这将使攻击者完全控制该系统：

Notselwyn还分享了一个[漏洞 PoC](https://github.com/Notselwyn/CVE-2024-1086)的源代码，这个漏洞“轻而易举”就能运行。

利用这个漏洞需要设置非特权用户命名空间选项以访问nf_tables，这在Debian、Ubuntu和其他主要发行版上默认启用。然后攻击者需要触发双重释放，扫描物理内存以获取内核基地址，绕过KASLR，然后以读写权限访问modprobe_path内核变量。

在覆盖modprobe_path后，利用程序启动了一个root shell，之后游戏就结束了。®
