<!--yml

category: 未分类

date: 2024-05-29 12:48:07

-->

# 关于 2024 年 3 月 7 日 Tailscale.com 停机事件

> 来源：[https://tailscale.com/blog/tls-outage-20240307](https://tailscale.com/blog/tls-outage-20240307)

2024 年 3 月 7 日，由于 TLS 证书过期，tailscale.com 在约 90 分钟内不可用。我们迅速发现并解决了问题，停机主要限于我们的营销资料和文档，但以下几个例外受到了影响。然而，任何意外的停机都是一个问题，我们希望借此机会详细解释发生了什么、影响如何以及我们已经采取的措施，以确保不再发生类似情况。

## 发生了什么[](#what-happened)

我们在 2023 年 12 月进行了一次重大的网站更新，包括迁移到新的托管提供商，正好是停机前大约 90 天。敏锐的读者可能会认出这个细节作为前兆。我们的配置也有些不寻常：因为我们的托管提供商不原生支持 IPv6，而 IPv6 对我们和我们的用户都很重要，因此我们运行自己的代理来解决这类请求，并相应地列出“额外”的 AAAA 记录。

供应商将该安排视为“配置错误”，自我们推出以来一直在接收有关它的警报。我们并没有意识到（警报也没有具体说明）该配置将阻止自动证书更新完成。再加一点倒霉：尽管我们有检查证书过期的探测器，但它们只在 IPv6 上进行检查。因此，我们的探测器没有显示出即将到期的证书，因为它们在击中独立管理的有效证书的代理时。

在没有自动更新的情况下，tailscale.com 和 www.tailscale.com 的证书于 3 月 7 日过期，导致无法访问该网站。

## 影响[](#the-impact)

幸运的是，大多数 Tailscale 操作不需要访问主网站，因此许多用户没有遇到正常使用的任何中断。主要的中断反而是：

+   Tailscale 文档，位于 [https://tailscale.com/kb](https://tailscale.com/kb)，在停机期间无法访问，以及我们的博客和其他通过我们的网站提供的参考资料。

+   虽然我们的管理控制台和其他设置页面未受影响，但不知道如何直接导航到 [https://login.tailscale.com/](httsp://login.tailscale.com) 的用户无法访问这些页面，并可能认为它们处于离线状态。

+   我们的快速安装脚本，托管在 [https://tailscale.com/install.sh](https://tailscale.com/install.sh)，也无法使用，影响了一些安装（包括一些自动安装）。

实际上为Tailscale安装提供服务的域名仍然可以访问，我们认为通过Go的`go get`机制的解析中断很少，[得益于缓存](https://go.dev/blog/supply-chain#the-vcs-is-the-source-of-truth)。

## [修复步骤](#steps-to-fix)

一旦确定了问题所在，我们的响应是暂时移除“额外”的AAAA记录，并手动更新相关的证书。这立即解决了用户面临的问题。

当然，我们仍希望我们的网站和服务能通过IPv6提供，因此我们立即恢复了这些记录。这意味着更新的根本问题仍然存在，并且我们计划在短期内解决它，就像我们的祖先一样：设置多个冗余的日历提醒和指定的时间窗口来手动更新证书。我们还计划更新我们的探测器基础设施，以分别检查IPv4和IPv6端点。

我们还希望通过在我们的网站基础设施中更直接地支持IPv6，使我们的代理变得不再必要。

最后，尽管我们会努力避免任何中断，但Tailscale设计的一个好处是，这种小问题并未中断大多数用户的大多数使用。我们的一个指导原则是支持您的设备和服务之间的直接连接，这意味着您的网络不那么依赖于任何特定的端点——即使是tailscale.com——在任何特定时间可用。
