- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: æœªåˆ†ç±»'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
  zh: 'category: æœªåˆ†ç±»'
- en: 'date: 2024-05-27 15:04:05'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
  zh: 'date: 2024-05-27 15:04:05'
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: 'Anatomy of a mapserver: how to leverage and visualize your geographical data'
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åœ°å›¾æœåŠ¡å™¨çš„è§£å‰–å­¦ï¼šå¦‚ä½•åˆ©ç”¨å’Œå¯è§†åŒ–æ‚¨çš„åœ°ç†æ•°æ®
- en: æ¥æºï¼š[https://www.go-inicio.com/blog/anatomy-of-a-mapserver-how-to-leverage-and-visualize-your-geographical-data](https://www.go-inicio.com/blog/anatomy-of-a-mapserver-how-to-leverage-and-visualize-your-geographical-data)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ¥æºï¼š[https://www.go-inicio.com/blog/anatomy-of-a-mapserver-how-to-leverage-and-visualize-your-geographical-data](https://www.go-inicio.com/blog/anatomy-of-a-mapserver-how-to-leverage-and-visualize-your-geographical-data)
- en: '**Anatomy of a mapserver: how to leverage and visualize your geographical data**'
  id: totrans-split-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**åœ°å›¾æœåŠ¡å™¨çš„è§£å‰–å­¦ï¼šå¦‚ä½•åˆ©ç”¨å’Œå¯è§†åŒ–æ‚¨çš„åœ°ç†æ•°æ®**'
- en: 'At Inicio we built Eywa, an algorithm that can find the best solar power plant
    location, using billions of geographical data points. Sometimes, it can be hard
    to make sense of all this data: forests, wet areas, cadastral parcels, etc.'
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Inicio æˆ‘ä»¬å»ºç«‹äº† Eywaï¼Œä¸€ä¸ªå¯ä»¥ä½¿ç”¨æ•°åäº¿åœ°ç†æ•°æ®ç‚¹æ‰¾åˆ°æœ€ä½³å¤ªé˜³èƒ½å‘ç”µå‚ä½ç½®çš„ç®—æ³•ã€‚æœ‰æ—¶ï¼Œç†è§£æ‰€æœ‰è¿™äº›æ•°æ®å¯èƒ½å¾ˆå›°éš¾ï¼šæ£®æ—ã€æ½®æ¹¿åœ°åŒºã€åœ°ç±ç­‰ã€‚
- en: To help our teams get a sense of what this data actually **looks** like, we
    set up a tool to allow visualization in multiple clients. Itâ€™s a server that builds
    maps, it is built on a library called MapServer.
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å¸®åŠ©æˆ‘ä»¬çš„å›¢é˜Ÿå¯¹è¿™äº›æ•°æ®å®é™…**çœ‹èµ·æ¥**æ˜¯ä»€ä¹ˆæœ‰æ‰€äº†è§£ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªå·¥å…·ï¼Œå…è®¸åœ¨å¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œå¯è§†åŒ–ã€‚å®ƒæ˜¯ä¸€ä¸ªæ„å»ºåœ°å›¾çš„æœåŠ¡å™¨ï¼Œå»ºç«‹åœ¨ä¸€ä¸ªåä¸º
    MapServer çš„åº“ä¸Šã€‚
- en: 'Now, we use this server everywhere: from QA to visualize that our algorithm
    does what itâ€™s supposed to, with the right data, to the business development teams
    who use it to select from the best location that the algorithm has found.'
  id: totrans-split-9
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨å„ä¸ªåœ°æ–¹éƒ½ä½¿ç”¨è¿™ä¸ªæœåŠ¡å™¨ï¼šä» QA ä»¥ç¡®ä¿æˆ‘ä»¬çš„ç®—æ³•æ˜¯å¦æŒ‰é¢„æœŸä½¿ç”¨æ­£ç¡®æ•°æ®ï¼Œåˆ°ä¸šåŠ¡å¼€å‘å›¢é˜Ÿä½¿ç”¨å®ƒæ¥ä»ç®—æ³•æ‰¾åˆ°çš„æœ€ä½³ä½ç½®ä¸­è¿›è¡Œé€‰æ‹©ã€‚
- en: This blog post will guide you through the things I wish I had known when I started
    setting up this piece of software at Inicio.
  id: totrans-split-10
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç¯‡åšæ–‡å°†æŒ‡å¯¼æ‚¨åœ¨å¼€å§‹åœ¨ Inicio è®¾ç½®è¿™ä¸ªè½¯ä»¶æ—¶ï¼Œæˆ‘å¸Œæœ›è‡ªå·±å½“åˆçŸ¥é“çš„äº‹æƒ…ã€‚
- en: 'The types of soil in Brittany, each color represents a type of soil: Minerals,
    Limestone, Wet, etc.'
  id: totrans-split-11
  prefs: []
  type: TYPE_NORMAL
  zh: å¸ƒåˆ—å¡”å°¼çš„åœŸå£¤ç±»å‹ï¼Œæ¯ç§é¢œè‰²ä»£è¡¨ä¸€ç§ç±»å‹çš„åœŸå£¤ï¼šçŸ¿ç‰©è´¨ã€çŸ³ç°å²©ã€æ½®æ¹¿ç­‰ã€‚
- en: '**Why do you need a MapServer?**'
  id: totrans-split-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ª MapServerï¼Ÿ**'
- en: '**Visualize**: Geographical data is inherently visual. We all have some affinity
    with reading maps and visualizing data in space. You can do as many transformations
    as you want on your spatial data, it will be hard to extract useful insights if
    you can never visualize it.'
  id: totrans-split-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å¯è§†åŒ–**ï¼šåœ°ç†æ•°æ®å›ºæœ‰åœ°æ˜¯å¯è§†çš„ã€‚æˆ‘ä»¬éƒ½å¯¹é˜…è¯»åœ°å›¾å’Œåœ¨ç©ºé—´ä¸­å¯è§†åŒ–æ•°æ®æœ‰ä¸€å®šçš„äº²å’ŒåŠ›ã€‚æ‚¨å¯ä»¥å¯¹ç©ºé—´æ•°æ®è¿›è¡Œä»»æ„è½¬æ¢ï¼Œä½†å¦‚æœæ‚¨æ— æ³•å°†å…¶å¯è§†åŒ–ï¼Œå°†å¾ˆéš¾æå–æœ‰ç”¨çš„è§è§£ã€‚'
- en: '**Showcase**: Publish and showcase your insights to the world.'
  id: totrans-split-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å±•ç¤º**ï¼šå°†æ‚¨çš„è§è§£å‘å¸ƒå¹¶å±•ç¤ºç»™ä¸–ç•Œã€‚'
- en: '**Share**: Integrate your data to many GIS tools and web map visualizations.
    You have created an awesome data visualization and want to share it to the world?'
  id: totrans-split-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**åˆ†äº«**ï¼šå°†æ‚¨çš„æ•°æ®é›†æˆåˆ°è®¸å¤š GIS å·¥å…·å’Œ Web åœ°å›¾å¯è§†åŒ–ä¸­ã€‚æ‚¨å·²ç»åˆ›å»ºäº†ä¸€ä¸ªå¾ˆæ£’çš„æ•°æ®å¯è§†åŒ–ï¼Œæƒ³ä¸ä¸–ç•Œåˆ†äº«ï¼Ÿ'
- en: It can be enough to setup an interactive map visualization on your website.**â€**
  id: totrans-split-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å¯ä»¥åœ¨æ‚¨çš„ç½‘ç«™ä¸Šè®¾ç½®äº¤äº’å¼åœ°å›¾å¯è§†åŒ–å°±è¶³å¤Ÿäº†ã€‚**â€**
- en: '**Build:Â **Create a robust and always-up source to fit your business needs.'
  id: totrans-split-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ„å»ºï¼š** åˆ›å»ºä¸€ä¸ªå¥å£®ä¸”å§‹ç»ˆæ›´æ–°çš„èµ„æºä»¥é€‚åº”æ‚¨çš„ä¸šåŠ¡éœ€æ±‚ã€‚'
- en: '**What does it do?**'
  id: totrans-split-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**å®ƒèƒ½åšä»€ä¹ˆï¼Ÿ**'
- en: A mapping server connect to various geographical data sources. It can perform
    transformations, filtering, combinations, and styling. Then, it makes the data
    available through a server.
  id: totrans-split-19
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªåœ°å›¾æœåŠ¡å™¨è¿æ¥åˆ°å„ç§åœ°ç†æ•°æ®æºã€‚å®ƒå¯ä»¥æ‰§è¡Œè½¬æ¢ã€è¿‡æ»¤ã€ç»„åˆå’Œæ ·å¼åŒ–ã€‚ç„¶åï¼Œé€šè¿‡æœåŠ¡å™¨ä½¿æ•°æ®å¯ç”¨ã€‚
- en: This may sound relatively simple, but geographical data is challenging. You
    need to take care of projections, indexing, and serving very complex geometries
    efficiently.
  id: totrans-split-20
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å¬èµ·æ¥å¯èƒ½ç›¸å¯¹ç®€å•ï¼Œä½†åœ°ç†æ•°æ®æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ã€‚æ‚¨éœ€è¦å…³æ³¨æŠ•å½±ã€ç´¢å¼•å’Œæœ‰æ•ˆåœ°æä¾›éå¸¸å¤æ‚çš„å‡ ä½•æ•°æ®ã€‚
- en: '**Why MapServer vs. Geoserver**'
  id: totrans-split-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**ä¸ºä»€ä¹ˆé€‰æ‹© MapServer è€Œä¸æ˜¯ Geoserver**'
- en: 'In the world of mapping servers there are two main alternatives: MapServer
    and Geoserver.'
  id: totrans-split-22
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨åœ°å›¾æœåŠ¡å™¨çš„ä¸–ç•Œä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„é€‰æ‹©ï¼šMapServer å’Œ Geoserverã€‚
- en: At Inicio, we quickly realized we would need an extensible, flexible and fast
    mapping server to serve our large and ever growing amount of geographical data
    that we both ingest and produce.
  id: totrans-split-23
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Inicioï¼Œæˆ‘ä»¬å¾ˆå¿«æ„è¯†åˆ°æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯æ‰©å±•ã€çµæ´»ä¸”å¿«é€Ÿçš„åœ°å›¾æœåŠ¡å™¨æ¥æœåŠ¡æˆ‘ä»¬å¤§é‡ä¸”ä¸æ–­å¢é•¿çš„åœ°ç†æ•°æ®ï¼Œæˆ‘ä»¬æ—¢æ‘„å–åˆäº§ç”Ÿè¿™äº›æ•°æ®ã€‚
- en: 'MapServer is fast: it is built in C and makes heavy use of both the most established
    and fastest libraries for geometrical data manipulation: GDAL and PROJ.'
  id: totrans-split-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MapServer é€Ÿåº¦å¿«ï¼šå®ƒæ˜¯ç”¨ C è¯­è¨€æ„å»ºçš„ï¼Œå¹¶ä¸”å¤§é‡ä½¿ç”¨äº†å‡ ä½•æ•°æ®æ“ä½œä¸­æœ€æˆç†Ÿå’Œæœ€å¿«çš„åº“ï¼šGDAL å’Œ PROJã€‚
- en: MapServer is lightweight
  id: totrans-split-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MapServer è½»å·§
- en: MapServer is configurable and scriptable
  id: totrans-split-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MapServer æ˜¯å¯é…ç½®å’Œå¯è„šæœ¬åŒ–çš„
- en: 'MapServer is open-source, and has been actively maintained by a large community
    for almost 30 years, and funded by large organizations such as NASA! (And when
    I say actively, I mean it: the latest release to date is from April 2023)'
  id: totrans-split-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MapServer æ˜¯å¼€æºçš„ï¼Œå¹¶ä¸”å·²ç»ç”±ä¸€ä¸ªåºå¤§çš„ç¤¾åŒºç§¯æç»´æŠ¤äº†å°†è¿‘ 30 å¹´ï¼Œè¿˜å¾—åˆ°äº†è¯¸å¦‚ NASA ç­‰å¤§å‹ç»„ç»‡çš„èµ„åŠ©ï¼ï¼ˆå½“æˆ‘è¯´ç§¯æç»´æŠ¤æ—¶ï¼Œæˆ‘çš„æ„æ€æ˜¯ï¼šæˆªè‡³
    2023 å¹´ 4 æœˆçš„æœ€æ–°ç‰ˆæœ¬å·²å‘å¸ƒï¼‰
- en: '**Anatomy of a Mapserver**'
  id: totrans-split-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**Mapserver çš„ç»“æ„è§£å‰–**'
- en: 'The components of a MapServer are:'
  id: totrans-split-29
  prefs: []
  type: TYPE_NORMAL
  zh: MapServer çš„ç»„æˆéƒ¨åˆ†åŒ…æ‹¬ï¼š
- en: '**What is a mapfile exactly?**'
  id: totrans-split-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**mapfile ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ**'
- en: A mapfile is simply a config file written in MapServerâ€™s configuration language.
    It defines everything the server needs to know to draw your map. Objects are defined
    with an opening tag, and .
  id: totrans-split-31
  prefs: []
  type: TYPE_NORMAL
  zh: mapfile åªæ˜¯ä¸€ä¸ªç”¨ MapServer é…ç½®è¯­è¨€ç¼–å†™çš„é…ç½®æ–‡ä»¶ã€‚å®ƒå®šä¹‰äº†æœåŠ¡å™¨ç»˜åˆ¶åœ°å›¾æ‰€éœ€çš„ä¸€åˆ‡ã€‚å¯¹è±¡ç”¨å¼€æ”¾æ ‡ç­¾å®šä¹‰ï¼Œå¹¶ä¸”ã€‚
- en: Here is a minimal example of a mapfile. The indents are optional, but useful
    to keep the whole structure clear.
  id: totrans-split-32
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ª mapfile çš„æœ€å°ç¤ºä¾‹ã€‚ç¼©è¿›æ˜¯å¯é€‰çš„ï¼Œä½†æœ‰åŠ©äºä¿æŒæ•´ä½“ç»“æ„æ¸…æ™°ã€‚
- en: 'Hereâ€™s an example file with comments:'
  id: totrans-split-33
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸€ä¸ªå¸¦æœ‰æ³¨é‡Šçš„ç¤ºä¾‹æ–‡ä»¶ï¼š
- en: ğŸ’¡ Choosing to make a custom config language for the MapServer configuration
    files is an surprising choice.
  id: totrans-split-34
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ’¡ é€‰æ‹©ä¸º MapServer é…ç½®æ–‡ä»¶åˆ¶å®šè‡ªå®šä¹‰é…ç½®è¯­è¨€æ˜¯ä¸€ä¸ªä»¤äººæƒŠè®¶çš„é€‰æ‹©ã€‚
- en: It probably made sense when this library was created, but it doesnâ€™t seem to
    add any advantage over something like JSON or TOML, which are well supported nowadays
    and come with a lot of tooling.
  id: totrans-split-35
  prefs: []
  type: TYPE_NORMAL
  zh: å½“è¿™ä¸ªåº“è¢«åˆ›å»ºæ—¶å¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†ç°åœ¨ä¼¼ä¹æ²¡æœ‰æ¯” JSON æˆ– TOML ç­‰ç°åœ¨å¾—åˆ°å¹¿æ³›æ”¯æŒå’Œé…å¤‡å¤§é‡å·¥å…·çš„ä¸œè¥¿æ›´æœ‰ä¼˜åŠ¿ã€‚
- en: At Inicio, we actually use [Pydantic](https://docs.pydantic.dev/latest/) models
    that mirror the structure of these config files, and serialized them to the mapfile
    format! This allows us to generate and manipulate these config files as Python
    object, without worrying about the uncommon syntax. â€œConfiguration-as-codeâ€
  id: totrans-split-36
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Inicioï¼Œæˆ‘ä»¬å®é™…ä¸Šä½¿ç”¨ [Pydantic](https://docs.pydantic.dev/latest/) æ¨¡å‹æ¥é•œåƒè¿™äº›é…ç½®æ–‡ä»¶çš„ç»“æ„ï¼Œå¹¶å°†å®ƒä»¬åºåˆ—åŒ–ä¸º
    mapfile æ ¼å¼ï¼è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿç”Ÿæˆå’Œæ“ä½œè¿™äº›é…ç½®æ–‡ä»¶ä½œä¸º Python å¯¹è±¡ï¼Œè€Œä¸å¿…æ‹…å¿ƒä¸å¸¸è§çš„è¯­æ³•ã€‚â€œé…ç½®å³ä»£ç â€
- en: â€**â€**
  id: totrans-split-37
  prefs: []
  type: TYPE_NORMAL
  zh: '**â€**'
- en: '**What kind of data sources can I use?**'
  id: totrans-split-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**æˆ‘å¯ä»¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„æ•°æ®æºï¼Ÿ**'
- en: You can serve a lot of different type of geographical data from MapServer. These
    data sources are the backbone of your server.
  id: totrans-split-39
  prefs: []
  type: TYPE_NORMAL
  zh: æ‚¨å¯ä»¥ä» MapServer ä¸­æä¾›å„ç§ä¸åŒç±»å‹çš„åœ°ç†æ•°æ®ã€‚è¿™äº›æ•°æ®æºæ˜¯æœåŠ¡å™¨çš„æ”¯æŸ±ã€‚
- en: Data can be read from a file in one of the many supported formats (e.g. Shapefile,
    GML, GeoJSON, KML, [and many more](https://mapserver.org/input/vector/index.html#vector)).
  id: totrans-split-40
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®å¯ä»¥ä»æ–‡ä»¶ä¸­è¯»å–ï¼Œæ”¯æŒå¤šç§æ ¼å¼ï¼ˆä¾‹å¦‚ Shapefileã€GMLã€GeoJSONã€KMLï¼Œ[ä»¥åŠæ›´å¤š](https://mapserver.org/input/vector/index.html#vector)ï¼‰ã€‚
- en: Another option that we use a lot at Inicio is the ability to read data directly
    from a database. We run a Postgis-enabled database to store most of our geographical
    data, and our MapServer directly fetches what it needs from it.
  id: totrans-split-41
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Inicioï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„å¦ä¸€ä¸ªé€‰é¡¹æ˜¯ç›´æ¥ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®çš„èƒ½åŠ›ã€‚æˆ‘ä»¬è¿è¡Œä¸€ä¸ªæ”¯æŒ Postgis çš„æ•°æ®åº“æ¥å­˜å‚¨å¤§éƒ¨åˆ†åœ°ç†æ•°æ®ï¼Œæˆ‘ä»¬çš„ MapServer
    ç›´æ¥ä»ä¸­è·å–æ‰€éœ€çš„æ•°æ®ã€‚
- en: 'Running a query against a database in a mapfile looks something like this:'
  id: totrans-split-42
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ mapfile ä¸­å¯¹æ•°æ®åº“è¿è¡ŒæŸ¥è¯¢çœ‹èµ·æ¥åƒè¿™æ ·ï¼š
- en: The required fields are one unique `id` and a `geometry` (or postigs `geography`).
    Here we export extra fields that will be used to display information within the
    layer, such as coloring the area depending on the type of vegetal.
  id: totrans-split-43
  prefs: []
  type: TYPE_NORMAL
  zh: å¿…å¡«å­—æ®µæ˜¯ä¸€ä¸ªå”¯ä¸€çš„ `id` å’Œä¸€ä¸ª `geometry`ï¼ˆæˆ– postigs `geography`ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯¼å‡ºé¢å¤–çš„å­—æ®µï¼Œè¿™äº›å­—æ®µå°†ç”¨äºåœ¨å›¾å±‚å†…æ˜¾ç¤ºä¿¡æ¯ï¼Œä¾‹å¦‚æ ¹æ®æ¤ç‰©ç±»å‹ç€è‰²åŒºåŸŸã€‚
- en: When serving a lot of data, using spatial indexes is crucial, and the server
    knows how to take advantage of them when displaying data within a bounding box.
  id: totrans-split-44
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æä¾›å¤§é‡æ•°æ®æ—¶ï¼Œä½¿ç”¨ç©ºé—´ç´¢å¼•è‡³å…³é‡è¦ï¼ŒæœåŠ¡å™¨çŸ¥é“å¦‚ä½•åœ¨æ˜¾ç¤ºè¾¹ç•Œæ¡†å†…çš„æ•°æ®æ—¶åˆ©ç”¨å®ƒä»¬ã€‚
- en: '**What is a layer? How can I make one?**'
  id: totrans-split-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**ä»€ä¹ˆæ˜¯å›¾å±‚ï¼Ÿå¦‚ä½•åˆ›å»ºä¸€ä¸ªï¼Ÿ**'
- en: Layers are the underlying structure of the data you will make available with
    the server.
  id: totrans-split-46
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾å±‚æ˜¯æ‚¨å°†é€šè¿‡æœåŠ¡å™¨æä¾›çš„æ•°æ®çš„åŸºç¡€ç»“æ„ã€‚
- en: The layer below is an example of serving forest data directly from the database
    to a WMS endpoint.
  id: totrans-split-47
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢çš„å›¾å±‚æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œç›´æ¥ä»æ•°æ®åº“å‘ WMS ç«¯ç‚¹æä¾›æ£®æ—æ•°æ®ã€‚
- en: At Inicio, we use standard protocols for serving our data, such as WMS. It is
    supported by most GIS software and libraries, and allows serving a lot of data
    efficiently.
  id: totrans-split-48
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ Inicioï¼Œæˆ‘ä»¬ä½¿ç”¨æ ‡å‡†åè®®æ¥æä¾›æˆ‘ä»¬çš„æ•°æ®ï¼Œæ¯”å¦‚ WMSã€‚å®ƒè¢«å¤§å¤šæ•° GIS è½¯ä»¶å’Œåº“æ”¯æŒï¼Œå¹¶å…è®¸é«˜æ•ˆåœ°æä¾›å¤§é‡æ•°æ®ã€‚
- en: â€
  id: totrans-split-49
  prefs: []
  type: TYPE_NORMAL
  zh: â€
- en: ğŸ’¡ **What is** [**WMS**](https://en.wikipedia.org/wiki/Web_Map_Service)**?**
  id: totrans-split-50
  prefs: []
  type: TYPE_NORMAL
  zh: ğŸ’¡ **ä»€ä¹ˆæ˜¯** [**WMS**](https://en.wikipedia.org/wiki/Web_Map_Service)**ï¼Ÿ**
- en: The Web Map Service is a standard for serving geographical data. It is based
    on XML, and usually serves data in the form of images (PNG, JPEG, etc.).
  id: totrans-split-51
  prefs: []
  type: TYPE_NORMAL
  zh: Web Map Service æ˜¯ç”¨äºæä¾›åœ°ç†æ•°æ®çš„æ ‡å‡†ã€‚å®ƒåŸºäº XMLï¼Œé€šå¸¸ä»¥å›¾åƒçš„å½¢å¼ï¼ˆPNGã€JPEG ç­‰ï¼‰æä¾›æ•°æ®ã€‚
- en: This format makes it simple to display complex spatial data in a visual way.
    It can serve vector and raster data within a bounding box by rendering said data
    to an image and sending it back.
  id: totrans-split-52
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§æ ¼å¼ä½¿å¾—ä»¥è§†è§‰æ–¹å¼æ˜¾ç¤ºå¤æ‚çš„ç©ºé—´æ•°æ®å˜å¾—ç®€å•ã€‚å®ƒå¯ä»¥é€šè¿‡å°†æ•°æ®å‘ˆç°ä¸ºå›¾åƒå¹¶å‘é€å›æ¥ï¼Œåœ¨ä¸€ä¸ªè¾¹ç•Œæ¡†å†…æä¾›çŸ¢é‡å’Œæ …æ ¼æ•°æ®ã€‚
- en: 'Letâ€™s go step by step, decoding the layer definition above:'
  id: totrans-split-53
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä¸€æ­¥æ­¥åœ°è§£ç ä¸Šé¢çš„å›¾å±‚å®šä¹‰ï¼š
- en: '**What metadata should I add for a WMS server layer?**'
  id: totrans-split-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**æˆ‘åº”è¯¥ä¸ºWMSæœåŠ¡å™¨å±‚æ·»åŠ ä»€ä¹ˆå…ƒæ•°æ®ï¼Ÿ**'
- en: The first part contains a bunch of metadata for your layer. There are a some
    required metadata for serving data through WMS such as `"wms_include_items"` which
    specifies if all the input data should be included in the layer.
  id: totrans-split-55
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬ä¸€éƒ¨åˆ†åŒ…å«äº†å±‚çš„ä¸€äº›å…ƒæ•°æ®ã€‚ä¸ºäº†é€šè¿‡WMSæä¾›æ•°æ®ï¼Œæœ‰ä¸€äº›å¿…éœ€çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚`"wms_include_items"`ï¼Œå®ƒæŒ‡å®šæ˜¯å¦åº”è¯¥åœ¨å±‚ä¸­åŒ…æ‹¬æ‰€æœ‰è¾“å…¥æ•°æ®ã€‚
- en: '**Definition**'
  id: totrans-split-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**å®šä¹‰**'
- en: This part defines the source of the data, how to access it, if it should be
    displayed, the extent it covers and the projection it should be available in.
  id: totrans-split-57
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¤éƒ¨åˆ†å®šä¹‰äº†æ•°æ®çš„æ¥æºï¼Œå¦‚ä½•è®¿é—®å®ƒï¼Œæ˜¯å¦åº”è¯¥æ˜¾ç¤ºå®ƒï¼Œå®ƒè¦†ç›–çš„èŒƒå›´ä»¥åŠåº”è¯¥ä»¥å“ªç§æŠ•å½±æ–¹å¼æä¾›å®ƒã€‚
- en: '**How do you specifiy the style?**'
  id: totrans-split-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**ä½ å¦‚ä½•æŒ‡å®šæ ·å¼ï¼Ÿ**'
- en: The last part is about styling the layer. This means defining the color, width
    opacity and all the other details of the layerâ€™s object.
  id: totrans-split-59
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åä¸€éƒ¨åˆ†æ˜¯å…³äºç»™å›¾å±‚è®¾ç½®æ ·å¼ã€‚è¿™æ„å‘³ç€å®šä¹‰å›¾å±‚å¯¹è±¡çš„é¢œè‰²ã€å®½åº¦ã€é€æ˜åº¦ä»¥åŠæ‰€æœ‰å…¶ä»–ç»†èŠ‚ã€‚
- en: The neat part here is that the color can be returned as part of the SQL query.
  id: totrans-split-60
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œçš„å¥½å¤„æ˜¯é¢œè‰²å¯ä»¥ä½œä¸ºSQLæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†è¿”å›ã€‚
- en: '**How can I run it? With a CGI-capable server**'
  id: totrans-split-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**æˆ‘å¦‚ä½•è¿è¡Œå®ƒï¼Ÿé€šè¿‡æ”¯æŒCGIçš„æœåŠ¡å™¨**'
- en: We now talk about the front-side of our server.
  id: totrans-split-62
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬è°ˆè®ºæˆ‘ä»¬æœåŠ¡å™¨çš„å‰ç«¯ã€‚
- en: This is maybe another marker of MapServerâ€™s respectable age, but the recommended
    way of running it is through a CGI-capable server, which usually means an Apache
    HTTP server (which is getting close to 30 years old!).
  id: totrans-split-63
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¹Ÿè®¸æ˜¯MapServerå°Šè´µå¹´é¾„çš„å¦ä¸€ä¸ªæ ‡å¿—ï¼Œä½†æ¨èçš„è¿è¡Œæ–¹å¼æ˜¯é€šè¿‡ä¸€ä¸ªæ”¯æŒCGIçš„æœåŠ¡å™¨ï¼Œé€šå¸¸æ„å‘³ç€ä¸€ä¸ªApache HTTPæœåŠ¡å™¨ï¼ˆå·²æ¥è¿‘30å¹´å†å²ï¼ï¼‰ã€‚
- en: This is a battle tested server software, that is currently running incredibly
    many servers in small and large structures. It is also super customizable, making
    it an overall reliable and powerful software. However, this comes at the cost
    of simplicity, and it is easy to get lost in the customization options which basically
    let you do anything (including dangerous stuff â˜ ï¸).
  id: totrans-split-64
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªç»è¿‡æˆ˜æ–—è€ƒéªŒçš„æœåŠ¡å™¨è½¯ä»¶ï¼Œç›®å‰åœ¨å°å‹å’Œå¤§å‹ç»“æ„ä¸­è¿è¡Œç€éå¸¸å¤šçš„æœåŠ¡å™¨ã€‚å®ƒä¹Ÿæ˜¯è¶…çº§å¯å®šåˆ¶çš„ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªæ€»ä½“å¯é å’Œå¼ºå¤§çš„è½¯ä»¶ã€‚ç„¶è€Œï¼Œè¿™æ˜¯ä»¥ç®€å•æ€§ä¸ºä»£ä»·çš„ï¼Œå¾ˆå®¹æ˜“åœ¨åŸºæœ¬ä¸Šå¯ä»¥è®©ä½ åšä»»ä½•äº‹æƒ…ï¼ˆåŒ…æ‹¬å±é™©çš„äº‹æƒ…
    â˜ ï¸ï¼‰çš„å®šåˆ¶é€‰é¡¹ä¸­è¿·å¤±æ–¹å‘ã€‚
- en: For our production server, we chose to get an Apache server running with a good
    config inside a well protected part of our infra. Then, another front-facing reverse-proxy
    handles all the heavy-lifting of HTTPS, authentication, serving other services
    as well as some static files.
  id: totrans-split-65
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºæˆ‘ä»¬çš„ç”Ÿäº§æœåŠ¡å™¨ï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨æˆ‘ä»¬åŸºç¡€è®¾æ–½çš„ä¸€ä¸ªå—ä¿æŠ¤è‰¯å¥½çš„éƒ¨åˆ†å†…è¿è¡Œä¸€ä¸ªé…ç½®è‰¯å¥½çš„ApacheæœåŠ¡å™¨ã€‚ç„¶åï¼Œå¦ä¸€ä¸ªå‰ç«¯åå‘ä»£ç†å¤„ç†æ‰€æœ‰çš„é‡è¦å·¥ä½œï¼ŒåŒ…æ‹¬HTTPSã€èº«ä»½éªŒè¯ã€æä¾›å…¶ä»–æœåŠ¡ä»¥åŠä¸€äº›é™æ€æ–‡ä»¶ã€‚
- en: '**Where to go next?**'
  id: totrans-split-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**æ¥ä¸‹æ¥æ€ä¹ˆåŠï¼Ÿ**'
- en: Once you have a MapServer serving WMS up and running, and you are getting some
    usage, you might want to consider caching the tiles served to make access quicker
    (at the cost of storage and complexity). At Inicio, we use [mapproxy](https://mapproxy.org/)
    to cache our WMS tiles. [MapCache](https://mapserver.org/mapcache/index.html),
    from the same developers as MapServer, could also be worth a try.
  id: totrans-split-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æ‚¨çš„MapServeræä¾›äº†WMSå¹¶è¿è¡Œèµ·æ¥ï¼Œå¹¶ä¸”æ‚¨æ­£åœ¨å¾—åˆ°ä¸€äº›ä½¿ç”¨ï¼Œæ‚¨å¯èƒ½æƒ³è€ƒè™‘ç¼“å­˜æä¾›çš„ç“¦ç‰‡ä»¥ä½¿è®¿é—®æ›´å¿«ï¼ˆä»¥å­˜å‚¨å’Œå¤æ‚æ€§ä¸ºä»£ä»·ï¼‰ã€‚åœ¨Inicioï¼Œæˆ‘ä»¬ä½¿ç”¨[mapproxy](https://mapproxy.org/)æ¥ç¼“å­˜æˆ‘ä»¬çš„WMSç“¦ç‰‡ã€‚[MapCache](https://mapserver.org/mapcache/index.html)ï¼Œæ¥è‡ªMapServerçš„åŒä¸€å¼€å‘è€…ï¼Œä¹Ÿå¯èƒ½å€¼å¾—ä¸€è¯•ã€‚
- en: Scripting the creation of layers. Once you start serving several data sources,
    writing Mapfiles may start to feel repetitive, and it gets very tempting to script
    their generation. You could cook up your own solution like we did, or use an external
    library such as [MapScript](https://mapserver.org/mapscript/index.html).
  id: totrans-split-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è„šæœ¬åŒ–åˆ›å»ºå›¾å±‚ã€‚ä¸€æ—¦å¼€å§‹æä¾›å¤šä¸ªæ•°æ®æºï¼Œç¼–å†™Mapæ–‡ä»¶å¯èƒ½ä¼šå¼€å§‹æ„Ÿè§‰é‡å¤ï¼Œè€Œä¸”å¾ˆå®¹æ˜“è¯±æƒ‘åˆ°è„šæœ¬ç”Ÿæˆå®ƒä»¬ã€‚ä½ å¯ä»¥åƒæˆ‘ä»¬ä¸€æ ·è‡ªå·±åšå‡ºè§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…ä½¿ç”¨åƒ[MapScript](https://mapserver.org/mapscript/index.html)è¿™æ ·çš„å¤–éƒ¨åº“ã€‚
- en: There are a lot of potential optimizations and tuning to be done on a MapServer,
    depending on your use case. The [MapServer doc](https://mapserver.org/optimization/index.html)
    has some great tips to get you started.
  id: totrans-split-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨MapServerä¸Šæœ‰å¾ˆå¤šæ½œåœ¨çš„ä¼˜åŒ–å’Œè°ƒä¼˜å¯ä»¥è¿›è¡Œï¼Œè¿™å–å†³äºä½ çš„ä½¿ç”¨æƒ…å†µã€‚[MapServeræ–‡æ¡£](https://mapserver.org/optimization/index.html)ä¸­æœ‰ä¸€äº›å¾ˆå¥½çš„æç¤ºå¯ä»¥å¸®åŠ©ä½ å…¥é—¨ã€‚
- en: â€
  id: totrans-split-70
  prefs: []
  type: TYPE_NORMAL
  zh: â€
