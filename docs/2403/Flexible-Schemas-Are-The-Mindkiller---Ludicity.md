<!--yml

category: 未分类

date: 2024-05-27 14:30:32

-->

# 灵活的模式是一个杀手 —— 乐趣性

> 来源：[https://ludic.mataroa.blog/blog/flexible-schemas-are-the-mindkiller/](https://ludic.mataroa.blog/blog/flexible-schemas-are-the-mindkiller/)

我们需要讨论喜欢“灵活”模式的人，以及为什么我无法透露我下次见到这种模式时会做什么而不被列入观察名单的原因。

# I.

几年前，我曾在一家公司工作过，该公司从FAANG（即Facebook等公司）那里获得了100万美元，用于开发AI和数据分类工具。对于你们中的一些超级精英，那些身处钻石般高级结构中的人来说，Kubernetes 是一个真实存在的东西，“网页规模”这个词并不会让你认为对方是个白痴，你们整天都在高高在上地居高临下地盯着那些蠢蠢欲动的小蚂蚁，这可能看起来是一个微不足道的金额。但对这家组织来说，100万美元是他们曾经获得的*最大*一笔资金 —— 这立即成为了每个人简历上的亮点。当然，只有大约三个人在项目上工作，但每个人都在获得功劳。

不详述，这也是我在一家我真正工作过的公司看到的唯一一个具有明确、明确目标并且几乎肯定可以实现的AI产品，因为他们拥有大量宝贵数据。更妙的是，它还产生了*实际的积极社会影响*。我是这个项目的两名数据科学家之一，因为项目“有些落后”，所以我加入得比较晚。有经验的工程师们已经感到不悦。我相信在《神话中的人月》中曾经写过一个项目应该“不允许小小的滑动”的原则 —— 某件事要么准时完成，要么*明显*延迟，尽管显然我们仍然没有从1975年的一本书中吸取教训。

然而，另一位数据科学家是我非常亲密的朋友，现在也是我们公司的联合主管，所以我知道AI方面的事情会很顺利。他们只是需要一些帮助来完成一些项目，也许需要有人来进行编程配对。在我加入之前，模型基本上已经运行正常，所以剩下的就是检查团队的最后一个成员。

艹他的 Derek。

# II. 那个绝对混蛋

有*两件*事情需要做。第一件事是AI相关的工作（我们使用了BERT编码，对于那些感兴趣的人来说，我们做了一些深度学习，但它也可能是一个随机森林，就像几乎所有的事情一样）。完成了。

*第二* 件事情非常简单。该组织有许多员工专门使用一系列 Access 数据库进行数据标注。简单来说，这是一个非技术人员可以像电子表格一样用来进行数据输入的数据库，而不会出现未经训练的人为你的组织数据模型制造混乱的情况。尽管电子表格带来了一些好处，请花点时间思考一下*它们是否真的值得*以这个句子为依据。

该组织希望用一个简单的 Web 应用程序替换那个 Access 界面，以便可以添加一些功能，并且我们的机器学习工作可以预先标记新数据。为此，他们雇佣了 Derek，因此我决定将他命名为 Derek，因为我[显然认定 Derek 是我们的默认名字，用来伤害我的人](https://ludic.mataroa.blog/blog/your-organization-probably-doesnt-want-to-improve-things/)。抱歉，Dereks。

Derek 只有*一个简单的工作*。创建一个*非常简单的* CRUD 应用程序。

创建一个简单的身份验证系统。复制七个 CRUD 页面。创建一个 SQL Server 实例来存储数据，而不是使用 Access。

在我加入之前，他已经工作了八个月，计划在我加入三天后离开。但是，据管理层称，该应用程序“基本完成”，Derek 因其极高的效率和低调的职业道德而受到了高度赞扬。他还受到了高度推荐。在第一天，他被要求对应用程序进行调整，他在五分钟内就完成了。他非常自豪地说这是因为这个应用程序“非常灵活”。**如果我当时就逃走，我本可以避免很多痛苦。**

然而，由于我的朋友在运行工程项目方面经验不足（我也是，但我想我有些天赋），我决定确保交接顺利。我要求 Derek 与我们分享他的仓库。

这个故事的剩下部分就像一辆火车在慢动作中坠毁一样，直到四年后它仍然在坠毁。

# III. 一切都走错了

没有代码进行版本控制。他已经工作了*八个月*，但看不到任何提交。这些都只是他电脑上的一堆巨大的文件，完全没有文档化和注释。

我惊讶地走开了。五分钟后我回来，请求他只需把所有文件的一整堆放到一个仓库里，并简要地写一个 Word 文档来解释如何运行这个应用程序。

Derek 照要求做了。文件说明书确实是足够的。这将是最后一次对 Derek 的正面评价。他很快就离开了。

# IV.

一个月后了……应用程序不工作了。我们花了一些时间弄清楚如何启动它，当我们启动它时，我们意识到核心功能根本不起作用。Derek拼凑了一系列看起来工作正常的页面，给一个只在他肩膀上看了30秒的经理看，但它们并不按预期功能运行。一些小功能缺失了。例如，它有一些小缺陷，比如根本*不保存任何用户输入*。

更复杂的是，整个服务器都是用C#写的，代码糟糕得让我对这种语言产生了两年的反感，直到有能力的人向我保证.NET其实还可以，前端用的是Angular，丑得我现在还觉得它肯定糟透了。当然，这只是为了毫无意义地做一个单页面应用程序。

好的，好吧，让我们看看能不能挽救这个情况。我和我的朋友开始解开这个混乱。这些记录是从一个表中提取的？等等，什么？在那七页中有成百上千列。整个数据库就是一个表？整个数据库都是一个表。整个数据库是一个表？

他到底做了什么？

来自比尔·卡尔文（Bill Karwin）极好的书《SQL反模式》（SQL Antipatterns），可惜我一年后才读到：

> 如果您听到项目团队说以下类似的短语，那么有人正在使用EAV反模式：
> 
> • “这个数据库完全可扩展，无需元数据更改。您可以在运行时定义新属性。”
> 
> 关系数据库不支持那种灵活度。当有人声称设计了一个任意可扩展的数据库时，他们可能在使用EAV设计。

他把一切都存储为键值对。所以，不是：

| 用户 | 年龄 | 职业 |
| --- | --- | --- |
| 鲁迪克 | 29 | 受折磨的灵魂 |

我们有：

| 用户ID | 键 | 值 |
| --- | --- | --- |
| 1 | 名字 | 鲁迪克 |
| 1 | 年龄 | 29 |
| 1 | 职业 | 受折磨的灵魂 |

现在，每个个案都标记了350行数据，在一个超级长的表中。还记得我说这实际上是一个合理的AI项目吗？是的，我们有大量数据，现在乘以350，查询起来真是个噩梦。

我选择重新设计整个数据库。这花了一些时间。然后我们重构Angular应用程序（同样非常痛苦），以适应新的（正确的）数据模型。在这里选择做正确的事情而不是永远支支吾吾给我们带来了巨大的速度优势，我认为这是我最引以为豪的职业成就之一，尽管听起来很简单。这很无聊，很痛苦，除了我的朋友没有人会欣赏。我当初就知道这一点，但我还是做了。

顺便说一句，我之所以被允许这样做，只是因为管理层在允许事情变成这个样子时如此疏忽，他们也没注意到我正在让事情好转，因此无法插入他们那些愚蠢的关于良好实践实际上太慢的看法。我们必须要发货。

# V.

噢，你以为这就结束了吗？不，不，你看，灵活的模式只是即将到来事物的一个预兆。它是天空中低垂的血月，一只邪恶的眼睛在景色中流淌出深红色的绝望。它是黑暗小巷中贪婪刀光的苍白闪烁。由未经教导的人挥舞，它是你必须逃离的信号，拼命逃离，就像你的双腿能承受的那样快，而我却太愚蠢未能如此。

每天早晨，我是为数不多的与数据录入团队交流的人之一，显然他们被管理层看待得并不完全是真正的人。有用的，可以礼貌对待，但显然不能邀请他们一起喝早晨的咖啡。将*核心*功能带入可以按时交付的状态，我在午餐前高兴地提到了这一点。

"哦，太棒了，我们能看看吗？我们等了多年了。"

…… *几年*？我们九个月前才拿到100万美元。开发还没有开始。管理层承诺给这些人这个应用程序多久了？我刚加入时因为签证问题和那些日子不知道该注意什么，所以真的没有时间寻找这些功能障碍的迹象。

*等等*。十个月来没有人向员工展示过这个应用程序？

是的，事实证明他们只是向Derek展示了Access数据库，并说"你能把这个变成一个应用程序吗？"然后他们八个月都没有与他交流，或者做任何与需求收集相关的事情。只是让一个对公司运营一无所知的家伙开始设计将支撑其整个运营的软件。很酷。很酷，很酷。

我向员工展示了这个应用程序，我觉得他们更激动的是有人真的把他们包含在内，而不是对应用程序本身。我们进行了一些调整，因为很明显它仍然存在重大缺陷。这也耗费了大量时间，而我*已经筋疲力尽*。所有这些都发生在新冠肺炎中间，所以我被迫每隔几周就要呆在公寓里好几周。

# VI.

现在大约是上午11点，大约一周后。

我正在进行模式迁移工作。我看了Derek曾用本地SQL Server实例填充的一个Access数据库之一。

突然间，我的血液变得冰冷，这种感觉我之前只有*一次*，那是我第一次犯生产错误时的成年礼。七个月后，我不知道为什么直到这一刻才想到，但突然间右侧的两个神经元被激活了。现在只是想起来都让我血液冷却。

他把一个Access数据库复制到了他的本地机器上。一个充满*极其敏感*医疗数据的Access数据库。像是"我从未听说过泄露数据集会对弱势群体造成如此严重影响"级别的敏感数据。而我有一份副本。这意味着*Derek把它放到了GitHub上*。

自那时起，我的脑海中一直有一个声音在播放。它变得非常安静，我几乎忘记了它，但现在我能听到它。它听起来像这样：

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA。

只需花一点时间来沉浸在恐惧中。我会等你。

...

...

...

好了，我们一起停止惊慌。让我们继续吧。

仓库幸运地设为私人。当然，这并不改变绝对泄漏的大量绝对放射性数据刚刚被上传到第三方位于国外的服务器上的事实。

我们处理得非常谨慎。我甚至记不起是如何提出的，或者做出了什么决定，但这超出了我作为一个仅凭脆弱签证在低级别职位上的能力。说它悄然过去是不对的，因为管理层巧妙地处理了这一点，几乎没有任何违规的声音。老实说，我相信一切都会好起来的 - 在这一点上，我怀疑包含违规行为的所有备份都已过期，我们用[BFG](https://rtyley.github.io/bfg-repo-cleaner/)真正清洁了实际文件，然后在我们的硬盘上运行了各种程序，以确保数据甚至专家也无法恢复。企业信息安全不是一个假的马戏团，对吧，同事们？

我也*刚意识到*，他可能一直在用个人笔记本电脑工作。我们没有清理干净。

我需要再花一点时间冷静下来。

# VII.

一周后。我深陷Derek编写的一些用于生成SQL Server表的助手函数的可怕深渊中。文件顶部有一个详尽的文档字符串，这与Derek的风格非常不同。也许他并不那么糟糕。

> 版权 MEDTECH，2015年。
> 
> 作者：Derek

那个地方...不是我工作的地方。

我凝视着屏幕几分钟，思考该怎么办。

我关闭文件，继续前进。只是...是的。

# VIII.

第二天，管理层宣布取消远程办公，我们需要每周三天在办公室，因为这将促进协作。我们的头脑简单的高级经理不知道发生了什么，但也在他们的简历上加了100万美元，总是忘记他们通常是否对我诚实。每天，他们抛硬币决定是否会说：

> 我很兴奋能再次回到办公室！能再见到一些人，对提高工作效率非常有帮助。

还有：

> 我讨厌这个，但是高管们让我们这样做。天啊，我宁愿花时间和我的孙子孙女们在一起。

但是办公室的空调效果并不好，我突然想起了我喜欢不在一间昏暗的27摄氏度（80.6华氏度，适合你们怪异的美国人）的房间里度过八个小时，被蜥蜴人包围的感觉。凭着纯运气，经过多年奋斗，我的永久居留被批准了。我辞职了。

组织中最重要的人打电话来责骂我，因为他们曾经让我承诺留下来以免被驱逐出境。有时我想到他们无力的愤怒，再加上“我只是以为你是个信守承诺的人，但我看错了”的软弱重复，我会微笑。

回顾起来，我为帮助他们做了*如此之多*的事情而感到愤怒。但首先，我薪水丰厚。其次，另一位工程师在两个月内也辞职了。我的一个当前客户，他们正在做一项救生工作，我的团队同意无偿帮助（我为他们感到骄傲），他们处于那个项目的边缘。他们最近确认，尽管我离开时只剩下一年左右的工作（*极限*上限估计），但该项目仍未启动。

*消失吧*，书呆子们。

# IX.

> “糟糕的程序员担心代码。优秀的程序员担心数据结构及其关系。” - 林纳斯·托瓦兹

关于那些既不担心代码也不担心数据结构和它们的关系的程序员呢？

我不知道有关灵活模式的*事情是什么*，但有一种人可能拥有所有需要成为*出色*工程师的头脑动力，却始终停留在他们的“优雅”上，然后永远没有进步。Derek能够将这种丑陋的Angular/.NET/无模式怪物改造成为能够运行的东西，表明他具有一种痛苦耐受力和原始大脑素质，这是我无法企及的。我*无法接受*设计得如此糟糕的东西，这不仅仅是审美感或设计直觉。我的头骨里的硬件规格不够。

但我只是*不断地遇到那个人*。我正在处理一个“白痴模式”克隆的第一个迹象总是“我找到了一种方法，可以不用担心我们的数据模型，哈哈”，最后总是以“我已经独自摧毁了这家公司的基础设施”结束。而且你永远不能开除他们，因为*是*有一个模式，它存在于他们难以理解的代码和他们的大脑中。最糟糕的是，他们总是*如此自豪*他们的灵活性，仿佛他们是第一个意识到，如果你丢弃像数据库类型、可查询性和任何形式的验证之类的东西，那么你可以“不受打扰”地编码的天才。然后他们在他们的职业生涯的每个其他领域展示出这种判断力的缺失。

我*不明白*他们在许多方面比我聪明，然后*仍然不明白这一切有多愚蠢*。

# X.

几年后了。我加入了一个宣传为最先进的平台。本州的每个竞争对手都在复制我们的实施。在我的第一天，他们告诉我所有的ETL元数据和日志都存储在DynamoDB中，因为它更灵活。

这是他们电脑闲置的第一个线索，大约浪费了[50万美元](https://ludic.mataroa.blog/blog/i-accidentally-saved-half-a-million-dollars/)。

啊哼。

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA。

PS：您可以停在这里不用再读了，帖子已经结束。接下来的内容是关于设置Liberapay和Patreon来支持写作/播客/其他事情的。

首选选项是[Liberapay](https://en.liberapay.com/Ludic/)，因为它是开源的，并且与这个社区的原则保持一致。然而，如果您已经有账户并且只想快速点击按钮，也可以选择[Patreon](https://www.patreon.com/ludic190/membership)。

其原因写在[此文](https://ludic.mataroa.blog/blog/on-authenticity-and-whats-worth-doing/)中。然而，您可能会永远免费阅读我的文字作品。“可能”不是因为我会开始收费，而是因为生活有时可能会妨碍到我的输出，并且可能会有一些中断。当前正在录制的播客也可能会永远免费，尽管如果编辑音频变得耗时，可能会有一天会有一些需要付费的集数。但当然，即使那时候，我现在就承诺，以我的良心为证，我会免费提供给任何不能负担费用的人，因为我有所谓的*伦理道德*/*糟糕的商业观念*。

目前，您将除了显示感激之外，不会获得任何好处，还可以支付将我的周音乐课从30分钟延长到45分钟的费用，以及最终支付一两个廉价服务器的托管费用，我将用它来部署一些协调我们社区的东西。

尽管这显然对您的收入非常糟糕，但两个系统都已配置显示我得到了多少钱，因为我显然只接受来自非常坚持的人的钱。

我只会在帖子中每六个月添加一次这个脚注（必须这样做，否则新读者将永远不知道这些链接在哪里）。然后我就不必再在太多帖子中加入这些内容了。

谢谢阅读！
