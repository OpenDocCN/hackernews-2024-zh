- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-27 14:31:58'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: Ubuntu 22.04 Root on ZFS — OpenZFS documentation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://openzfs.github.io/openzfs-docs/Getting%20Started/Ubuntu/Ubuntu%2022.04%20Root%20on%20ZFS.html](https://openzfs.github.io/openzfs-docs/Getting%20Started/Ubuntu/Ubuntu%2022.04%20Root%20on%20ZFS.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Create datasets:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The datasets below are optional, depending on your preferences and/or software
    choices.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'If you wish to separate these to exclude them from snapshots:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If desired (the Ubuntu installer creates these):'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If you use /srv on this system:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If you use /usr/local on this system:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If this system will have games installed:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If this system will have a GUI:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If this system will use Docker (which manages its own datasets & snapshots):'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If this system will store local email in /var/mail:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If this system will use Snap packages:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'If you use /var/www on this system:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'For a mirror or raidz topology, create a dataset for `/boot/grub`:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'A tmpfs is recommended later, but if you want a separate dataset for `/tmp`:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The primary goal of this dataset layout is to separate the OS from user data.
    This allows the root filesystem to be rolled back without rolling back user data.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: If you do nothing extra, `/tmp` will be stored as part of the root filesystem.
    Alternatively, you can create a separate dataset for `/tmp`, as shown above. This
    keeps the `/tmp` data out of snapshots of your root filesystem. It also allows
    you to set a quota on `rpool/tmp`, if you want to limit the maximum space used.
    Otherwise, you can use a tmpfs (RAM filesystem) later.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Note:** If you separate a directory required for booting (e.g. `/etc`) into
    its own dataset, you must add it to `ZFS_INITRD_ADDITIONAL_DATASETS` in `/etc/default/zfs`.
    Datasets with `canmount=off` (like `rpool/usr` above) do not matter for this.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
