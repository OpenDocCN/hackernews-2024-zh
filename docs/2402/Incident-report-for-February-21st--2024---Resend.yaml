- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-29 13:19:49'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: Incident report for February 21st, 2024 · Resend
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://resend.com/blog/incident-report-for-february-21-2024](https://resend.com/blog/incident-report-for-february-21-2024)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Summary (TL;DR)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: On February 21st, 2024, Resend experienced an [outage](https://resend-status.com/incident/329826)
    that affected all users due to a database migration that went wrong. This prevented
    users from using the API (including sending emails) and accessing the dashboard
    from 05:01 to 17:05 UTC (about 12 hours).
  prefs: []
  type: TYPE_NORMAL
- en: The database migration accidentally deleted data from production servers. We
    immediately began the restoration process from a backup, which completed 6 hours
    later. Unfortunately, once it finished, we found that it failed to restore the
    data, so we had to start the restoration process a second time with a different
    backup.
  prefs: []
  type: TYPE_NORMAL
- en: During this time, no API requests were being accepted and no data being stored.
    For data created prior to the migration, there was 5 minute of data loss from
    when the migration started and the database went offline from 04:50:00 to 04:56:27
    UTC. We are currently working on re-populating the data from this 5-minute window.
  prefs: []
  type: TYPE_NORMAL
- en: We sincerely apologize for the impact and inconvenience caused by this outage.
    We place immense importance on reliability, but this week, we fell short of our
    commitment to you all. It is clear that we have a long way to go in becoming an
    industry-leading infrastructure provider, but in learning from this incident,
    we will improve our operations and tooling to avoid outages like this in the future,
    whatever the cause.
  prefs: []
  type: TYPE_NORMAL
- en: Timeline
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*All times are in Coordinated Universal Time (UTC)*'
  prefs: []
  type: TYPE_NORMAL
- en: '**February 21st, 2024**'
  prefs: []
  type: TYPE_NORMAL
- en: '04:56: Database migration started'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '04:57: Noticed tables being dropped from the production database'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '05:01: Began restoring the database from a backup'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '05:02: Posted on [status page](https://resend-status.com/incident/329826),
    updating every 30-60 minutes until resolution'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '11:02: First restoration process completed'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '11:03: Realized the first backup failed and started to investigate'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '11:33: Found that the backup failed due to a wrong selection of the backup
    timestamp'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '11:48: Increased compute to speed up the restoration process - updated database
    memory from 128GB to 256GB and CPU from 32-core ARM to 64-core ARM'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '12:05: Began restoring the database from an older backup'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '17:01: Second restoration process completed'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '17:02: API began receiving requests'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '17:05: Dashboard was accessible again, and incident was resolved'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What happened
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: While building a feature, we performed a database migration command locally,
    but it incorrectly pointed to the production environment instead, which dropped
    all tables in production.
  prefs: []
  type: TYPE_NORMAL
- en: The first attempt to restore the database took 6 hours but failed due to a wrong
    selection of the backup timestamp. The second attempt to restore took an extra
    5 hours and succeeded, bringing all data back besides a 5-minute window of data
    loss.
  prefs: []
  type: TYPE_NORMAL
- en: Impact
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: All users were unable to send emails, use the API, or access the Resend dashboard
    for 12 hours from 05:01 to 17:05 UTC.
  prefs: []
  type: TYPE_NORMAL
- en: For data created prior to the migration, there was 5 minutes of data loss from
    when the migration started and the database went offline from 04:50:00 to 04:56:27
    UTC.
  prefs: []
  type: TYPE_NORMAL
- en: Next steps and improvements
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Re-populate data from the 5-minute window of data loss.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: No accessible user role should have write privileges on the production database.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Improve local development to reduce risks related to database migrations.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create redundancy to preserve sending function even during a database outage.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Increase cadence for disaster recovery tests.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implement incident banner on Resend dashboard to inform users quickly.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To our customers, we are deeply sorry that this incident occurred and that it
    prevented you from delivering your mission-critical emails. We know that actions
    speak louder than words, so we will continue to learn, grow, and improve, starting
    by implementing the improvements listed above.
  prefs: []
  type: TYPE_NORMAL
