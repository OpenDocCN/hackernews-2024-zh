<!--yml

category: 未分类

date: 2024-05-29 13:20:49

-->

# 如何避免千刀万剐？或者说，如何思考软件质量问题。

> 来源：[https://www.evalapply.org/posts/how-to-not-die-by-a-thousand-cuts/index.html](https://www.evalapply.org/posts/how-to-not-die-by-a-thousand-cuts/index.html)

* * *

首先，质量究竟是什么？

一切事物都会出现、变化和消亡。我认为*质量*是过程的体验。*优质*的理念基本上归结为以优雅的方式执行过程，并且比我们发现时更好地留下它。

此外，出现和变化的过程——即生活——也是死亡的过程。由此可见，要清晰地思考前者的质量，必须清晰地思考后者的质量。它可能以一种缓慢而痛苦的衰败方式展开，没有愈合的安慰、意义或希望。俗称的千刀万剐。我希望你永远不要远观如此逝去。

好吧，这变得很黑暗，如果我们不小心，我们将产生一本关于摩托车维护的300页禅宗对话。因此，我们将用思考软件产品质量这个更小、更轻松—我认为甚至更愉悦—的任务来分散注意力。

以下内容并不新颖，但我觉得*及*其周围的背景值得重复，因为如果不明显的话，软件会一次又一次地让我们失望。很多时候后果非常严重。

# 软件产品的本质是什么？

看到了吧？这已经比问“生活的本质是什么？”容易多了。

和任何其他机器一样，软件产品由许多思想和手的劳动构成，在其整个生命周期内需要维护和保养。

不同于*所有*其他机器，它是纯粹的概念，因此它是无限可塑和可变的。它确实一直在变异。

有时，“完成”的软件会出现，只需要进行小修补和补丁，但在目的、界面和行为上保持不变。许多Unix工具属于这一类。像ZeroMQ这样的一些项目明确设定了这样的目标。很多Clojure程序员都重视这种“完成性”。这样的例子比比皆是。

大多数软件无法享有这种奢侈。大多数软件必须无限期地进行变更，因为它必须服务的世界也在无限期地变化。Emacs编辑器是一个自1976年问世以来不断发展的软件产品，已经*将近半个世纪*，并且它仍然兴旺发展。这篇文章是在Emacs中编写的。

还有一个强大的反馈循环。软件快速改变世界，迫使软件更快地改变。机器学习和人工智能的当前重生可以被视为这一过程的表达。我们基本上在说，事情加速得如此之快，以至于人类*几乎*无法以足够快的速度编写和修订软件，以赶超变化的步伐。因此，我们必须找到算法来感知世界，然后动态生成或修订其他算法以实现系统目标（即改变世界以利己）。

我们必须要想一想，如何确保我们的产品在如此持续且有时剧烈变化的压力下继续蓬勃发展和成功？谁应该为此负责？

# 谁来对软件质量保证负责？

**通常嫌疑人**？

+   那些“质量保证”专家？开发者？用户体验专家？DevOps？

**不太常见的嫌疑人**？

考虑下面的情景。所有这些都直接影响到顾客，让他们觉得“质量差”。考虑到谁应该为根本问题（或更可能是问题）负责？

+   你的应用框架极为高效且无故障。但你的应用却失败了。

+   一个功能确实做到了它所承诺的事情，但人们却没有正确使用它。

+   你的公司将自己的一半投入到了以创纪录的速度推出第二款产品，但顾客从未真正需要它。

+   一个巨大的更新被迫推出。自然而然，它表现不佳，无法回滚，修复成本比推出成本高出5倍，重新工作有效地延长了你的世界统治计划数月。

+   你的服务无法扩展。你发现没有进行基准测试。

+   部署中断了生产。你发现了一个糟糕的配置。

+   一个功能泄漏数据给意外的用户，并违反SLA/法规。你的CEO发表声明，指责一个DevOps工程师。

+   几小时的故障未被监控，导致严重的广泛数据损坏。

+   你的生产明显经常降级。一只大海洋哺乳动物是你的吉祥物。

+   你的生产很少降级，但当它降级时，它会连同一半已知的互联网一起崩溃。

+   等等……

在一个诚实的自我反思的安静时刻，你可能会向镜子承认，千刀万剐的比喻确实适用。以上任何情况很可能是削减成本的产物，这些削减在当时对肉眼几乎是看不见的。这些小削减加起来——不，*复合*——随着时间慢慢积累，开始时像创可贴，然后是缝线和石膏，突然间就像是坏疽。也许整个事情因为这些削减而死亡，或者作为一个勉强存活的实体继续下去，直到有人下定决心拔管（或提供救助）。

你甚至可能承认，也许，只 *也许*，确保产品质量的工作属于*参与产品生命周期的每个功能*。

# 为什么？

假设我们模拟传统的软件生产工作流程，即分析 -> 产品需求 -> 用户体验/设计 -> 开发 -> “QA” -> 生产。

如此严格的线性模型在整个软件行业中很常见。这在时间、复杂性、成本和风险方面都有所体现。

```
 ^   Feedback
 Analysis -> Product -> UX/Design -> Dev -> "QA" ->  Prod --./--> arrives
                                                           /      too late
                                                         /-
                                                       /-
                                                     /- ^
                                                  /--   | Price of fixing
                                               /--      | errors and
                                           /---   ^     | corner cuts.
                                       /---       |     |
                                  /----   ^       |     | ~ AND/OR ~
                             /----        |       |     | Compounding of
                     /------   ^          |       |     | software debt.
            /--------          |          |       |     |
  ----------      ^            |          |       |     | ~ AND/OR ~
   ^              |            |          |       |     | Increasing odds
   |              |            |          |       |     | of being wrong.
---+--------------+------------+----------+-------+-----+---------------->
                            Time, Complexity, Sunk costs 
```

以这种方式将线性工作流可视化暗示了一些事情：

+   所有风险实际上都集中在分析阶段。如果那错了，那么一切都错了。

+   工作流看起来是线性的，但有一个复利增长债务/风险配置文件。

+   通过将一个单一团队负责“保证”产品质量，我们最大化了我们被迟误的几率，以及完全未能发现坏消息的几率。

从图片上不明显的是，风险植根于*反馈延迟*。当交付压力很大时，弱信号会消失。

我们因削减而导致的风险配置文件看起来是一样的，如果工作流程严格按上述描述。无论是在几个月内以大批量缓慢进行，还是在几天内以小批量更快进行，都无关紧要。小规模的线性化批次甚至可能加剧总体风险配置文件，例如当市场反馈环路延迟或不连续时。批次越小，越有可能是我们现在才得到的几批反馈。这种延迟反馈往往会严重干扰严格线性的流程。

上述图片也是不完整的。要全面了解，我们需要深入讨论系统（这是另一天的长谈）。我们可以通过场景做一个小小的开始。考虑产品光谱上的点，破坏/创造质量的方式，以及什么可能帮助我们从更差到更好？

# 对于不同类型的产品，情况会有所不同吗？

假设我们对比由主要客户定义的产品光谱的两个典型极端。哪一个会面临千刀万剐的死亡风险？

| 关键增长指标 | 收入增长 | 用户增长 |
| --- | --- | --- |
| 主要销售驱动因素 | 推荐 + 执行可信度 | 推荐 + 朋友和家人的体验 |
| 客户风险 | 每个账户的高风险/回报 | 每个账户的微观经济学 |
| 合同风险 | 带有严重惩罚的服务级别协议 | 用户不会读的1个EULA / ToS |
| 等等... | ... | ... |

嗯，这件事。不仅所有软件会突变，我们也最终在*生产它的组织*上进行了各种深度手术。整个事物——产品和组织——*同时*被灵活地重新配置，甚至完全在原地重新设计，这在其他行业中是非常不常见的。为什么？因为软件基本上是人们的思想在不断重复播放。

所以无论我们如何分解它，共同的主题是这样的。每一个热修复都是一个切割。每一个投诉都是一个切割。每一个应用程序崩溃都是一个切割。每一个服务中断都是一个切割。等等。每一个切割都会缓慢愈合并破坏质量和价值评估。

# 如何破坏质量？

提出破坏质量的方法很有用，这样我们可以与生成质量的方法进行对比。到目前为止，在工作生活中我见过并听到了以下所有情况（希望没有积极地实施它们，但记忆是一个善变的东西）。

+   将软件测试误解和错误标记为质量保证。测试*不是*“质量保证”。

+   表面上让所有团队对他们的“QA”负责，实际上意味着让经验最少的人日常操作它。

+   创建一个文化，让像这样说话的事情很正常）：

    +   “嘿，我要把这个添加到冲刺中。这只是一个小事情，所以我们不要推迟我们的最后期限。”

    +   "测试很无聊。"

    +   "如果顾客抱怨，我们会修复它。"

    +   “谁他妈写了这段代码？”

    +   “啊，是的，这些是已知的不稳定测试。只需重新触发构建。”

    +   "你不了解你的工作。上线吧。"（这一句让我很伤心。喝杯啤酒/咖啡时我会告诉你的：）。

+   确保设计师、开发者和测试人员按照他人设定的任务和优先级工作。

+   确保有人因错误受到责备。

+   设立激励措施，使各部门相互竞争。

+   雇佣一位沃冈或达斯·维达CEO。

+   进一步[规范所有种类的反常行为](https://danluu.com/wat/)。

这只是我写这篇文章时回忆起来的一些要点清单。尽可能多地想出方法。灵感的#专家建议：阅读CIA现已解密的[简易破坏领域手册](https://www.gutenberg.org/files/26184/page-images/26184-images.pdf)。特别注意第11部分：*总体干扰组织和生产*。

# 如何创造质量？

一个线索是*不*做破坏质量的事情。另一个是做质量破坏事情的*反向*（例如，分享知识而不是囤积它）。第三个是注意高质量产品生产组织是否有共同的特征（他们确实有）。也许最重要的是理解，没有公式可以获得这些特征的方法。

要设计和构建高质量的软件产品，必须设计和构建高质量的全组织系统和文化。我们有许多工具、框架、基本理念可供选择。但是，没有“最佳实践”流程或方法论，也没有像“一个奇怪的窍门”那样的干预能修复破碎的系统和破碎的人。

“道路”必须共同演进：

+   由协作利益相关者，

+   传播到整个组织，

+   适合组织独特的背景，

+   与顾客、合作伙伴和直接生态系统一起。

这是一个普遍非常困难的过程，挑战与一年偷懒后恢复健康非常相似。它需要心态、领导力和持久的整体智能*eval/apply*行为。所有这些都源自*视角*。

> "*视角价值80个智商点。*"
> 
> — Alan Kay

因此，如果我们要从质量更差到质量更好的路线图，我们的第一责任必须是故意通过寻找对我们来说新的、多样化的、挑战现状的视角而感到非常不舒服。并且...

# 第一个技能是学会有建设性地承受痛苦。

我们在受苦，你和我。

这是不可避免的。然而，这也是生命蓬勃发展的原因。*"为什么我们要受苦？"*是一个很好的讨论话题，因为建设性的苦难会带来高质量的成果。

好了，回到现实世界……

在一年的松懈后，重新恢复到 *先前的* 峰值状态的路径充满了酸痛的肌肉、对闹钟的咒骂、许多日子里变得脾气暴躁、对主流化的快速满足感的不断心理斗争。这一过程越来越艰难，然后才会变得更容易。接着我们到达了先前S形曲线的顶峰。然后我们必须再次开始这个循环，去攀登下一个曲线。

我们非常幸运。

同样的遭遇者一直在促进品质生成性的对话和变革。我们可以接触到日益增长的顶尖行业研究 *和* 经验报告。毫不夸张地说，这些教训中很多都是以眼泪、鲜血和生命为代价的。让我们用这些强大的工具来增强我们的直觉。那些艰难获得的 *额外80个智商点* 就是我们的。

一些精选资源。

许多因素塑造了我对质量（其实，所有事物，因为一切都相互联系）的思考方式；人们、事件、书籍、讲座等。如果你想知道应该去哪里，这些不是处方，而是一种样品拼盘。它们是你自己搜索的触发器。请给我更多建议！

系统：

软件复杂性：

失败：

共同完成：

自我（因为我认同自己是软件程序员，所以有重大偏见）：

“实践哲学”，用不着更好的词汇：

我最近发现了吉恩·金（Gene Kim）的播客，[The Idealcast](https://itrevolution.com/the-idealcast-podcast/)。吉恩在这里集合了许多优秀的人和资源。一定要去看一看。

# 注意事项、我的错，等等。

我仍然在不断进步，这篇文章是我当前的直觉。

这篇文章深受个人职业生涯近20年中许多明智和不明智的评估/应用循环的影响，其中包括个人失败、无知的错误和偶尔的胜利。还有生活本身。这些经历也受到了与理解世界远比我理解更深的人们共事的幸运影响。当然还有大量阅读、思考、交流，经常在遇到壁垒和障碍后“怒火中烧”。

因此，请取其精华，弃其糟粕。

愿原力与你同在 _\\//
