- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-27 14:50:56'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
- en: DNSSEC vulnerability puts big chunk of the internet at risk • The Register
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://www.theregister.com/2024/02/13/dnssec_vulnerability_internet/](https://www.theregister.com/2024/02/13/dnssec_vulnerability_internet/)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Updated A single packet can exhaust the processing capacity of a vulnerable
    DNS server, effectively disabling the machine, by exploiting a 20-plus-year-old
    design flaw in the DNSSEC specification.
  id: totrans-split-6
  prefs: []
  type: TYPE_NORMAL
- en: That would make it trivial to take down a DNSSEC-validating DNS resolver that
    has yet to be patched, upsetting all the clients relying on that service and make
    it seem as though websites and apps were offline.
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
- en: The academics who found this flaw – associated with the German National Research
    Center for Applied Cybersecurity (ATHENE) in Darmstadt – claimed DNS server software
    makers briefed about the vulnerability described it as "the worst attack on DNS
    ever discovered."
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
- en: Identified by Professor Haya Schulmann and Niklas Vogel of the Goethe University
    Frankfurt; Elias Heftrig of Fraunhofer SIT; and Professor Michael Waidner at the
    Technical University of Darmstadt and Fraunhofer SIT, the security hole has been
    named [KeyTrap](https://www.presseportal.de/pm/173495/5713546), designated [CVE-2023-50387](https://kb.isc.org/docs/cve-2023-50387),
    and assigned a CVSS severity rating of 7.5 out of 10.
  id: totrans-split-9
  prefs: []
  type: TYPE_NORMAL
- en: 'As of December 2023, approximately 31 percent of web clients worldwide used
    DNSSEC-validating DNS resolvers and, like other applications relying on those
    systems, would feel the effects of a KeyTrap attack: With those DNS servers taken
    out by the flaw, clients relying on them would be unable to resolve domain and
    host names to IP addresses to use, resulting in a loss of connectivity.'
  id: totrans-split-10
  prefs: []
  type: TYPE_NORMAL
- en: The researchers said lone DNS packets exploiting KeyTrap could stall public
    DNSSEC-validated DNS services, such as those provided by Google and Cloudflare,
    by making them do calculations that overtax server CPU cores.
  id: totrans-split-11
  prefs: []
  type: TYPE_NORMAL
- en: This disruption of DNS could not only deny people's access to content but could
    also interfere with other systems, including spam defenses, cryptographic defenses
    (PKI), and inter-domain routing security (RPKI), the researchers assert.
  id: totrans-split-12
  prefs: []
  type: TYPE_NORMAL
- en: '"Exploitation of this attack would have severe consequences for any application
    using the Internet including unavailability of technologies such as web-browsing,
    e-mail, and instant messaging," they claimed. "With KeyTrap, an attacker could
    completely disable large parts of the worldwide internet."'
  id: totrans-split-13
  prefs: []
  type: TYPE_NORMAL
- en: A non-public technical paper on the vulnerability provided to *The Register*,
    titled, "The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNS,"
    describes how an assault would be carried out. It basically involves asking a
    vulnerable DNSSEC-validating DNS resolver to look up an address that causes the
    server to contact a malicious nameserver that sends a reply that causes the resolver
    to consume most or all of its own CPU resources.
  id: totrans-split-14
  prefs: []
  type: TYPE_NORMAL
- en: With KeyTrap, an attacker could completely disable large parts of the worldwide
    Internet
  id: totrans-split-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '"To initiate the attacks our adversary causes the victim resolver to look up
    a record in its malicious domain," the due-to-be-published paper states. "The
    attacker’s nameserver responds to the DNS queries with a malicious record set
    (RRset), according to the specific attack vector and zone configuration."'
  id: totrans-split-16
  prefs: []
  type: TYPE_NORMAL
- en: 'The attack works, the paper explains, because [the DNSSEC spec](https://datatracker.ietf.org/doc/rfc2535/)
    follows [Postel’s Law](https://www.cs.tufts.edu/comp/117/assts/postel): "The nameservers
    should send all the available cryptographic material, and the resolvers should
    use any of the cryptographic material they receive until the validation is successful."'
  id: totrans-split-17
  prefs: []
  type: TYPE_NORMAL
- en: This requirement, to ensure availability, means DNSSEC-validating DNS resolvers
    can be forced to do a lot of work if presented with colliding key-tags and colliding
    keys that must be validated.
  id: totrans-split-18
  prefs: []
  type: TYPE_NORMAL
- en: '"Our complexity attacks are triggered by feeding the DNS resolvers with specially
    crafted DNSSEC records, which are constructed in a way that exploits validation
    vulnerabilities in cryptographic validation logic," the paper explains.'
  id: totrans-split-19
  prefs: []
  type: TYPE_NORMAL
- en: '"When the DNS resolvers attempt to validate the DNSSEC records they receive
    from our nameserver, they get stalled. Our attacks are extremely stealthy, being
    able to stall resolvers between 170 seconds and 16 hours (depending on the resolver
    software) with a single DNS response packet."'
  id: totrans-split-20
  prefs: []
  type: TYPE_NORMAL
- en: The ATHENE boffins said they worked with all relevant vendors and major public
    DNS providers to privately disclose the vulnerability so a coordinated patch release
    would be possible. The last patch was finished today.
  id: totrans-split-21
  prefs: []
  type: TYPE_NORMAL
- en: '"We are aware of this vulnerability and rolled out a fix in coordination with
    the reporting researchers," a Google spokesperson told *The Register*. "There
    is no evidence of exploitation and no action required by users at this time."'
  id: totrans-split-22
  prefs: []
  type: TYPE_NORMAL
- en: Network research lab NLnet Labs published [a patch](https://nlnetlabs.nl/downloads/unbound/patch_CVE-2023-50387_CVE-2023-50868.diff)
    for its Unbound DNS software, addressing two vulnerabilities, one of which is
    KeyTrap. The other bug fixed, [CVE-2023-50868](https://nlnetlabs.nl/downloads/unbound/CVE-2023-50387_CVE-2023-50868.txt),
    referred to as the NSEC3 vulnerability, also allows denial of service through
    CPU exhaustion.
  id: totrans-split-23
  prefs: []
  type: TYPE_NORMAL
- en: '"The KeyTrap vulnerability works by using a combination of keys (also colliding
    keys), signatures and number of RRSETs on a malicious zone," NLnet Labs [wrote](https://nlnetlabs.nl/news/2024/Feb/13/unbound-1.19.1-released/).
    "Answers from that zone can force a DNSSEC validator down a very CPU intensive
    and time costly validation path."'
  id: totrans-split-24
  prefs: []
  type: TYPE_NORMAL
- en: PowerDNS, meanwhile, has an update [here](https://doc.powerdns.com/recursor/security-advisories/powerdns-advisory-2024-01.html)
    to thwart KeyTrap exploitation.
  id: totrans-split-25
  prefs: []
  type: TYPE_NORMAL
- en: '"An attacker can publish a zone that contains crafted DNSSEC related records.
    While validating results from queries to that zone using the RFC mandated algorithms,
    the Recursor’s resource usage can become so high that processing of other queries
    is impacted, resulting in a denial of service," the team wrote. "Note that any
    resolver following the RFCs can be impacted, this is not a problem of this particular
    implementation."'
  id: totrans-split-26
  prefs: []
  type: TYPE_NORMAL
- en: 'The fix for CVE-2023-50387 is just [one of six](https://seclists.org/oss-sec/2024/q1/125)
    vulnerabilities addressed in Internet Systems Consortium''s BIND 9 DNS software.
    The others include:'
  id: totrans-split-27
  prefs: []
  type: TYPE_NORMAL
- en: '[CVE-2023-4408](https://kb.isc.org/docs/cve-2023-4408): Parsing large DNS messages
    may cause excessive CPU load;'
  id: totrans-split-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[CVE-2023-5517](https://kb.isc.org/docs/cve-2023-5517): Querying RFC 1918 reverse
    zones may cause an assertion failure when "nxdomain-redirect" is enabled;'
  id: totrans-split-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[CVE-2023-5679](https://kb.isc.org/docs/cve-2023-5679): Enabling both DNS64
    and serve-stale may cause an assertion failure during recursive resolution;'
  id: totrans-split-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[CVE-2023-6516](https://kb.isc.org/docs/cve-2023-6516): Specific recursive
    query patterns may lead to an out-of-memory condition;'
  id: totrans-split-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[CVE-2023-50868](https://kb.isc.org/docs/cve-2023-50868): Preparing an NSEC3
    closest encloser proof can exhaust CPU resources.'
  id: totrans-split-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The requirements for the KeyTrap vulnerability date all the way back to 1999
    from the now obsolete RFC 2535, according to the research team that identified
    it. And by 2012, these elements appeared in [RFC 6781](https://datatracker.ietf.org/doc/rfc6781/)
    and [RFC 6840](https://datatracker.ietf.org/doc/rfc6840/), the implementation
    requirements for DNSSEC validation.
  id: totrans-split-33
  prefs: []
  type: TYPE_NORMAL
- en: One packet suffices. You don't have to do more than that to disconnect an entire
    network
  id: totrans-split-34
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Since at least August 2000 – more than 23 years ago – KeyTrap has been present
    in the BIND 9 DNS resolver, and it surfaced seven years later in the Unbound DNS
    resolver.
  id: totrans-split-35
  prefs: []
  type: TYPE_NORMAL
- en: Dr Haya Shulman, a professor of computer science and one of the academics behind
    the KeyTrap research, told *The Register* in a phone interview the attack is simple
    and can be carried out by encoding it in a [zone file](https://dnsinstitute.com/documentation/dnssec-guide/ch04s02.html#signing-verify-zone-file).
  id: totrans-split-36
  prefs: []
  type: TYPE_NORMAL
- en: '"The vulnerability is actually something that''s recommended in the DNSSEC
    standard," Prof Shulman explained. "One packet suffices. You don''t have to do
    more than that to disconnect an entire network."'
  id: totrans-split-37
  prefs: []
  type: TYPE_NORMAL
- en: Prof Shulman said the patches that have been issued by various vendors break
    the standard. "The problem is this attack is not easy to solve," she said. "If
    we launch it against a patched resolver, we still get 100 percent CPU usage but
    it can still respond."
  id: totrans-split-38
  prefs: []
  type: TYPE_NORMAL
- en: The ATHENE team observed that while the flaw remained undetected for decades,
    its obscurity isn't surprising because DNSSEC validation requirements are so complicated.
    So too is mitigating the vulnerability and completely eliminating it will require
    a revision of the DNSSEC standard. ®
  id: totrans-split-39
  prefs: []
  type: TYPE_NORMAL
- en: Updated to add on February 16
  id: totrans-split-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You can now download the [technical paper here](https://www.athene-center.de/fileadmin/content/PDF/Technical_Report_KeyTrap.pdf)
    as a PDF.
  id: totrans-split-41
  prefs: []
  type: TYPE_NORMAL
- en: Also, Akamai exec Sven Dummer thanked the research team for not only discovering
    the flaw but also working with DNS providers and software makers to coordinate
    the patching and redeployment of systems to avoid mass exploitation.
  id: totrans-split-42
  prefs: []
  type: TYPE_NORMAL
- en: '"You might not know it, but the global internet dodged a bullet: KeyTrap is
    a vulnerability in key infrastructure that is needed for the internet to function
    — and one of the worst ever discovered," he [opined](https://www.linkedin.com/posts/svenhdummer_cve-2023-50387-and-cve-2023-50868-dns-exploit-activity-7164147641054949377-4qwQ/).'
  id: totrans-split-43
  prefs: []
  type: TYPE_NORMAL
- en: '"With KeyTrap, an attacker could completely disable large parts of the worldwide
    internet."'
  id: totrans-split-44
  prefs: []
  type: TYPE_NORMAL
