<!--yml

类别：未分类

日期：2024-05-27 14:51:49

-->

# Redis的力量：深入了解缓存系统

> 来源：[https://nintyzeros.substack.com/p/power-of-redis-a-deep-dive-into-caching](https://nintyzeros.substack.com/p/power-of-redis-a-deep-dive-into-caching)

*👋 嗨，这是 [](https://twitter.com/gergelyorosz) Venkat，我在这里带着《ZenMode工程师通讯》的整个问题。每期我都会简单解释一个与计算机技术及其它相关领域相关的主题。*

* * *

在高性能应用程序领域，像Redis这样的缓存系统是速度和效率的守护者。

它们充当中间人，拦截数据请求并以闪电般的速度提供经常访问的信息，同时保护您的主要数据源免受过大负荷的影响。

但这些系统是如何发挥魔力的呢？准备好了吗，让我们深入理解Redis及其缓存技术。（***详细架构和使用案例（付费）***）

但在此之前... 什么是缓存？为什么我们需要它？

想象一下，你走到自己的咖啡馆（当然是为了工作！）。

每天早上都有特定的咖啡豆☕需求。

你会做什么？

与每天早晨在整个食品储藏室寻找不同，您将速溶咖啡罐放在手边以便快速冲泡。

这就是***缓存***的本质：

将经常使用的数据存储在方便快速访问的位置以加快检索速度。

在数字世界中，数据通常存储在比计算机内存（RAM）更慢的硬盘上。

从硬盘访问数据就像走到食品储藏室，而从RAM访问数据就像从罐子里取出速溶咖啡一样快。

所以，如果您需要：

+   **速度：** 它显著提高了响应时间。就像您通过速溶咖啡更快地获取咖啡一样，您的应用程序和网站通过缓存数据加载速度更快。⚡⚡

+   **减少负载：** 频繁访问数据库可能会使其过载，影响性能。缓存减轻了数据库的负担，确保平稳运行。🔃

+   **成本效益：** 通过最小化数据库使用，缓存可以降低服务器成本，特别是对于高流量的应用程序。💲💲💲

尽管有不同类型的缓存，您可以根据需求进行优化。

+   **浏览器缓存：** 将网站数据存储在您的设备上，以便未来访问更快。

+   **应用程序缓存：** 特定应用程序实现其自己的缓存机制。

+   **内容分发网络（CDN）：** 将缓存内容分布在地理位置分散的服务器上，以加快全球访问速度。

好的，让我们回到Redis！

[Redis](https://redis.io/?ref=architecturenotes.co)（“***RE***mote ***DI***ctionary ***S***ervice”）是一个开源的键值数据库服务器。

Redis最准确的描述是它是一个数据结构服务器。Redis特有的这种特性使其在开发者中广受欢迎和采用。

想象一个图书馆，最受欢迎的书籍可以立即在专用书架上找到，而不是藏在书架中。

这就是Redis的关键原则 - 它将频繁访问的数据存储在内存（RAM）中，比传统基于磁盘的存储快得多。

这意味着数据检索速度极快，与从数据库中访问数据的缓慢形成鲜明对比。

但速度并非一切。

缓存系统也充分利用了键值存储的强大功能。

将它们视为数字词典，其中每个数据项与唯一键关联。

这使得快速查找和检索成为可能，无需扫描大量数据以找到所需的内容，基于下面的关键概念。

+   **哈希：** 用于在内存中将键映射到数据位置。Redis使用自己的哈希函数（MurmurHash）来进行高效的键分布和检索。

+   **跳跃表：** 在有序集合中用于有效地维护基于分数的有序元素。跳跃表提供对插入、删除和检索操作的对数时间复杂度。

+   **发布/订阅：** 利用发布-订阅模式进行实时数据更新。频道充当主题，订阅者会收到发布到相关频道的新消息的通知。

它拥有一系列适应各种需求的数据结构：

让我们深入探讨每种Redis数据结构，并用一些具体的例子来说明它们的用例：

1.  **简单字符串类型：**

    考虑缓存频繁访问的用户配置文件，存储网站配置设置，或跟踪简单计数器。

    > 将用户的姓名存储在键“username:JohnDoe”下，值为“John Smith”。

1.  **哈希类型：**

    存储具有多个属性的用户配置文件，带有各种详细信息的产品信息，或者购物车内容，包括项目ID和数量。

    > 将用户的配置文件信息存储在键“user:123”下，包括“name”，“email”和“age”字段。

1.  **列表：**

    实现任务队列，管理聊天消息历史记录，或创建待办事项列表应用程序。

    > 使用名为“todo:JohnDoe”的列表来存储任务，例如“购买杂货”，“完成报告”和“给妈妈打电话”。

1.  **集合：**

    过滤重复条目，检查用户是否属于组，或实现实时聊天室成员列表。

    > 使用名为“unique_users”的集合来存储网站分析中的唯一用户ID。

1.  **有序集合：**

    创建游戏或竞赛排行榜，根据重要性优先处理任务，或实现实时热门话题。

    > 使用名为“leaderboard”的有序集合来根据游戏中的得分对用户进行排名，最高分位于顶部。

此外，它还支持：

+   **Redis Streams：** 想象一个社交媒体平台像Twitter使用Redis Streams来实时处理和存储大量的推文。

+   **Redis Pub/Sub：** 新闻网站可以使用Redis Pub/Sub将突发新闻更新实时广播给所有订阅用户。

+   **Redis Lua脚本：** 一个电子商务平台可能会使用Lua脚本在Redis中根据特定条件条件性地更新产品价格。

    这种灵活性使Redis能够适应广泛的用例，从缓存经常访问的网站内容到支持实时聊天应用程序。

记住，数据结构的选择取决于您的具体需求和您正在处理的数据类型。

通过理解这些多样化的选择，您可以充分利用Redis，构建高效、可扩展的应用程序。

**那么，魔法是如何发生的呢？**

1.  想象一下，您的网络浏览器想要显示一个网站。*它首先询问Redis，“嘿，你有这个页面的内容吗？”*

1.  Redis就像一个超级快的图书管理员。它检查其“内存书架”（RAM），看看请求的数据是否存在。

    这个检查过程发生在微秒级，比在硬盘上搜索传统数据库要快得多。

1.  如果Redis找到了数据（缓存命中！），就像立即在书架上找到书一样。它立即将数据发送给浏览器，结果是极快的页面加载速度。

1.  如果数据不在缓存中（缓存未命中），就像书被借走或丢失了一样。然后Redis会去更慢的“主图书馆”（数据库）中检索数据。

1.  Redis从数据库中检索数据，并像一个好的图书管理员一样，将其添加到自己的“内存书架”中以备将来请求。这样，如果其他人需要同一页内容，它就可以从缓存中快速获取，避免再次访问数据库。

1.  就像图书馆备份其收藏一样，Redis可以选择将缓存的数据写入磁盘（RDB或AOF），以防停电或重启时丢失数据。这确保数据不会丢失，但速度比纯内存存储要慢。

**关键见解：**

+   Redis拥有各种“数据结构”，如字符串、列表和集合，每种都适用于不同类型的信息。想象图书馆中不同部分用于不同的内容格式。

+   缓存并不需要完美。有时，缓存中的数据可能稍有过时，但通常为了速度所做的权衡是值得的。

+   Redis还可以用于实时数据处理、排行榜等，不仅仅是缓存。它是多种数据需求的多功能工具。

*但是你可能会想，Redis为什么这么快呢？*

Redis比传统数据库更快的惊人速度归结为两个关键因素：**内存存储**和**优化的数据结构**。

但除了这些因素之外，它的速度要快得多，因为

+   **减少I/O操作：** 直接访问RAM中的数据可以避免磁盘I/O操作，消除与硬盘相关的瓶颈和延迟。

+   **单线程架构：** 与复杂的多线程处理数据库不同，Redis采用单线程模型，简化操作并减少开销。

+   **事件驱动设计：** Redis以其事件驱动的架构高效地响应请求，处理多个客户端而无需上下文切换延迟。

但即使有这些优点，它也有一些限制。

+   **容量有限：** RAM 小于硬盘，因此 Redis 无法存储大规模数据集。

+   **数据持久化：** 默认情况下，Redis 数据在重新启动时是易失的。持久化选项（RDB/AOF）存在但会带来性能权衡。

> **RDB（快照）：** 定期对整个数据集进行快照并存储在磁盘上。提供持久性但会增加性能开销。
> 
> **AOF（追加文件）：** 按顺序记录每个写操作。确保数据持久性但可能比 RDB 慢。

**选择正确的缓存系统是一种平衡行为**

采用像 Redis 这样的缓存系统的决定取决于几个因素：

+   **数据大小和访问模式：** 内存缓存在频繁访问较小数据集时表现出色。

+   **一致性要求：** 在最终一致性（缓存更新最终反映更改）和强一致性（即时缓存更新）之间做出选择。

+   **容错性：** 考虑集群化和数据持久化以实现高可用性和数据持久性。

感谢您阅读 The ZenMode。此文章为公开文章，欢迎分享。

[分享](https://nintyzeros.substack.com/p/power-of-redis-a-deep-dive-into-caching?utm_source=substack&utm_medium=email&utm_content=share&action=share)

让我们讨论各种 Redis 部署及其权衡。

我们主要关注这些配置：

1.  单个 Redis 实例

1.  Redis 高可用性

1.  Redis Sentinel

1.  Redis 集群

根据您的使用情况和规模，您可以决定使用其中一种设置。
