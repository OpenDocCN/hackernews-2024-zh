<!--yml

类别：未分类

日期：2024-05-27 14:35:34

-->

# Zen演变：一个小概述 - Locuza

> 来源：[https://locuza.substack.com/p/zen-evolution-a-small-overview](https://locuza.substack.com/p/zen-evolution-a-small-overview)

我觉得自己像《爱丽丝梦游仙境》中总是时间不够的兔子...

*爱丽丝梦游仙境*（1951年电影）

由于这一点，我可能会或可能不会组装第二个Zen 4部件，这将取决于其发布覆盖率。

尽管如此，我还是想分享一下从Zen 1到即将推出的Zen 4的有趣演变概述：

Zen 4的I/O芯片是一个占位图。

这张图片在Zen 4正式发布之前基本完成，但命运使得Twitter在几个国家关闭，因此我无法发布它。

正面的是，一些以前未知的数字已经变得公开。

例如，*[RetiredEngineer®](https://twitter.com/chiakokhua/status/1564413952108335105)*在Twitter上发布了一张比较表，展示了从Zen 3到Zen 4的一些变化。

与通过*[Angstronomics](https://www.angstronomics.com/p/ryzen-7000-desktop-preview)*来比较CCD晶体管数量和一些纯粹的猜测（ :> ），可以比较相互之间相当多的有趣数据。

从Zen 1开始，我们拥有了由Global Foundries在14/12 nm制造的单片SoC设计。

芯片尺寸约为212 mm²，集成了两个4核CCX以及用于PCIe、USB和Infinity Fabric的多个I/O设备。

整个SoC的晶体管密度约为23 MTr/mm²。

之后，AMD采用了芯片设计，在TSMC的N7节点制造了核心复合体，而I/O功能（PHYs在新节点上几乎不扩展）被分离为Global Foundries的更便宜的12nm芯片。

通过这一变化，我们在比较两个芯片以及前任时看到了鲜明的对比。

76 mm²的核心芯片通过采用50 MTr/mm²的晶体管密度实现了121%的提升，比Zen 1的单片设计好；而I/O芯片仅为16.72 MTr/mm²，比Zen 1 SoC差26%。

Zen 3采用“相同”的芯片设计和I/O芯片，但引入了新的N7 CCDs与新CPU核心，略大一些，导致CCD尺寸约为84 mm²，基本上相同的晶体管密度。

即将推出的Zen 4 Raphael套装再次采用相同的芯片设计，但通过新节点缩小了两个芯片。

CCD从N7迁移到N5，实现了91.3 MTr/mm²的晶体管密度，比前任增加了83%。

如果排除I/O PHY和其他模拟组件，AMD在与上一代节点相比实现了2倍的晶体管密度改进，这可能是真实的。

新的I/O芯片从12nm Global Foundries进化到6nm（N6）TSMC。

尽管晶体管的缩小是巨大的，新的I/O芯片几乎与之前一样大。

对此可能有几个潜在原因。

由于用于I/O PHY的模拟设备在新节点上无法很好地扩展。

当前的12纳米设计已经将所有芯片边缘都相当好地占据了I/O。

可以重新设计PHY以占用较少的水平空间并进一步进入芯片，但这可能具有挑战性且不受欢迎。

如果将当前设计缩小，可能不会使芯片的面积显著减少，因为这种设计受I/O物理接口（PHY）限制。

那些绿色部分在中间将会大量缩小，这也将导致大量未使用的区域。

然而，您可以免费集成新功能。

AMD已经完成了这项工作，现在的I/O芯片中包含一个RDNA2 iGPU，其中一个WGP（128个着色器），运行速度高达2.2 GHz（约564 FP32 GFLOPs）。

足以驱动显示器、简单应用程序，并捕获商业市场中的一部分，以前是无法访问的。

除了小型iGPU外，还将集成用于视频解码/编码的VCN引擎，以及必要的显示引擎和其显示物理接口。

最后，6纳米工艺节点通常会提高逻辑和SRAM设备的能效。

在核心设计方面，AMD每一代都涉及到了几个方面。

Zen 1和2共享相同的微架构基础，因此非常熟悉，使用4核心CCX和逻辑上相似的执行单元。

但由于7纳米工艺的收缩，Zen 2上的许多结构都可以被放大，其中一些放大幅度非常大。

添加了新的TAGE预测器，分支目标缓冲区（几乎）加倍，FPU宽度从128位增加到256位，实现单周期AVX256执行。

此外，每个CCX的L3缓存容量翻了一番。

很显然，继续下去，例如增加了多个寄存器/缓冲区，如重新排序缓冲区以从指令流中提取更多ILP，整数寄存器文件增加了几个条目，以及执行单元和加载/存储内存系统的各种调度队列。

除了简单的结构放大外，AMD还重新平衡了一些方面，如L1指令缓存的大小和op-cache的容量。

公司将L1I$的容量减半，以增加Op$的存储容量，以提供更多资源。

数据来自后者，比传统的L1I$/解码路径更有效和更宽的路径。

Zen 3改变了微架构的关键方面，并在使用相同的7纳米工艺节点时设定了新的设计基础。

三级BTB结构已经消失，改为只有两级，第一级执行时零气泡。

执行单元变得更宽，端口设计也有所变化。

在高层次上，您主要会看到预期的方案，几个结构尺寸稍微增加了。

除了改变许多核心属性外，Zen 3的另一个亮点是从2个CCX，各自拥有单独的L3缓存和与I/O芯片的往返，变为单个CCX设计，统一的L3缓存结构为所有8个核心提供服务。

Zen 4基本上是Zen 3核心的超级版，与Zen 2相比设计类似于Zen 1。

使用了相同的基础微架构，同时使用了增加的 5 纳米工艺的晶体管预算来升级几个结构。

前端的宽度从第四代开始一直保持不变，并且一直跟随我们。

像以前一样，我们有一个 4-wide 的传统解码路径和一个 6-wide 的分派到执行引擎。

然而，分支预测部分始终在改善中，Zen 4 在这方面也不例外。

BTB 再次增加，与 Zen 2 类似，更加注重 Op$ 路径的容量增加，从 4K 增加到 6.75K。

执行单元与之前的 Zen 3 相同（宽度 + 端口设计）。

因此，我们仍然在看 4x INT 管道，3x AGU 和一个 FPU，其中有 2x FADD 和 2x FMUL(FMA) 管道（+其他管道）。

类似于 Zen 2，大部分晶体管预算投入到 FPU 中，Zen 4 再次大力投资于 FPU。

现在支持 AVX512 和广泛的新指令集。

此外，自 Zen 1 以来首次，FP 寄存器的数量大幅增加。

如往常一样，你还会看到许多其他结构的增加，例如重新排序缓冲区现在可以容纳 320 个条目（+25%）。

在这方面，AMD 在考虑到 Intel 将 ROB 从 Skylake 的 224 增加到 Sunny Cove 的 352，以及 Golden Cove 的 512 的情况下，仍然相对保守地增加了这一方面。

使用 Zen 5，AMD 将扩展前端，并可能更积极地增加 ROB，尽管公司很可能会力求保持一个平衡点，保持每平方毫米性能高，就像之前的几代一样。

嗯，相对于 Intel，可以说这一切都是相对的。

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

*订阅免费获取新内容推送的通讯。

如果您希望在财务上支持这项工作，可以选择付费通讯选项，或者访问我的 Patreon 页面，并选择适合您预算的层次 - [https://www.patreon.com/locuza](https://www.patreon.com/locuza)*
