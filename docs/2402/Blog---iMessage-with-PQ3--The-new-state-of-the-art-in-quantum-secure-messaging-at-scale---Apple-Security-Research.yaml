- en: <!--yml
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: 未分类'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 类别：未分类
- en: 'date: 2024-05-27 15:03:29'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 日期：2024年05月27日15:03:29
- en: -->
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: 'Blog - iMessage with PQ3: The new state of the art in quantum-secure messaging
    at scale - Apple Security Research'
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 博客 - 带有PQ3的iMessage：量子安全消息传递规模的最新技术 - 苹果安全研究
- en: 来源：[https://security.apple.com/blog/imessage-pq3/](https://security.apple.com/blog/imessage-pq3/)
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 来源：[https://security.apple.com/blog/imessage-pq3/](https://security.apple.com/blog/imessage-pq3/)
- en: Today we are announcing the most significant cryptographic security upgrade
    in iMessage history with the introduction of PQ3, a groundbreaking post-quantum
    cryptographic protocol that advances the state of the art of end-to-end secure
    messaging. With compromise-resilient encryption and extensive defenses against
    even highly sophisticated quantum attacks, PQ3 is the first messaging protocol
    to reach what we call Level 3 security — providing protocol protections that surpass
    those in all other widely deployed messaging apps. To our knowledge, PQ3 has the
    strongest security properties of any at-scale messaging protocol in the world.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，我们宣布了iMessage历史上最重大的加密安全升级，引入了PQ3，这是一种开创性的后量子密码协议，推进了端到端安全消息传递的技术水平。凭借抗攻击能力强的加密和对即使是高度复杂的量子攻击的广泛防御，PQ3是第一个达到我们所称的第3级安全性的消息协议——提供了比所有其他广泛部署的消息应用程序中更强的协议保护。据我们所知，PQ3具有全球范围内规模化消息协议中最强的安全属性。
- en: 'When iMessage launched in 2011, it was the first widely available messaging
    app to provide end-to-end encryption by default, and we have significantly upgraded
    its cryptography over the years. We most recently strengthened the iMessage cryptographic
    protocol in 2019 by switching from RSA to Elliptic Curve cryptography (ECC), and
    by protecting encryption keys on device with the Secure Enclave, making them significantly
    harder to extract from a device even for the most sophisticated adversaries. That
    protocol update went even further with an additional layer of defense: a periodic
    rekey mechanism to provide cryptographic self-healing even in the extremely unlikely
    case that a key ever became compromised. Each of these advances were formally
    verified by symbolic evaluation, a best practice that provides strong assurances
    of the security of cryptographic protocols.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 2011年iMessage推出时，它是第一个默认提供端到端加密的广泛使用的消息应用程序，多年来我们对其加密技术进行了显着升级。我们最近在2019年通过从RSA转换为椭圆曲线加密（ECC）并通过在设备上使用安全区域（Secure
    Enclave）保护加密密钥来加强了iMessage加密协议，使它们变得极其难以被提取，即使对于最复杂的对手也是如此。该协议更新进一步增加了一层防御：定期重新密钥机制，即使在极不可能的情况下密钥被破坏，也能提供加密的自我修复。这些进步都经过符号评估的正式验证，这是一种提供加密协议安全性强有力保证的最佳实践。
- en: Historically, messaging platforms have used classical public key cryptography,
    such as RSA, Elliptic Curve signatures, and Diffie-Hellman key exchange, to establish
    secure end-to-end encrypted connections between devices. All these algorithms
    are based on difficult mathematical problems that have long been considered too
    computationally intensive for computers to solve, even when accounting for Moore’s
    law. However, the rise of quantum computing threatens to change the equation.
    A sufficiently powerful quantum computer could solve these classical mathematical
    problems in fundamentally different ways, and therefore — in theory — do so fast
    enough to threaten the security of end-to-end encrypted communications.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 从历史上看，消息平台一直使用经典公钥密码学，如RSA、椭圆曲线签名和Diffie-Hellman密钥交换，来建立设备之间的安全端到端加密连接。所有这些算法都基于长期被认为对计算机来说计算密集度太高而无法解决的困难数学问题，即使考虑到摩尔定律。然而，量子计算的兴起威胁着改变这个方程式。一个足够强大的量子计算机可以以根本不同的方式解决这些经典数学问题，因此——理论上——甚至可以快速地威胁到端到端加密通信的安全性。
- en: 'Although quantum computers with this capability don’t exist yet, extremely
    well-resourced attackers can already prepare for their possible arrival by taking
    advantage of the steep decrease in modern data storage costs. The premise is simple:
    such attackers can collect large amounts of today’s encrypted data and file it
    all away for future reference. Even though they can’t decrypt any of this data
    today, they can retain it until they acquire a quantum computer that can decrypt
    it in the future, an attack scenario known as *Harvest Now, Decrypt Later*.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管目前还不存在具有这种能力的量子计算机，但是极其具有资源的攻击者已经可以利用现代数据存储成本的大幅下降来为其可能的到来做好准备。其前提很简单：这样的攻击者可以收集大量今天的加密数据，并将其全部存档以备将来参考。尽管他们今天无法解密任何这些数据，但他们可以保留它，直到他们获得可以在未来解密它的量子计算机，这种攻击场景被称为*现在收集，以后解密*。
- en: 'To mitigate risks from future quantum computers, the cryptographic community
    has been working on post-quantum cryptography (PQC): new public key algorithms
    that provide the building blocks for quantum-secure protocols but don’t require
    a quantum computer to run — that is, protocols that can run on the classical,
    non-quantum computers we’re all using today, but that will remain secure from
    known threats posed by future quantum computers.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 为了减轻未来量子计算机带来的风险，密码学界一直在研究后量子密码学（PQC）：提供量子安全协议的新公钥算法，但不需要量子计算机运行——也就是说，可以在我们今天都在使用的经典非量子计算机上运行的协议，但将保持免受未来量子计算机带来的已知威胁的安全性。
- en: 'To reason through how various messaging applications mitigate attacks, it’s
    helpful to place them along a spectrum of security properties. There’s no standard
    comparison to employ for this purpose, so we lay out our own simple, coarse-grained
    progression of messaging security levels in the image at the top of this post:
    we start on the left with classical cryptography and progress towards quantum
    security, which addresses current and future threats from quantum computers. Most
    existing messaging apps fall either into Level 0 — no end-to-end encryption by
    default and no quantum security — or Level 1 — with end-to-end encryption by default,
    but with no quantum security. A few months ago, Signal added support for the PQXDH
    protocol, becoming the [first large-scale messaging app to introduce post-quantum
    security](https://signal.org/blog/pqxdh/) in the initial key establishment. This
    is a welcome and critical step that, by our scale, elevated Signal from Level
    1 to Level 2 security.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解各种消息应用程序如何减轻攻击，将它们放置在安全性属性的光谱上是有帮助的。对于这个目的，没有标准的比较，因此我们在本文顶部的图像中提出了自己的简单、粗粒度的消息安全级别的进展：我们从左边开始使用经典密码学，并向量子安全性发展，从而解决当前和未来量子计算机的威胁。大多数现有的消息应用程序要么属于第0级
    —— 默认情况下没有端到端加密，也没有量子安全性 —— 要么属于第1级 —— 默认情况下具有端到端加密，但没有量子安全性。几个月前，Signal添加了对PQXDH协议的支持，成为[首个引入后量子安全性的大型消息应用程序](https://signal.org/blog/pqxdh/)，在初始密钥建立时。这是一个受欢迎和关键的步骤，根据我们的标准，将Signal从第1级提升到第2级安全性。
- en: At Level 2, the application of post-quantum cryptography is limited to the initial
    key establishment, providing quantum security only if the conversation key material
    is never compromised. But today’s sophisticated adversaries already have incentives
    to compromise encryption keys, because doing so gives them the ability to decrypt
    messages protected by those keys for as long as the keys don’t change. To best
    protect end-to-end encrypted messaging, the post-quantum keys need to change on
    an ongoing basis to place an upper bound on how much of a conversation can be
    exposed by any single, point-in-time key compromise — both now and with future
    quantum computers. Therefore, we believe messaging protocols should go even further
    and attain Level 3 security, where post-quantum cryptography is used to secure
    both the initial key establishment and the ongoing message exchange, with the
    ability to rapidly and automatically restore the cryptographic security of a conversation
    even if a given key becomes compromised.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二级别，后量子密码学的应用仅限于初始密钥建立，仅在对话密钥材料从未被破坏的情况下提供量子安全性。但是今天的复杂对手已经有了动机来破解加密密钥，因为这样做可以让他们能够解密由这些密钥保护的消息，只要这些密钥不改变。为了最好地保护端到端加密的消息传递，后量子密钥需要持续变化，以限制任何单个时间点密钥损害可能暴露的对话数量的上限
    —— 现在和未来量子计算机都是如此。因此，我们认为消息协议应该进一步并获得第3级安全性，其中后量子密码学用于保护初始密钥建立和持续消息交换，即使给定密钥被破坏，也能快速自动地恢复对话的加密安全性。
- en: iMessage now meets this goal with a new cryptographic protocol that we call
    PQ3, offering the strongest protection against quantum attacks and becoming the
    only widely available messaging service to reach Level 3 security. Support for
    PQ3 will start to roll out with the public releases of iOS 17.4, iPadOS 17.4,
    macOS 14.4, and watchOS 10.4, and is already in the corresponding developer preview
    and beta releases. iMessage conversations between devices that support PQ3 are
    automatically ramping up to the post-quantum encryption protocol. As we gain operational
    experience with PQ3 at the massive global scale of iMessage, it will fully replace
    the existing protocol within all supported conversations this year.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: iMessage现在通过一种我们称之为PQ3的新的加密协议实现了这个目标，为量子攻击提供了最强的保护，并成为唯一一个达到第3级安全性的广泛可用的消息服务。PQ3的支持将从iOS
    17.4、iPadOS 17.4、macOS 14.4和watchOS 10.4的公开版本开始推出，并已经在相应的开发者预览和测试版本中推出。支持PQ3的设备之间的iMessage对话将自动升级到后量子加密协议。随着我们在iMessage的全球规模上获得PQ3的运营经验，它将在今年内完全取代所有支持的对话中的现有协议。
- en: Designing PQ3
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设计PQ3
- en: 'More than simply replacing an existing algorithm with a new one, we rebuilt
    the iMessage cryptographic protocol from the ground up to advance the state of
    the art in end-to-end encryption, and to deliver on the following requirements:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不仅仅是用新算法替换现有算法，还从头开始重建了iMessage的加密协议，以推进端到端加密的技术水平，并实现以下要求：
- en: Introduce post-quantum cryptography from the start of a conversation, so that
    all communication is protected from current and future adversaries.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从对话开始引入后量子密码学，以使所有通信都受到当前和未来对手的保护。
- en: Mitigate the impact of key compromises by limiting how many past and future
    messages can be decrypted with a single compromised key.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过限制使用单个受损密钥解密的过去和未来消息的数量，减轻密钥损害的影响。
- en: Use a hybrid design to combine new post-quantum algorithms with current Elliptic
    Curve algorithms, ensuring that PQ3 can can never be less safe than the existing
    classical protocol.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用混合设计将新的后量子算法与当前的椭圆曲线算法结合起来，确保PQ3永远不会比现有的经典协议更不安全。
- en: Amortize message size to avoid excessive additional overhead from the added
    security.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将消息大小摊销以避免由于增加的安全性而产生过多的额外开销。
- en: Use formal verification methods to provide strong security assurances for the
    new protocol.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用形式化验证方法为新协议提供强大的安全保证。
- en: PQ3 introduces a new post-quantum encryption key in the set of public keys each
    device generates locally and transmits to Apple servers as part of iMessage registration.
    For this application, we chose to use Kyber post-quantum public keys, an algorithm
    that received close scrutiny from the global cryptography community, and was selected
    by NIST as the Module Lattice-based Key Encapsulation Mechanism standard, or [ML-KEM](https://csrc.nist.gov/pubs/fips/203/ipd).
    This enables sender devices to obtain a receiver’s public keys and generate post-quantum
    encryption keys for the very first message, even if the receiver is offline. We
    refer to this as initial key establishment.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: PQ3在每个设备生成并作为iMessage注册的一部分传输到Apple服务器的公钥集中引入了新的后量子加密密钥。对于这个应用程序，我们选择使用Kyber后量子公钥，这是一种接受了全球密码学界密切关注的算法，并被NIST选为模块基于格的密钥封装机制标准，或称为[ML-KEM](https://csrc.nist.gov/pubs/fips/203/ipd)。这使得发送设备能够获取接收者的公钥，并为第一条消息生成后量子加密密钥，即使接收者处于离线状态也可以。我们将此称为初始密钥建立。
- en: We then include — within conversations — a periodic post-quantum rekeying mechanism
    that has the ability to self-heal from key compromise and protect future messages.
    In PQ3, the new keys sent along with the conversation are used to create fresh
    message encryption keys that can’t be computed from past ones, thereby bringing
    the conversation back to a secure state even if previous keys were extracted or
    compromised by an adversary. PQ3 is the first large scale cryptographic messaging
    protocol to introduce this novel post-quantum rekeying property.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在对话中引入了一种周期性的后量子重置机制，它具有自我修复的能力，可以从密钥泄露中保护并保护未来的消息。在PQ3中，随对话发送的新密钥用于创建无法从过去计算出的新消息加密密钥，从而使对话即使先前的密钥被敌对方提取或破坏也能回到安全状态。PQ3是第一个引入这种新型后量子重置属性的大规模加密消息协议。
- en: PQ3 employs a hybrid design that combines Elliptic Curve cryptography with post-quantum
    encryption both during the initial key establishment and during rekeying. Thus,
    the new cryptography is purely additive, and defeating PQ3 security requires defeating
    both the existing, classical ECC cryptography and the new post-quantum primitives.
    It also means the protocol benefits from all the experience we accumulated from
    deploying the ECC protocol and its implementations.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: PQ3采用了混合设计，在初始密钥建立和重新生成期间同时结合了椭圆曲线加密和后量子加密。因此，新的密码学是纯粹附加的，击败PQ3安全性需要同时击败现有的经典ECC密码学和新的后量子基元。这也意味着该协议从我们部署ECC协议和其实现中积累的所有经验中受益。
- en: Rekeying in PQ3 involves transmitting fresh public key material in-band with
    the encrypted messages that devices are exchanging. A new public key based on
    Elliptic Curve Diffie-Hellman (ECDH) is transmitted inline with every response.
    The post-quantum key used by PQ3 has a significantly larger wire size than the
    existing protocol, so to meet our message size requirement we designed the quantum-secure
    rekeying to happen periodically rather than with every message. To determine whether
    a new post-quantum key is transmitted, PQ3 uses a rekeying condition that aims
    to balance the average size of messages on the wire, preserve the user experience
    in limited connectivity scenarios, and keep the global volume of messages within
    the capacity of our server infrastructure. Should the need arise, future software
    updates can increase the rekeying frequency in a way that’s backward-compatible
    with all devices that support PQ3.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: PQ3中的重置涉及在设备交换的加密消息中与之同步传输新的公钥材料。基于椭圆曲线Diffie-Hellman（ECDH）的新公钥与每个响应一起内联传输。PQ3使用一个重新生成条件来确定是否传输新的后量子密钥，该条件旨在平衡导线上的消息的平均大小，保留在有限连接情况下的用户体验，并使全球消息量保持在我们服务器基础设施的容量范围内。如果有必要，未来的软件更新可以以向后兼容所有支持PQ3的设备的方式增加重新生成频率。
- en: With PQ3, iMessage continues to rely on classical cryptographic algorithms to
    authenticate the sender and verify the Contact Key Verification account key, because
    these mechanisms can’t be attacked retroactively with future quantum computers.
    To attempt to insert themselves in the middle of an iMessage conversation, an
    adversary would require a quantum computer capable of breaking one of the authentication
    keys before or at the time the communication takes place. In other words, these
    attacks cannot be performed in a *Harvest Now, Decrypt Later* scenario — they
    require the existence of a quantum computer capable of performing the attacks
    contemporaneously with the communication being attacked. We believe any such capability
    is still many years away, but as the threat of quantum computers evolves, we will
    continue to assess the need for post-quantum authentication to thwart such attacks.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 使用PQ3，iMessage继续依赖于经典密码算法来验证发送者和验证联系密钥验证帐户密钥，因为这些机制不能被未来的量子计算机攻击。要尝试插入到iMessage对话中，对手需要一台能够在通信发生之前或同时破解其中一个认证密钥的量子计算机。换句话说，这些攻击无法在*立即收集，以后解密*的情况下执行——它们需要存在一个能够与被攻击的通信同时执行攻击的量子计算机。我们相信任何这样的能力仍然需要多年时间，但随着量子计算机威胁的演变，我们将继续评估需要后量子认证来阻止这种攻击的必要性。
- en: A formally proven protocol
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 一个正式证明的协议
- en: Our final requirement for iMessage PQ3 is formal verification — a mathematical
    proof of the intended security properties of the protocol. PQ3 received extensive
    review from Apple’s own multi-disciplinary teams in Security Engineering and Architecture
    (SEAR) as well as from some of the world’s foremost experts in cryptography. This
    includes a team led by Professor David Basin, head of the [Information Security
    Group at ETH Zürich](https://infsec.ethz.ch/) and one of the inventors of [Tamarin](https://tamarin-prover.com/)
    — a leading security protocol verification tool that was also used to evaluate
    PQ3 — as well as Professor Douglas Stebila from the University of Waterloo, who
    has performed extensive research on post-quantum security for internet protocols.
    Each took a different but complementary approach, using different mathematical
    models to demonstrate that as long as the underlying cryptographic algorithms
    remain secure, so does PQ3\. Finally, a leading third-party security consultancy
    supplemented our internal implementation review with an independent assessment
    of the PQ3 source code, which found no security issues.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们对 iMessage PQ3 的最终要求是形式验证 —— 对协议预期的安全属性进行数学证明。PQ3 在苹果公司的安全工程和架构（SEAR）的多学科团队以及密码学界一些世界领先的专家的全面审查下进行了广泛审查。这包括由
    ETH Zürich 信息安全组的组长 David Basin 教授领导的团队，他是[Tamarin](https://tamarin-prover.com/)的发明者之一
    —— 这是一种领先的安全协议验证工具，也被用来评估 PQ3 —— 以及滑铁卢大学的 Douglas Stebila 教授，他在互联网协议的后量子安全性上进行了广泛的研究。每个人采用了不同但互补的方法，使用不同的数学模型来证明只要基础密码算法保持安全，PQ3
    也是安全的。最后，一家领先的第三方安全咨询公司对我们内部实现的审查进行了补充，独立评估了 PQ3 源代码，没有发现安全问题。
- en: In the first mathematical analysis, [Security analysis of the iMessage PQ3 protocol](/assets/files/Security_analysis_of_the_iMessage_PQ3_protocol_Stebila.pdf),
    Professor Douglas Stebila focused on so-called game-based proofs. This technique,
    also known as reduction, defines a series of “games“ or logical statements to
    show that the protocol is at least as strong as the algorithms that underpin it.
    Stebila’s analysis shows that PQ3 provides confidentiality even in the presence
    of some key compromises against both classical and quantum adversaries, in both
    the initial key establishment and the ongoing rekeying phase of the protocol.
    The analysis decomposes the many layers of key derivations down to the message
    keys and proves that, for an attacker, they are indistinguishable from random
    noise. Through an extensive demonstration that considers different attack paths
    for classical and quantum attackers in the proofs, Stebila shows that the keys
    used for PQ3 are secure as long as either the Elliptic Curve Diffie-Hellman problem
    remains hard or the Kyber post-quantum KEM remains secure.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一次数学分析中，[iMessage PQ3 协议的安全性分析](/assets/files/Security_analysis_of_the_iMessage_PQ3_protocol_Stebila.pdf)，Douglas
    Stebila 教授集中于所谓的基于游戏的证明。这种技术，也称为还原，定义了一系列“游戏”或逻辑陈述，以显示协议至少与支撑它的算法一样强大。Stebila
    的分析表明，PQ3 即使在一些密钥受损的情况下，对抗经典和量子对手，在协议的初始密钥建立和持续重新密钥阶段都提供了机密性。该分析将密钥衍生的许多层次分解为消息密钥，并证明了对于攻击者来说，它们与随机噪声是不可区分的。通过对证明中经典和量子攻击者的不同攻击路径进行广泛演示，Stebila
    表明只要椭圆曲线 Diffie-Hellman 问题仍然困难，或者 Kyber 后量子 KEM 仍然安全，PQ3 使用的密钥就是安全的。
- en: '*The iMessage PQ3 protocol is a well-designed cryptographic protocol for secure
    messaging that uses state-of-the-art techniques for end-to-end encrypted communication.
    In my analysis using the reductionist security methodology, I confirmed that the
    PQ3 protocol provides post-quantum confidentiality, which can give users confidence
    in the privacy of their communication even in the face of potential improvements
    in quantum computing technology. —Professor Douglas Stebila*'
  id: totrans-29
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*iMessage PQ3 协议是一种设计良好的加密协议，用于安全消息传递，采用了最先进的技术进行端到端加密通信。在我使用还原主义安全方法论进行分析时，我确认了
    PQ3 协议提供了后量子保密性，这可以让用户在量子计算技术有潜在改进的情况下对其通信隐私感到放心。—道格拉斯·斯特比拉教授*'
- en: In the second evaluation, [A Formal Analysis of the iMessage PQ3 Messaging Protocol](/assets/files/A_Formal_Analysis_of_the_iMessage_PQ3_Messaging_Protocol_Basin_et_al.pdf),
    Prof. David Basin, Felix Linker, and Dr. Ralf Sasse at ETH Zürich use a method
    called symbolic evaluation. As highlighted in the paper’s abstract, this analysis
    includes a detailed formal model of the iMessage PQ3 protocol, a precise specification
    of its fine-grained security properties, and machine-checked proofs using the
    state-of-the-art symbolic [Tamarin prover](https://tamarin-prover.com/). The evaluation
    yielded a fine-grained analysis of the secrecy properties of PQ3, proving that
    “in the absence of the sender or recipient being compromised, all keys and messages
    transmitted are secret” and that “compromises can be tolerated in a well-defined
    sense where the effect of the compromise on the secrecy of data is limited in
    time and effect,” which confirms that PQ3 meets our goals.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二次评估中，[iMessage PQ3 消息协议的形式化分析](/assets/files/A_Formal_Analysis_of_the_iMessage_PQ3_Messaging_Protocol_Basin_et_al.pdf)，ETH
    Zürich 的 David Basin 教授、Felix Linker 和 Ralf Sasse 博士使用了一种称为符号评估的方法。正如论文摘要中所强调的那样，这个分析包括对
    iMessage PQ3 协议的详细形式化模型、其细粒度安全属性的精确规范以及使用最先进的符号[Tamarin证明器](https://tamarin-prover.com/)进行机器验证的证明。评估结果得到了对
    PQ3 保密性属性的细粒度分析，证明“在发送方或接收方没有受到损害的情况下，所有传输的密钥和消息都是机密的”，并且“在有限的时间和效果范围内可以容忍受损，损害对数据机密性的影响是有限的”，这证实了
    PQ3 达到了我们的目标。
- en: '*We provide a mathematical model of PQ3 as well as prove its secrecy and authenticity
    properties using a verification tool for machine-checked security proofs. We prove
    the properties even when the protocol operates in the presence of very strong
    adversaries who can corrupt parties or possess quantum computers and therefore
    defeat classical cryptography. PQ3 goes beyond Signal with regards to post-quantum
    defenses. In PQ3, a post-quantum secure algorithm is part of the ratcheting and
    used repeatedly, rather than only once in the initialization as in Signal. Our
    verification provides a very high degree of assurance that the protocol as designed
    functions securely, even in the post-quantum world. —Professor David Basin*'
  id: totrans-31
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*我们提供了 PQ3 的数学模型，并使用验证工具对其机器检查安全证明的保密性和真实性进行了证明。我们证明了这些属性，即使在协议在非常强大的对手面前运行时，这些对手可以腐败参与者或拥有量子计算机，并因此击败经典密码学。与
    Signal 相比，PQ3 超越了后量子防御。在 PQ3 中，后量子安全算法是打点的一部分，并且会被重复使用，而不像 Signal 中的初始化那样只使用一次。我们的验证提供了极高的保证度，即所设计的协议在后量子世界中也能安全运行。
    —David Basin 教授*'
- en: Diving into the details
  id: totrans-32
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 深入细节
- en: Because we know PQ3 will be of intense interest to security researchers and
    engineers as well as the cryptographic community, this blog post is really two
    posts in one. Up to now, we laid out our design goals, outlined how PQ3 meets
    them, and explained how we verified our confidence in the protocol with independent
    assessments. If you’d like to understand more detail about the cryptographic underpinnings,
    the remainder of the post is a deeper dive into how we constructed the PQ3 protocol.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们知道 PQ3 将引起安全研究人员和工程师以及密码学社区的极大兴趣，因此这篇博客实际上是两篇博客合为一篇。到目前为止，我们阐明了我们的设计目标，概述了
    PQ3 如何满足这些目标，并解释了我们如何通过独立评估验证了对协议的信心。如果您想了解有关加密基础的更多详细信息，则本文剩余部分将深入探讨我们如何构建 PQ3
    协议。
- en: Post-quantum key establishment
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 后量子密钥建立
- en: 'iMessage allows a user to register multiple devices on the same account. Each
    device generates its own set of encryption keys, and the private keys are never
    exported to any external system. The associated public keys are registered with
    Apple’s Identity Directory Service (IDS) to enable users to message each other
    using a simple identifier: email address or phone number. When a user sends a
    message from one of their devices, all of their other devices and all of the recipient’s
    devices receive the message. The messages are exchanged through pair-wise sessions
    established between the sending device and each receiving device. The same message
    is encrypted successively to each receiving device, with keys uniquely derived
    for each session. For the rest of this description, we will focus on a single
    device-to-device session.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: iMessage 允许用户在同一账户上注册多个设备。每个设备生成自己的一组加密密钥，并且私钥不会导出到任何外部系统。相关的公共密钥注册在 Apple 的身份目录服务（IDS）中，以便用户可以使用简单的标识符（电子邮件地址或电话号码）相互发送消息。当用户从其中一个设备发送消息时，他们的所有其他设备和接收者的所有设备都会接收到消息。消息通过建立在发送设备和每个接收设备之间的一对一会话进行交换。相同的消息连续地使用为每个会话唯一派生的密钥加密到每个接收设备。在本描述的其余部分中，我们将重点放在单个设备对设备会话上。
- en: Because the receiving device might not be online when the conversation is established,
    the first message in a session is encrypted using the public encryption keys registered
    with the IDS server.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 因为接收设备在建立会话时可能不在线，所以会话中的第一条消息使用注册在 IDS 服务器上的公共加密密钥加密。
- en: 'Each device with PQ3 registers two public encryption keys and replaces them
    regularly with fresh ones:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 每个具有 PQ3 的设备注册两个公共加密密钥，并定期替换为新的密钥：
- en: A post-quantum Kyber-1024 key encapsulation public key
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个后量子 Kyber-1024 密钥封装公钥
- en: A classical P-256 Elliptic Curve key agreement public key
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一个经典的 P-256 椭圆曲线密钥协定公钥
- en: These encryption keys are signed with ECDSA using a P-256 authentication key
    generated by the device’s Secure Enclave, along with a timestamp used to limit
    their validity. The device authentication public key is itself signed by the [Contact
    Key Verification](https://security.apple.com/blog/imessage-contact-key-verification/)
    account key, along with some attributes such as the supported cryptographic protocol
    version. This process allows the sender to verify that the recipient device’s
    public encryption keys were uploaded by the intended recipient, and it guards
    against downgrade attacks.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 这些加密密钥使用设备的安全隔离生成的 P-256 认证密钥进行 ECDSA 签名，并使用时间戳限制其有效性。设备认证公钥本身由 [接触密钥验证](https://security.apple.com/blog/imessage-contact-key-verification/)
    账户密钥签名，以及一些属性，如支持的加密协议版本。该过程允许发送方验证接收方设备的公共加密密钥是由预期接收方上传的，并且防范了降级攻击。
- en: When Alice’s device instantiates a new session with Bob’s device, her device
    queries the IDS server for the key bundle associated with Bob’s device. The subset
    of the key bundle that contains the device’s authentication key and versioning
    information is validated using Contact Key Verification. The device then validates
    the signature covering the encryption keys and timestamps, which attests that
    the keys are valid and have not expired.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 当 Alice 的设备与 Bob 的设备实例化新会话时，她的设备会查询 IDS 服务器以获取与 Bob 的设备关联的密钥包。该密钥包子集包含了设备的认证密钥和版本信息，经过接触密钥验证后进行验证。然后，设备验证覆盖加密密钥和时间戳的签名，该签名证明了密钥的有效性和未过期性。
- en: Alice’s device can then use the two public encryption keys to share two symmetric
    keys with Bob. The first symmetric key is computed through an ECDH key exchange
    that combines an ephemeral encryption key from Alice with Bob’s registered P-256
    public key. The second symmetric key is obtained from a Kyber key encapsulation
    with Bob’s post-quantum public key.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: Alice 的设备可以使用两个公共加密密钥与 Bob 共享两个对称密钥。第一个对称密钥是通过 ECDH 密钥交换计算得出的，该计算将 Alice 的临时加密密钥与
    Bob 的注册 P-256 公钥相结合。第二个对称密钥是通过使用 Bob 的后量子公钥进行 Kyber 密钥封装而获得的。
- en: To combine these two symmetric keys, we first extract their entropy by invoking
    HKDF-SHA384-Extract twice — once for each of the keys. The resulting 48-byte secret
    is further combined with a domain separation string and session information —
    which includes the user’s identifiers, the public keys used in the key exchange,
    and the encapsulated secret — by invoking HKDF-SHA384-Extract again to derive
    the session’s initial keying state. This combination ensures that the initial
    session state cannot be derived without knowing both of the shared secrets, meaning
    an attacker would need to break both algorithms to recover the resulting secret,
    thus satisfying our hybrid security requirement.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要合并这两个对称密钥，我们首先通过两次调用HKDF-SHA384-Extract来提取它们的熵 — 每个密钥一次。然后，通过再次调用HKDF-SHA384-Extract来从域分离字符串和会话信息（包括用户标识符、密钥交换中使用的公钥和封装的密钥）导出会话的初始密钥状态，进一步将得到的
    48 字节秘密与域分离字符串和会话信息结合起来。这种组合确保初始会话状态不能在不知道共享秘密的情况下派生，这意味着攻击者需要破解两种算法才能恢复结果密钥，从而满足我们的混合安全要求。
- en: Post-quantum rekeying
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 后量子重新键入
- en: Ongoing rekeying of the cryptographic session is designed such that keys used
    to encrypt past and future messages cannot be recomputed even by a powerful hypothetical
    attacker who is able to extract the cryptographic state of the device at a given
    point in time. The protocol generates a new unique key for each message, which
    periodically includes new entropy that is not deterministically derived from the
    current state of the conversation, effectively providing self-healing properties
    to the protocol. Our rekeying approach is modeled after ratcheting, a technique
    that consists of deriving a new session key from other keys and ensuring the cryptographic
    state always moves forward in one direction. PQ3 combines three ratchets to achieve
    post-quantum encryption.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 加密会话的持续重新键入设计为即使是能够在给定时间点提取设备的加密状态的强大假设的攻击者也无法重新计算用于加密过去和未来消息的密钥。该协议为每条消息生成一个新的唯一密钥，其中周期性地包含不是从对话当前状态确定性派生的新熵，从而有效地为协议提供了自我修复属性。我们的重新键入方法是模仿锁链的，这是一种从其他密钥派生新会话密钥并确保加密状态始终向前移动的技术。PQ3结合了三个锁链来实现后量子加密。
- en: The first ratchet, called the symmetric ratchet, protects older messages in
    a conversation to achieve forward secrecy. For every message, we derive a per-message
    encryption key from the current session key. The current session key itself is
    then further derived into a new session key, ratcheting the state forward. Each
    message key is deleted as soon as a corresponding message is decrypted, which
    prevents older harvested ciphertexts from being decrypted by an adversary who
    is able to compromise the device at a later time, and provides protection against
    replayed messages. This process uses 256-bit keys and intermediate values, and
    HKDF-SHA384 as a derivation function, which provides protection against both classical
    and quantum computers.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个锁链称为对称锁链，用于保护对话中的旧消息以实现前向保密性。对于每条消息，我们从当前会话密钥派生一个每条消息的加密密钥。然后，当前会话密钥本身进一步派生为一个新的会话密钥，将状态向前推进。每个消息密钥在相应的消息解密后立即删除，这可以防止能够在以后时间点损坏设备的对手解密旧的被收集的密文，并提供对重放消息的保护。该过程使用
    256 位密钥和中间值，以及HKDF-SHA384作为派生函数，这提供了对经典计算机和量子计算机的保护。
- en: 'The second ratchet, called the ECDH ratchet, protects future messages by updating
    the session with fresh entropy from an Elliptic Curve key agreement, ensuring
    that an adversary loses the ability to decrypt new messages even if they had compromised
    past session keys — a property called post-compromise security. The ECDH-based
    ratchet has a symmetrical flow: the private key of the outgoing ratchet public
    key from the sender is used with the last public key received from the recipient
    to establish a new shared secret between sender and receiver, which is then mixed
    into the session’s key material. The new PQ3 protocol for iMessage uses NIST P-256
    Elliptic Curve keys to perform this ratchet, which imposes only a small 32-byte
    overhead on each message.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个锁链称为ECDH锁链，通过从椭圆曲线密钥协定中获取新的熵来保护未来的消息，确保即使攻击者已经损坏了过去的会话密钥，他们也无法解密新消息 —— 这被称为后妥协安全性。基于ECDH的锁链具有对称的流动性：发送方的出站锁链公钥的私钥与接收方收到的最后一个公钥一起用于建立发送方和接收方之间的新共享密钥，然后将其混合到会话的密钥材料中。新的iMessage的PQ3协议使用NIST
    P-256椭圆曲线密钥执行此锁链，每条消息只会带来32字节的小额开销。
- en: Because the second ratchet uses classical cryptography, PQ3 also adds a conditionally
    executed Kyber KEM-based ratchet. This third ratchet complements the ECDH-based
    ratchet to provide post-compromise security against *Harvest Now, Decrypt Later*
    quantum attacks as well.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 由于第二个锁链使用经典密码学，PQ3还添加了一个基于Kyber KEM的条件执行的锁链。这第三个锁链与基于ECDH的锁链相辅相成，以提供*先收集，后解密*量子攻击的后妥协安全性。
- en: The use of a post-quantum ratchet can cause significant network overhead compared
    to an ECDH-based ratchet at the same security level. The post-quantum KEM requires
    sending both a public key and an encapsulated secret instead of a single outgoing
    public key. In addition, the underlying mathematical structure for quantum security
    requires significantly larger parameter sizes for public keys and encapsulated
    keys compared to Elliptic Curves.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 使用后量子锁链与同一安全级别下基于ECDH的锁链相比，会导致显着的网络开销。后量子KEM需要发送公钥和封装的密钥，而不是单个出站公钥。此外，量子安全的基础数学结构需要比椭圆曲线更大得多的参数大小的公钥和封装密钥。
- en: To limit the size overhead incurred by frequent rekeying while preserving a
    high level of security, the post-quantum KEM is instantiated with Kyber-768\.
    Unlike the IDS-registered public keys used for the initial key establishment,
    ratcheting public keys are used only once to encapsulate a shared secret to the
    receiver, significantly limiting the impact of the compromise of a single key.
    However, while a 32-byte ECDH-based ratchet overhead is acceptable on every message,
    the post-quantum KEM ratchet increases the message size by more than 2 kilobytes.
    To avoid visible delays in message delivery when device connectivity is limited,
    this ratchet needs to be amortized over multiple messages.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 为了限制频繁重置密钥而导致的额外开销，同时保持高水平的安全性，后量子密钥交换（KEM）使用Kyber-768进行实例化。与用于初始密钥建立的IDS注册公钥不同，拉丁公钥仅用于将共享密钥封装到接收器中，显著限制了单个密钥泄露的影响。然而，虽然每条消息上的32字节基于ECDH的拉丁开销是可以接受的，后量子KEM拉丁会使消息大小增加超过2千字节。为了避免在设备连接受限时出现可见的消息传递延迟，此拉丁需要在多个消息中分摊。
- en: We therefore implemented an adaptive post-quantum rekeying criterion that takes
    into account the number of outgoing messages, the time elapsed since last rekeying,
    and current connectivity conditions. At launch, this means the post-quantum ratchet
    is performed approximately every 50 messages, but the criterion is bounded such
    that rekeying is always guaranteed to occur at least once every 7 days. And as
    we mentioned earlier, as the threat of quantum computers and infrastructure capacity
    evolves over time, future software updates can increase the rekeying frequency
    while preserving full backward compatibility.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们实现了一种自适应的后量子重置标准，该标准考虑了出站消息数量、自上次重置以来的时间以及当前的连接情况。在启动时，这意味着后量子拉丁大约每50条消息执行一次，但该标准被限制，以确保重置至少每7天发生一次。正如我们之前提到的，随着量子计算机和基础设施容量的威胁随着时间的推移而演变，未来的软件更新可以增加重置频率，同时保持完全向后兼容。
- en: Completing the public key ratchets, whether based on ECDH or Kyber, requires
    sending and receiving a message. Although users may not immediately reply to a
    message, iMessage includes encrypted delivery receipts that allow devices to rapidly
    complete the ratchet even without a reply from the recipient, as long as the device
    is online. This technique avoids delays in the rekeying process and helps support
    strong post-compromise recovery.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 完成基于ECDH或Kyber的公钥拉丁需要发送和接收消息。尽管用户可能不会立即回复消息，但iMessage包含加密的传递回执，允许设备即使在没有收件人回复的情况下快速完成拉丁，只要设备在线。这种技术避免了重新密钥过程中的延迟，并帮助支持强大的后泄密恢复。
- en: Similar to the initial session key establishment, the secrets established through
    the three ratchets are all combined with an evolving session key using HKDF-SHA384
    through sequential calls to the Extract function. At the end of this process,
    we obtain a final message key, which can now be used to encrypt the payload.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于初始会话密钥建立，通过三个拉丁建立的密钥都与使用HKDF-SHA384的不断发展的会话密钥结合在一起，通过对提取函数的顺序调用。在此过程结束时，我们获得了最终的消息密钥，现在可以用于加密有效载荷。
- en: Padding and encryption
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 填充和加密
- en: To avoid leaking information about the message size, PQ3 adds padding to the
    message before encryption. This padding is implemented with the [Padmé](https://arxiv.org/abs/1806.03160)
    heuristic, which specifically limits the information leakage of ciphertexts with
    maximum length M to a practical optimum of O(log log M) bits. This is comparable
    to padding to a power of two but results in a lower overhead of at most 12 percent
    and even lower for larger payloads. This approach strikes an excellent balance
    between privacy and efficiency, and preserves the user experience in limited device
    connectivity scenarios.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免泄露关于消息大小的信息，PQ3在加密前对消息进行填充。此填充采用[Padmé](https://arxiv.org/abs/1806.03160)启发式方法实现，该方法专门限制了最大长度为M的密文的信息泄露量至实用最优值O(log
    log M)位。这相当于填充到二的幂，但开销最多为12%，对于更大的有效载荷甚至更低。这种方法在隐私和效率之间取得了很好的平衡，并在设备连接受限的情况下保持了用户体验。
- en: The padded payload is encrypted with AES-CTR using a 256-bit encryption key
    and initialization vector, both derived from the message key. While public key
    algorithms require fundamental changes to achieve quantum security, symmetric
    cryptography algorithms like the AES block cipher only require doubling the key
    size to maintain their level of security against quantum computers.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 填充的有效载荷使用AES-CTR使用256位加密密钥和初始化向量进行加密，这两者都是从消息密钥派生的。虽然公钥算法需要基本更改才能实现量子安全性，但对称加密算法如AES分组密码只需要将密钥大小加倍以维持其对量子计算机的安全级别。
- en: Authentication
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 认证
- en: Each message is individually signed with ECDSA using the elliptic curve P-256
    device authentication key protected by the Secure Enclave. The receiving device
    verifies the mapping between the sender’s identifier (email address or phone number)
    and the public key used for signature verification. If both users have enabled
    Contact Key Verification and verified each other’s account key, the device verifies
    that the device authentication keys are present in the Key Transparency log and
    that the corresponding account key matches the account key stored in the user’s
    iCloud Keychain.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 每条消息都使用由安全保险柜保护的椭圆曲线P-256设备认证密钥进行ECDSA签名。接收设备验证了发送者标识符（电子邮件地址或电话号码）与用于签名验证的公钥之间的映射。如果两个用户都启用了联系人密钥验证并验证了对方的帐户密钥，则设备将验证设备认证密钥是否存在于密钥透明日志中，并且相应的帐户密钥是否与用户iCloud钥匙串中存储的帐户密钥匹配。
- en: The device’s authentication key is generated by the Secure Enclave and never
    exposed to the rest of the device, which helps prevent extraction of the private
    key even if the Application Processor is completely compromised. If an attacker
    were to compromise the Application Processor, they might be able to use the Secure
    Enclave to sign arbitrary messages. But after the device recovers from the compromise
    through a reboot or a software update, they would no longer be able to impersonate
    the user. This approach offers stronger guarantees than other messaging protocols
    where the authentication key is sometimes shared between devices or where the
    authentication takes place only at the beginning of the session.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 设备的认证密钥由安全区域生成，永远不会暴露给设备的其他部分，这有助于防止私钥被提取，即使应用处理器完全被破坏。如果攻击者成功破坏了应用处理器，他们可能能够使用安全区域对任意消息进行签名。但是，一旦设备通过重新启动或软件更新从妥协状态中恢复过来，他们将不再能够冒充用户。这种方法比其他消息传输协议提供了更强的保证，其中认证密钥有时在设备之间共享，或者认证仅在会话开始时进行。
- en: The message signature covers a wide range of fields, including the unique identifiers
    of the users and their push notification tokens, the encrypted payload, authenticated
    data, a ratchet-derived message key indicator that binds the signature to a unique
    location in the ratchet, and any public key information used in the protocol.
    The inclusion of these fields in the signature guarantees that the message can
    only be used in the context intended by the sender, and all the fields are exhaustively
    documented in the research papers from Stebila, Basin, and collaborators.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 消息签名涵盖了广泛的字段，包括用户的唯一标识符和他们的推送通知令牌、加密载荷、经过认证的数据、由棘轮派生的消息密钥指示器，将签名绑定到棘轮中的唯一位置，以及协议中使用的任何公钥信息。在签名中包含这些字段可以保证消息只能在发送者预期的上下文中使用，并且所有字段都在来自
    Stebila、Basin 和合作者的研究论文中进行了详尽的文档记录。
- en: Conclusion
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 结论
- en: End-to-end encrypted messaging has seen a tremendous amount of innovation in
    recent years, including significant advances in post-quantum cryptography from
    Signal’s PQXDH protocol and in key transparency from WhatsApp’s Auditable Key
    Directory. Building on its pioneering legacy as the first widely available messaging
    app to provide end-to-end encryption by default, iMessage has continued to deliver
    advanced protections that surpass existing systems. iMessage [Contact Key Verification](https://security.apple.com/blog/imessage-contact-key-verification/)
    is the most sophisticated key transparency system for messaging deployed at scale,
    and is the current global state of the art for automatic key verification. And
    the new PQ3 cryptographic protocol for iMessage combines post-quantum initial
    key establishment with three ongoing ratchets for self-healing against key compromise,
    defining the global state of the art for protecting messages against *Harvest
    Now, Decrypt Later* attacks and future quantum computers.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，端到端加密的消息传输领域取得了巨大的创新，包括 Signal 的 PQXDH 协议中的量子后密码学的重大进展，以及 WhatsApp 的可审计密钥目录中的密钥透明性方面的重大进步。在其作为第一个默认提供端到端加密的广泛可用消息应用程序的开创性遗产的基础上，iMessage
    一直在提供超越现有系统的先进保护措施。iMessage [联系人密钥验证](https://security.apple.com/blog/imessage-contact-key-verification/)是规模部署的消息中最复杂的密钥透明系统，并且是当前全球自动密钥验证的技术水平。而
    iMessage 的新 PQ3 密码协议将量子后初始密钥建立与三个持续棘轮相结合，以对抗密钥妥协进行了自我修复，定义了保护消息免受*现在收割，以后解密*攻击和未来量子计算机的全球最新技术水平。
