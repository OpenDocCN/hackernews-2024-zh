<!--yml

category: 未分类

date: 2024-05-27 14:47:19

-->

# 一艘载着银器的船已经起航（Blog.Posted_2024_01_01）

> 来源：[https://dpldocs.info/this-week-in-d/Blog.Posted_2024_01_01.html](https://dpldocs.info/this-week-in-d/Blog.Posted_2024_01_01.html)
> 
> “我们到了需要一个制衡的时候，以保持一切顺利进行。我希望他们在有人决定是时候分叉之前听取我们的意见。”rikki cattermole, 2018 年 8 月 23 日，D 论坛

向 D 领导层贡献开发工作一直是一个非常令人沮丧的过程。尽管经常重复的说法 D 是一门闭源语言并不完全正确（编译器的 D 特定部分早在 2002 年就采用了 GPL 许可，导致在 2004 年发布了全部采用 GPL 许可的编译器（现在我们知道的是 gdc）），但确实 D 的开发方法并不特别开放，决策几乎没有来自社区的有意义的输入，而且整个历史上都是如此。

> “PR 永远都在消磨时间[...] Nim 对于贡献者来说容易得多。”Timothee Cour, 2018 年 3 月 26 日, [https://github.com/timotheecour/D_vs_nim](https://github.com/timotheecour/D_vs_nim)

不要误会：D 今天之所以是什么样子，完全归功于[社区的贡献](https://forum.dlang.org/post/lkdvndfifzmchdvqgjdn@forum.dlang.org)。我们认为构成 D 的关键特性和概念都来自社区的贡献。现有的 D 代码大部分是社区编写的。已经做了大量的工作。我自己也成功地完成了其中的大部分。事实上，就在上周，我一直在推动的一个问题终于合并了（虽然推迟了 4 个月，但总比没有好），我在整个年度还合并了几个小事情。

但仅仅看成功故事会让我们陷入幸存者偏差的陷阱。沃尔特曾经讲过这样一个故事（这是一个众所周知的故事，但他是我听到的第一个），关于二战飞机带着弹孔返回的情景。你可能首先看到这一点，并说：“这是飞机往往被击中的地方，我们来加装装甲”，但实际结果却是相反的。这些是成功返回的飞机，意味着其他地方被击中的飞机可能坠毁了。因此，需要关注的是没有弹孔的区域。

着眼于所有数据是很重要的。

> “D 开发的历史充满了这样的情况，花费了大量的时间来接受一些在那个时候被认为是标准做法的东西（比如版本控制、问题跟踪或发布维护），因为必须以一种令沃尔特信服的方式来"出售"它。”Dicebot, 2017 年 9 月 4 日，文章 "On Leaving D"
> 
> “我的立场是，只要现任领导层继续掌控并保持同样的态度，无论投入多少资金或开发者时间，都无法修复 D。”
> 
> Dicebot, 2018 年 8 月 23 日，D 论坛帖子评论他的 "On Leaving D" 文章

尽管 D 的历史上有许多补丁被接受，但也有许多补丁被搁置。我们现在所知的“druntime”代码最初起源于一次分叉，因为沃尔特未能接受社区的贡献。2004年，在尝试与上游合作之后，这些开发人员别无选择，只能分叉语言以保留他们的贡献——他们必须觉得这些贡献对于扩大 D 的使用是必要的，以免完全丧失。这个分叉起初被称为“Ares”，后来与其他社区努力合并成为“Tango”。

Tango 称自己为“D 的开发者图书馆”。当时我不明白为什么，我只知道要使用它，你必须从另一个网站安装一些东西，而我不想这样做。但现在，知道了关于 D 的种种，这个名字是显而易见的：Tango 是开发者实际上受欢迎的贡献地。而且他们的确做到了：Tango 生态系统有许多 Phobos 生态系统所缺乏的东西。

> “沃尔特赞同了许多想法。我想知道的是他多快将结果纳入。”jcc7，2004年9月10日，dsource.org 论坛

在坚持了四年的分叉并获得了显著的流行度，包括吸引了 D 的早期商业用户之后，上游最终屈服并开始进行和解，从而导致了我们今天所享受的“druntime”。

我相信，如果不是因为 Ares/Tango 的分叉，D 今天可能只是一个脚注；一些著名人物的实验，最终在市场上毫无进展。我们经常被告知这种情况几乎使 D 走向了死路，但事实可能恰恰相反：这个分叉在 D 的发展关键时刻 *拯救* 了它。

接下来的几年里，随着 Tango 的主要开发人员回到队伍中，与安德烈·亚历山德雷斯库等人一起，为 D 迎来了黄金时代。开发过程一度相对开放，并在2013年左右活跃起来，多个商业用户给予了机会（请注意，几乎所有 D 的商业用户都直接依赖于 Ares 分叉的代码，如果沃尔特没有被迫，这些代码可能会被丢弃）。

然而，这种状况不会持续下去。旧习惯不愿消失，而黄金时代的贡献者涌入后也不愿意留下来，许多人明确指出导致他们的工作不被重视的破碎过程，或者随着生活环境的变化逐渐消失，一次次地，几乎没有新人留下来接替他们的位置，直到最后剩下很少的人。

> “早在2009年春季，我对 D 社区的情况、其治理等感到厌倦，虽然我喜爱这种语言（即 D v1），但我对未来感到不确定。我和其他人私下交谈过，结果发现我远非孤独。克里斯处于类似的境地，但也受到了大量工作的压力。”larsivi，2012年12月17日，Tango 论坛

Phobos 的[开发活动](https://github.com/dlang/phobos/graphs/contributors)在2018年中期显著减少，此后仅有两次小幅增长：berni44 提供的支持 CTFE 的浮点格式化以及 Paul Backus 的 `sumtype` 模块被接受为 `std.sumtype`。

> 上周，当我发布关于 D 的新网站的公告时，没有人回复，我感到非常失望（现在有三条回复，一条消极，两条积极，但已经有点太迟了）。我现在也等待着将近三个月来审查我关于替换 sprintf 的 PRs（仅仅点赞是不够的）。这让我感到很难过。
> 
> 所以我决定远离一周来冷静下来，并有时间思考。最终我得出结论，我不适合在这个社区。所以我会离开。
> 
> berni44，2020年2月6日，D 论坛话题“等待了3个月…”

berni44 一年后回来并成功推动了 Phobos 开发的最新一波增长… 但这并没有持续下去。在那次回归高峰的几个月后，他再次离开。到今天为止，还有一些 berni44 的 PR 仍然处于开放状态，显然还在等待 D 领导的决定或其他行动。  

我怀疑 Phobos 活动在 Andrei Alexandrescu 公开宣布退出 D 之前不久停止并非巧合。有时与他合作确实令人沮丧，但他对库有自己的愿景，并愿意为之努力。但是当他下台时，再也没有人能够继续这项工作。

如果你看看黄金时代的 dmd 本身，Walter 本人只做了大约工作量的1/6。当时还有其他几个人显著参与其中。现在他只有大约1/3的工作量 - 不是说他提升了；Walter 的个人贡献大致保持稳定。相反，这个比例之所以改变是因为其他人退出了，其中许多人明确表示原因是 D 的治理模式有问题。

> “我的 PR 被忽视了好几个月甚至好几年，我无法继续在 D 上工作。”Jonathan Marler，2018年10月28日，Github PR 评论线程（关于字符串插值）

感到沮丧的不仅仅是开源贡献者。

> “当时争先恐后为 D 辩护的人现在都改变了看法。关于选择 D 是否是个好主意，仍然有一些争论，但是Weka内部的压倒性共识是 D 存在*致命*缺陷，而且没有修复的路径。”
> 
> “而我所说的‘致命’，我是指确实会导致语言丧命的缺陷。”
> 
> ...（链接无效）
> 
> “我们已经知道这个问题很久了。却没有任何进展。”
> 
> Shachar Shemesh，2018年8月23日，D 论坛

（有趣的是，在那个讨论串中为 D 辩护的人之一，Joakim，已经离开了 D - 被 D 领导的直接行动推开，另一个在那里为 D 辩护的人，Mike Franklin，也很快会因为对他的需求缺乏关注而与 D 分道扬镳，尽管他本身是一位重要的贡献者。）

当然，对于那些在 D 领域有一段时间的人来说，包括其领导层，这并不是新鲜事。

在 2022 年圣诞节期间，Mike Parker 宣布了一项活动，要求人们向他发送他们的“D 抱怨和愿望”清单。

许多人说这是毫无意义的，预计不会有任何收获，但仍然有很多回应。

> “对我来说，与 D 的领导打交道一次又一次都是一次令人愤怒的经历。这是我将自己的贡献减少到几乎为零的唯一原因。D 中有很多问题需要解决，但当我不得不为了清理你们的错误而争取特权，而你们甚至不愿意承认自己的错误时，这就不值得了。
> 
> [...](....html)我确信对贡献者的处理不当让 D 浪费了大量人才。"
> 
> ag0aep6g，2022 年 12 月 24 日，D 论坛“发送你的 D 抱怨和愿望清单”。

这已经过去一年了。这给我们带来了什么？在宣布活动约六个月后的 2023 年 5 月 18 日，Mike Parker 发布了一个整理人们反馈意见的[公共文档](https://github.com/dlang/vision-document/blob/main/gripes-wishes-feedback.md)。他说下一步是建立目标，优先考虑，分配和执行。截至目前，*唯一*公开的成果是设定了以下目标：

+   稳定语言/编译器/标准库

+   增强生态系统（改进工具，支持第三方库等）

+   加强社区（清除网站上的废物，更新过时的文档和教程，网站重设计等）

在要求发送电子邮件时，请求中说：“但不要一般性地写。要具体。”而人们写了大量内容。然而，当回复每个人的投诉时，D 的领导层只有这些要点。

怀疑者是对的（又一次）。这里将不会有任何收获。

这不是第一次列出类似目标。请考虑一下 2016H1 Vision 文档中的这些标题：

+   提高参与度

+   工具

+   提高语言的稳定性和规范性

+   库的添加

现在很明显，设定目标是不够的。我们需要*行动*。而且我们需要很久以前就开始了。

我多年来一直对尝试为 D 做出贡献感到不满。小小的成功虽然不错，但无法弥补大的失败。七年前，当我改进 ddoc 遇到瓶颈时，我将其分叉出去，创造了 `adrdox`，这个程序现在为这个网站提供动力。在两周的工作中，我完成了多年来与上游合作未果的事情。

现在，我将再次尝试做到这一点，但这次是整个编译器。我正在离开 Walter Bright 的 D，转向我与其他一些不满意的前贡献者共同启动的 [OpenD](https://dpldocs.info/opend/index.html)，一个分支。

这对于...意味着什么？

+   ...dpldocs.info 的文档托管？

    该网站目前仅仅被 patreon 支持，尽管勉强。这包括 dub 包支持，因此只要成本得到覆盖，它就会继续运行。它将不会接收来自上游 D 的更新，它可能会继续运行良好。

+   这个博客？

    专门支持上游 D 的部分将被停止。这就是为什么此条目不再有统计数据了。但除此之外，我可能仍会在有话要说和有时间说的时候写点东西。焦点已经更多地转向了我的代码而不是 D。因此，它将被改名为“本周的 ARSD”，尽管我可能会将其改为“本周的 OpenD”，但链接仍将起作用。

+   我的上游 PR 和错误报告？

    所有的努力都立即停止了。如果有任何对我有利的东西，我将把它合并到 OpenD 中，甚至不试图将其发送到上游。

+   我的用户支持？

    我历来每周都花费许多小时支持各种技能水平的 D 用户。今天就到此为止了。我为将被错误信息难倒的用户感到难过，但我要继续前进了。

    如果您给我发邮件询问关于上游 D 的事情，我可能会跟您谈，但不保证。我可能会告诉您尝试使用 OpenD。

+   我在 DLF 会议上为普通 D 用户进行倡导？

    除非他们同意治理变革作为前提条件，否则我将不再参加任何 DLF 会议。只有那时我们才可能有一些有意义的讨论。我不指望这会发生。

+   我的 DConf Online 直播？

    我怀疑他们甚至不会邀请我。但如果他们邀请了，我会拒绝的。我现在要走另一条路了。

+   我的库代码？

    我的 D 库历来一直致力于跨内部版本和外部编译器更新的兼容性。这一点仍然存在，但只适用于有付费支持合同的实体。

    对于所有其他用户，所有与上游 D 的兼容性立即取消。可能会工作，也可能不会。此代码按原样提供，不提供任何形式的保证，包括但不限于对适销性和特定用途的默示保证。程序的质量和性能的整个风险由您承担。

    如果您想购买支持合同，包括潜在地支持特定的上游 D 编译器，请联系我讨论条款。

    或者，加入我在 D 中的分支，我的对我的库的支持将无限期地继续。

+   我的 D 应用程序？

    我怀疑很少有人在使用这些，但如果你在使用，和库代码一样：与上游 D 的兼容性按原样提供，没有任何承诺。我通常对应用程序的兼容性保证较为宽松，因为它们本来就只是为了我自己而设计的。

在过去的16年里，我在 D 上花费了很多时间。我的计算机编程生涯几乎完全归功于 D，之前是 Digital Mars C++。Walter Bright 和他的团队对我的生活产生了巨大影响。

我真的希望情况会有所不同。Walter 是一个出色的编程语言项目贡献者，与其一起工作胜过没有他。但现在，是时候展望未来了。要让 OpenD 取得成功，还有很多工作要做。我们很可能会失败，但至少现在，我们只能责怪自己。

（顺便说一句，节标题引用了视频游戏 ["完美黑暗"](https://www.youtube.com/watch?v=8tvhiEclmZI)）
