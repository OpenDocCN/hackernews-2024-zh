<!--yml

category: 未分类

date: 2024-05-27 14:53:26

-->

# 放弃PaaS：为什么我转回自托管 | Shubham Jain

> 来源：[https://shubhamjain.co/2023/01/18/ditching-paas-why-i-went-back-to-self-hosting/](https://shubhamjain.co/2023/01/18/ditching-paas-why-i-went-back-to-self-hosting/)

我从来不是devops/服务器管理员工作的粉丝。设置服务、配置服务、自动化服务以及确保其可靠性所涉及的头痛数量实在令人讨厌且耗时。

PaaS提供商像Heroku、AWS——以及后来的Railway和Render，都是这个混乱局面中的吸引人的选择。我可以通过Web界面做任何事情，不必一次又一次地运行一堆命令。当它们开始看起来价格合适时，我就转向了PaaS，并且多年来都没有回头。

最近，我对自托管的看法发生了变化。现在，我不再支付多个服务的费用，而是在Scaleway租用了一个体积不小的VPS，并将所有项目托管在上面。已经过去了三个月，对我来说一切都很顺利。

我为什么要做出这个改变？发生了两件事情：我开始看到使用PaaS的缺点。我也开始更积极地看待自托管。

这就是为什么我对PaaS产生了厌恶的原因：

1.  **PaaS可能变得非常昂贵：** PaaS的最大优势是你可以通过点击按钮启动任何服务（网站、数据库、缓存）。但是当涉及到成本时，这也可能成为一个问题。无论服务有多小，无论你多么少需要它，你都需要支付全部费用。比如，对于一个需要缓存、Web应用和数据库的服务，成本很快就可以达到每月20-40美元。

    我对这种模式最大的抱怨是，即使我只需要托管一个简单的API或cron作业，我也需要为一个单独的服务付费。

    如果你已经开始赚钱，这可能并不重要，但现在，一个单独的服务器更适合我的需求。

1.  **PaaS带走了你的灵活性：** 如果你只关心特定的任务/服务，PaaS看起来是一个不错的选择，但有时候，你也想利用计算资源来运行cron作业、后台作业，或者托管一个小型服务。使用PaaS时，你就没有这样的灵活性。我做了很多项目，受限于PaaS提供的选项感觉很烦人。

1.  **PaaS提供的计算性价比低：** 这是显而易见的。相同价格的情况下，PaaS总是提供更少的资源，但让我惊讶的是差距会有多大。在Render.com上，一个4GB RAM和2vCPU的服务价格是每月85美元。在Scaleway（ARM）上，相同规格的服务价格是每月14美元。当然，我不需要从一个高规格的机器开始，但是以相同价格获得如此少的计算资源开始变得不那么吸引人了。

与此同时，我开始更看好自托管。

1.  **自托管变得更容易：** 我对自托管的厌恶源自于设置不同服务（nginx、postgres、redis）的痛苦。每个服务都涉及一组单独的命令。我不仅要确保每个服务都配置正确，还要确保它们在服务器重新启动时自动启动。我唯一使用的工具是 Bash 脚本。而且，它们一团糟。

    有了 Docker，这变得简单得多了。我只需要设置 `docker-compose.yml` 并使用开发人员已经为几乎所有服务构建的容器。容器处理大部分繁重的工作，所以我不必去搞配置。

    Caddy 是另一个让我惊喜的工具。它具有比 nginx 更精简的配置语法，并带有自动 HTTPS。

    Github Actions 是另一个使自动化部分变得简单的新增功能。以前，从您的存储库自动化事务涉及设置 Webhooks 并在您的服务器上创建监听器。现在，它可以通过 '.yml' 文件完成。

    新的工具使自托管比以前更容易。

1.  **自托管变得更可靠：** 由于 Docker，自托管也变得比以前可靠得多。您不必担心某个服务占用所有内存。您可以对其进行配置。确保在重新启动期间一切都自动启动的方法就像这样简单，`sudo systemctl enable docker`。

    `docker logs` 是访问服务日志的单个命令。比与 log.d 目录摆弄要好得多的替代方案。

    机器人攻击是另一个头疼的问题。现在可以使用 Cloudflare 来阻止大部分这些攻击（甚至在免费计划中）。

    现在保持服务可靠运行似乎要容易得多。

1.  **灵活性很棒：** 通过更新几个文件即可托管任何服务或运行任何作业，感觉比在 PaaS 平台上创建新服务要容易得多。

在负面方面，拥有单一机器会造成单一故障点。创建故障转移实例或诸如自动备份和恢复之类的事情，仍然是我需要解决的问题。可能，对于自托管来说并不那么简单。但是，根据您要构建的内容，您可以在要求上有些灵活性。

## 结论

我认为，在您处于黑客阶段并且尚未开始赚钱时，自托管是更好的选择。最大的优势是能够在同一台机器上探索多种不同的想法。当然，这也取决于您对 Linux 和命令行的舒适程度。Docker 使事情变得更简单，但仍需要对服务器管理有工作知识。

我发现自托管与我非常匹配，如果你像我一样，多年前已经放弃了它，也许是时候重新尝试一下了。

* * *
