<!--yml

类别：未分类

日期：2024-05-27 14:31:32

-->

# 一个作家的 Ruby

> 来源：[https://world.hey.com/dhh/a-writer-s-ruby-2050b634](https://world.hey.com/dhh/a-writer-s-ruby-2050b634)

大多数程序员似乎对风格持续持怀疑态度。我不仅仅是在谈论那些穿着不协调或使用袖珍护具的书呆子的刻板印象。而是在广义上的审美风格。许多人似乎根深蒂固地反对甚至关注某物的外观是否重要的想法。他们认为这种关注与应该关注的地方——实质——相冲突。这在关于代码风格检查的讨论中非常明显。

代码风格检查是一个将一致的样式应用于源代码的术语。就像遵循

[斯特兰克与怀特的语法指南](https://www.amazon.com/Elements-Style-Fourth-William-Strunk/dp/020530902X)

用于散文，但由一个代码检查程序自动执行。这是一个已经存在很长时间的技术，但随着基于云的持续集成设置的出现，它已经被更广泛地采用，这些设置在准备每个拉取请求时运行测试，现在还运行代码风格检查。

一些语言，比如 Go，有

[内置代码检查程序](https://go.dev/blog/gofmt)

，它采用了一种被语言设计者设定的通用风格。这是最极权主义的方法。一个几乎与编译错误相差无几的程序样式规定。我一点也不喜欢那个。

它让我想起了

[新话](https://bookanalysis.com/1984/newspeak/)

，奥威尔的《1984》中的新 INGSOC 语言。并不是因为有任何邪恶的政治含义，而是为了追求一种极简主义语言，没有多余的术语或歧义或花哨。想象一下，如果每一部小说都采用相同的风格，海明威和狄更斯的风格无法区分，托尔金和罗琳的风格也无法区分。如果英语只有一种散文风格，那会非常单调。

我已经听到反对声音了：代码不是散文！它的编译目标是计算机，而不是想象！哦，我敢不同意。对我来说，最好的代码确实是自己的一种诗歌形式，而风格是这种表达的一部分。在 Ruby 中尤其如此。

虽然 Python 的座右铭长期以来一直是“应该有一种——最好只有一种——明显的方法来做”，但 Ruby 却正好相反。几乎每件事情都有许多做法，这也是为什么像我这样的人喜欢阅读和编写 Ruby 的原因。

[努力像作家一样写代码](https://www.youtube.com/watch?v=9LfmrkyP81M)

更像一个作家而不是一个工程师。

让我给你举个最基本的例子：

```
def ensure_privileged_access
  if !person.admin?
    redirect_to root_url,
  end
end
```

我总觉得“if not”表达式很笨拙，尽管它是大多数编程语言的主要内容。但 Ruby 也允许你这样写：

```
def ensure_privileged_access
  redirect_to root_url unless person.admin?
end
```

现在我不知道我会不会称之为诗歌，但我确实发现它读起来更加愉快。而这只是一个句子。把几个句子组合成一个段落（方法），然后组合成一篇文章（类），很快你就会有一本整书（系统）。这种写法很重要。

也许有些人更喜欢更传统、更直接的风格，他们可以在一个代码检查规则中编码这种偏好。只要他们不试图强迫我遵守他们的风格偏好，我完全没有问题。

这就涉及到代码检查的问题核心。我认为它们是作者和团队强制执行的优秀工具

*他们的*

一致的风格

*他们的*

代码库。这就是为什么我们在下一个版本的Rails中要发布一个默认的代码检查工具，巧妙地称为RuboCop。不是为了我，或任何人，能够强制规定你的代码库应该以什么样的风格编写，而是为了你可以找到并执行你自己的风格。

尽管并非每个人都已经形成了个人或团队风格，但对于他们，我们将包括

[我已经形成的偏好](https://github.com/rails/rubocop-rails-omakase/)

在过去的两十年中，与37signals团队一起编写了数十万行Ruby代码。这就是“大厨菜单”。但这实际上只是Rails程序员和团队发展自己感觉的起点，而不是永久性规定应该是什么样的。

对我来说，这就是风格的本质，它总是很个人化的。如果每个人都一样，任何时候都是一样的，我们甚至不会谈论风格。Ruby为我们提供了如此丰富和富有表现力的语法，如果我们将所有可能的路径缩减为单一、预先批准的路径，那将是一件非常可惜的事情。Ruby是给作者用的。
