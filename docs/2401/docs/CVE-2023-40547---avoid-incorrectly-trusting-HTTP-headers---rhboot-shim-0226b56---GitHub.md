<!--yml
category: 未分类
date: 2024-05-27 15:09:07
-->

# CVE-2023-40547 - avoid incorrectly trusting HTTP headers · rhboot/shim@0226b56 · GitHub

> 来源：[https://github.com/rhboot/shim/commit/0226b56513b2b8bd5fd281bce77c40c9bf07c66d](https://github.com/rhboot/shim/commit/0226b56513b2b8bd5fd281bce77c40c9bf07c66d)

<include-fragment class="js-notification-shelf-include-fragment" data-base-src="https://github.com/notifications/beta/shelf"></include-fragment>

<main id="js-repo-pjax-container"> <turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">## Commit

[Permalink](/rhboot/shim/commit/0226b56513b2b8bd5fd281bce77c40c9bf07c66d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[Browse files](/rhboot/shim/tree/0226b56513b2b8bd5fd281bce77c40c9bf07c66d) <tool-tip id="tooltip-feab6ae2-2d9d-4414-b017-972ef21ac628" for="browse-at-time-link" popover="manual" data-direction="ne" data-type="description" data-view-component="true" class="sr-only position-absolute">Browse the repository at this point in the history</tool-tip>

```
When retrieving files via HTTP or related protocols, shim attempts to
allocate a buffer to store the received data.  Unfortunately, this means
getting the size from an HTTP header, which can be manipulated to
specify a size that's smaller than the received data.  In this case, the
code accidentally uses the header for the allocation but the protocol
metadata to copy it from the rx buffer, resulting in an out-of-bounds
write.

This patch adds an additional check to test that the rx buffer is not
larger than the allocation.

Resolves: CVE-2023-40547
Reported-by: Bill Demirkapi, Microsoft Security Response Center
Signed-off-by: Peter Jones <pjones@redhat.com>
```

 <include-fragment src="/rhboot/shim/branch_commits/0226b56513b2b8bd5fd281bce77c40c9bf07c66d" id="async-branches-list">*   Loading branch information</include-fragment> <diff-layout sidebar-hidden=""></diff-layout></turbo-frame></main>

 <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" data-initial-cookie-consent-allowed="" data-cookie-consent-required="false">You can’t perform that action at this time.

<template id="site-details-dialog"></template><template id="snippet-clipboard-copy-button"></template><template id="snippet-clipboard-copy-button-unpositioned"></template></ghcc-consent>