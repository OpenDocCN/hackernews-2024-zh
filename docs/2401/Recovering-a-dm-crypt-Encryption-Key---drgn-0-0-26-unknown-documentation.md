<!--yml

category: 未分类

date: 2024-05-27 14:44:13

-->

# 恢复 dm-crypt 加密密钥 — drgn 0.0.26+unknown 文档

> 来源：[`drgn.readthedocs.io/en/latest/case_studies/dm_crypt_key.html`](https://drgn.readthedocs.io/en/latest/case_studies/dm_crypt_key.html)

```
>>> def aes_xts_ctx(tfm):
...     AESNI_ALIGN = 16
...     mask = AESNI_ALIGN - 1
...     ctx = cast("unsigned long", crypto_skcipher_ctx(tfm))
...     return cast("struct aesni_xts_ctx *", (ctx + mask) & ~mask)
...
>>> xts_ctx = aes_xts_ctx(cryptd_ctx.child)
>>> xts_ctx
*(struct aesni_xts_ctx *)0xffffa3b945dc4030 = {
 .tweak_ctx = (struct crypto_aes_ctx){
 .key_enc = (u32 [60]){
 4053857025, 2535432618, 3497512106, 429624542,
 190965574, 620881567, 2728140233, 1574816406,
 1642869364, 4143158238, 646209396, 1059050410,
 2124513770, 1537238901, 4181490364, 2766254122,
 2225457809, 1918261583, 1423050299, 1808651665,
 18645611, 1522328862, 2743115682, 123809672, 1080042880,
 842431695, 1726249716, 220835685, 3602512678,
 2349145656, 797278618, 686075410, 2304003180,
 3143774371, 3716565591, 3501188402, 2797609477,
 717569085, 88128935, 765727669, 1552680193, 3891148194,
 979927029, 3938949831, 554080963, 197371646, 243473241,
 589760748, 2460666129, 1967455411, 1328317254,
 2783648129, 669994703, 741140529, 581956456, 25754500,
 3453357406, 3096637933, 4156453547, 1381329706,
 },
 .key_dec = (u32 [60]){
 3453357406, 3096637933, 4156453547, 1381329706,
 1691590497, 1611861415, 2033812690, 3535200077,
 1503779265, 1400120959, 2713205381, 402136101,
 2278736107, 79729350, 422218101, 2878299039, 3072023845,
 181796798, 4073463034, 3057657504, 2722800653,
 2199015981, 501881779, 2997211882, 893456792,
 3184435867, 4162446148, 1150040666, 3430456984,
 559478304, 2667071902, 2941241689, 2504843709,
 2291118851, 1171735007, 3163937054, 4210330224,
 3978324152, 3214983102, 834109639, 179351664, 499339966,
 3445158620, 4181891265, 4283462504, 399827656,
 1384175366, 2383888249, 3581021031, 393470670,
 3499860066, 874146333, 3319833674, 3901002144,
 1163146702, 3700942975, 4053857025, 2535432618,
 3497512106, 429624542,
 },
 .key_length = (u32)32,
 },
 .crypt_ctx = (struct crypto_aes_ctx){
 .key_enc = (u32 [60]){
 91118336, 1683438947, 280915620, 1674463119, 3416529787,
 95371281, 156839573, 539041733, 2748950209, 3348011938,
 3610309894, 3036590729, 1176448220, 1135635661,
 1256800856, 1791516061, 4259008143, 978703661,
 3982827563, 1503367842, 2366333926, 3468365611,
 2219986291, 4003074286, 3589535297, 4020642668,
 46334791, 1532531173, 3026313791, 2061167892,
 4270366823, 269660297, 1916354478, 2644450498,
 2673614725, 3288632928, 2828270575, 3528005371,
 750892700, 1020462613, 735205841, 3058517267, 689003158,
 3977630966, 4257919917, 797156694, 54662090, 1066472927,
 3047676072, 65707451, 721143597, 3354268635, 1004719636,
 341928770, 388200584, 682782039, 4002672596, 3984159343,
 3347232066, 7120537,
 },
 .key_dec = (u32 [60]){
 4002672596, 3984159343, 3347232066, 7120537, 2275767381,
 3582792214, 728749911, 250810445, 2145441323,
 3415330885, 1171250799, 717236012, 72947820, 1378379331,
 4276274497, 631031578, 3286455042, 3027306094,
 2388528682, 1863317827, 1027747936, 1450278447,
 2898961154, 3682468443, 2929020077, 2006078828,
 976160836, 3780245353, 3002856629, 1798524495,
 4206615853, 2008326489, 523503039, 3641121217,
 1304255784, 3682533165, 3583917429, 3653810938,
 2441646946, 2366602356, 2101484483, 3325238398,
 2495235305, 2529403397, 1276800912, 206997391,
 1212164504, 478670614, 2260253082, 3144746941,
 1384732823, 41543404, 2858181789, 1078781983,
 1142337047, 1422378638, 91118336, 1683438947, 280915620,
 1674463119,
 },
 .key_length = (u32)32,
 },
} 
```
