<!--yml

åˆ†ç±»ï¼šæœªåˆ†ç±»

æ—¥æœŸï¼š2024-05-27 14:31:20

-->

# CultriX/MistralTrix-v1 Â· Hugging Face

> æ¥æºï¼š[`huggingface.co/CultriX/MistralTrix-v1`](https://huggingface.co/CultriX/MistralTrix-v1)

# [](#edit)ç¼–è¾‘ï¼š

æ€»æ˜¯æŸ¥çœ‹æˆ‘çš„ç©ºé—´ä»¥èŽ·å–æœ€æ–°çš„æ¨¡åž‹åŸºå‡†ç»“æžœï¼

# [](#results)ç»“æžœï¼š

T: ðŸŸ¦ æ¨¡åž‹ï¼šCultriX/MistralTrix-v1 ðŸ“‘ å¹³å‡å€¼ï¼š73.39 ARCï¼š72.27 HellaSwagï¼š88.33 MMLUï¼š65.24 TruthfulQAï¼š70.73 Winograndeï¼š80.98 GSM8Kï¼š62.77

# [](#editdisclaimer)ç¼–è¾‘/å…è´£å£°æ˜Žï¼š

ç›®å‰åœ¨ LLM æŽ’è¡Œæ¦œä¸ŠæŽ’åç¬¬ä¸€çš„ 7B LLMï¼Œå“‡ï¼æˆ‘æ ¹æœ¬æ²¡æƒ³åˆ°ä¼šæœ‰è¿™æ ·çš„ç»“æžœï¼Œè€Œä¸”åœ¨ LLM æˆ–è€…è®¡ç®—æœºç§‘å­¦æ–¹é¢æˆ‘å®Œå…¨ä¸æ˜¯ä¸“ä¸šçš„ï¼Œåªæ˜¯ä¸€ä¸ªå–œæ¬¢ç ”ç©¶å’Œæ‘†å¼„çš„å®¶ä¼™ã€‚

å¯¹äºŽé‚£äº›æƒ³çŸ¥é“æˆ‘æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„äººï¼Œç­”æ¡ˆå°±æ˜¯æˆ‘ç®€å•åœ°å°è¯•äº†è‡ªå·±åœ¨è¿™ç¯‡ç²¾å½©æ–‡ç« ä¸­æ¦‚è¿°çš„æŠ€æœ¯ï¼š[`towardsdatascience.com/fine-tune-a-mistral-7b-model-with-direct-preference-optimization-708042745aac`](https://towardsdatascience.com/fine-tune-a-mistral-7b-model-with-direct-preference-optimization-708042745aac) å› æ­¤ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„åŠŸåŠ³éƒ½å½’åŠŸäºŽé‚£ä¸ªå†™è¿™ç¯‡æ–‡ç« çš„å®¶ä¼™ã€‚ä»–æä¾›äº†æˆ‘ç”¨æ¥è®­ç»ƒè¿™ä¸ªæ¨¡åž‹çš„ç¡®åˆ‡ Colab ç¬”è®°æœ¬ï¼Œä»¥åŠä¸€ä¸ªéžå¸¸å¥½çš„ GitHub é¡µé¢ï¼Œæˆ‘å¸Œæœ›ä»–ä¸ä»‹æ„æˆ‘åˆ†äº«ï¼š[`github.com/mlabonne/llm-course/`](https://github.com/mlabonne/llm-course/) æ‰€ä»¥éžå¸¸æ„Ÿè°¢ä»–åˆ†äº«ä»–çš„çŸ¥è¯†ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ•™äº†æˆ‘ä¸€ä¸¤ä»¶äº‹æƒ…ï¼

# [](#gguf)GGUF

æˆ‘å°è¯•äº†è‡ªå·±é‡åŒ–æ¨¡åž‹ï¼Œå†æ¬¡å¼ºè°ƒï¼Œæˆ‘å¯¹æ­¤å‡ ä¹Žä¸€æ— æ‰€çŸ¥ï¼Œä½†å½“æˆ‘æµ‹è¯•å®ƒä»¬æ—¶ï¼Œå®ƒä»¬ä¼¼ä¹Žè¿è¡Œè‰¯å¥½ï¼š[`huggingface.co/CultriX/MistralTrix-v1-GGUF`](https://huggingface.co/CultriX/MistralTrix-v1-GGUF)

ä¸è¿‡ï¼Œæˆ‘è¦å†è¯´ä¸€æ¬¡ï¼šâ€œæˆ‘å¯¹è¿™ä¸€åˆ‡å®Œå…¨æ˜¯ä¸ªæ–°æ‰‹ï¼Œæ‰€ä»¥å¦‚æžœè¿™äº›ç»“æžœä¸å¥½åˆ«æ„Ÿåˆ°æƒŠè®¶ã€‚â€

ä½ å·²ç»è¢«è­¦å‘Šäº† :)

# [](#description)æè¿°ï¼š

ï¼ˆåœ¨å•ä¸ª Colab GPU ä¸Šè®­ç»ƒï¼Œä¸åˆ°å‡ ä¸ªå°æ—¶ï¼‰

MistralTrix-v1 æ˜¯ä¸€ä¸ª zyh3826/GML-Mistral-merged-v1 æ¨¡åž‹ï¼Œç»è¿‡ä½¿ç”¨ Intel çš„æ•°æ®é›†è¿›è¡Œäº†è¿›ä¸€æ­¥çš„ç›´æŽ¥åå¥½ä¼˜åŒ–ï¼ˆDPOï¼‰ fine-tuneã€‚å®ƒåœ¨å‡ ä¸ªåŸºå‡†æµ‹è¯•ä¸­è¶…è¶Šäº†åŽŸå§‹æ¨¡åž‹ï¼ˆå‚è§ç»“æžœï¼‰ã€‚

å®ƒç›´æŽ¥å—åˆ°äº† Intel/neural-chat-7b-v3-1 çš„ä½œè€…æè¿°çš„ RLHF è¿‡ç¨‹çš„å¯å‘ï¼Œä»¥æé«˜æ€§èƒ½ã€‚æˆ‘ä½¿ç”¨äº†ç›¸åŒçš„æ•°æ®é›†ï¼Œå¹¶é‡æ–°æ ¼å¼åŒ–äº†å®ƒä»¥åº”ç”¨ ChatML æ¨¡æ¿ã€‚

è®­ç»ƒæ­¤æ¨¡åž‹çš„ä»£ç å¯åœ¨ Google Colab å’Œ GitHub ä¸ŠèŽ·å¾—ã€‚åœ¨ Google Colab A-1000 GPU ä¸Šï¼Œä½¿ç”¨ 40GB VRAM çš„ fine-tuning å¤§çº¦éœ€è¦ä¸€ä¸ªå°æ—¶ã€‚

# [](#training-specifications)è®­ç»ƒè§„èŒƒ

> LoRA é…ç½® peft_config = LoraConfig( r=16, lora_alpha=16, lora_dropout=0.05, bias="none", task_type="CAUSAL_LM", target_modules=['k_proj', 'gate_proj', 'v_proj', 'up_proj', 'q_proj', 'o_proj', 'down_proj'] )
> 
> é€šè¿‡ä»¥ä¸‹ä»£ç  fine-tune æ¨¡åž‹ï¼š`AutoModelForCausalLM.from_pretrained( model_name, torch_dtype=torch.float16, load_in_4bit=True )`ï¼Œ`model.config.use_cache = False`
> 
> å‚è€ƒæ¨¡åž‹ ref_model = AutoModelForCausalLM.from_pretrained( model_name, torch_dtype=torch.float16, load_in_4bit=True )
> 
> è®­ç»ƒå‚æ•° training_args = TrainingArguments( per_device_train_batch_size=4, gradient_accumulation_steps=4, gradient_checkpointing=True, learning_rate=5e-5, lr_scheduler_type="cosine", max_steps=200, save_strategy="no", logging_steps=1, output_dir=new_model, optim="paged_adamw_32bit", warmup_steps=100, bf16=True, report_to="wandb", )
> 
> åˆ›å»º DPO è®­ç»ƒå™¨ dpo_trainer = DPOTrainer( model, ref_model, args=training_args, train_dataset=dataset, tokenizer=tokenizer, peft_config=peft_config, beta=0.1, max_prompt_length=1024, max_length=1536, )
