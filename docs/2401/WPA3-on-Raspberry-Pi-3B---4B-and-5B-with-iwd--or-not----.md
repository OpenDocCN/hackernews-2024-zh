<!--yml

类别：未分类

日期：2024-05-27 15:04:22

-->

# 树莓派 3B+，4B 和 5B 上的 WPA3 与 iwd（或不使用...）

> 来源：[`rachelbythebay.com/w/2024/01/24/wpa3/`](https://rachelbythebay.com/w/2024/01/24/wpa3/)

## 树莓派 3B+，4B 和 5B 上的 WPA3 与 iwd（或不使用...）

好的，距离我上次写有关树莓派硬件上的 WPA3 已经过去了几个月。现在，我有一些好消息：现在它基本上可以工作了，只要你愿意做一点小调整。你不再需要折腾自定义固件和二进制块。这已经为你做好了。

这里有一件重要的事情：我只在这里谈论 Raspbian/Raspberry Pi OS，而且只谈论 bookworm（12）。如果你正在运行其他东西，这些都可能不适用。我所知道的是，如果你的发行版更早地弄清楚了这一点，它可能一直在工作。

所以，如果你有一个在 bookworm 上的 3B+，4B 或 5B，准备好行动。

我时不时地查看通过 apt 传送到我的系统的软件包更新列表，通常对通常的一轮 CVE 补丁感到沮丧。但是，这一次我看到了一些不同的东西。这是对“firmware-brcm80211”的更改，这是什么？某些特定于 3B+和后续使用的 CYW43455 的东西？哦，这很有趣，对吧？

```
  * brcm80211: cypress: Use a generic CYW43455 firmware
    - Version: 7.45.234 (4ca95bb CY) CRC: 212e223d Date: Thu 2021-04-15 03:06:00 PDT Ucode Ver: 1043.2161 FWID 01-996384e2

```

我想知道这是否会停止疯狂，所以我应用它并重新启动了。"iw phy"显示了一个好消息-在底部，它现在支持 SAE_OFFLOAD 和 SAE_OFFLOAD_AP。这意味着它实际上可以执行 SAE...但是你将不得不放弃 wpa_supplicant，转而使用 iwd。

如果你为了与 bookworm 的其他更改保持一致而切换到了 NetworkManager，这并不是什么大问题。如果你以其他方式运行你的网络，你得自己弄清楚这个问题。

步骤如下：apt update，然后 apt upgrade，这样你就可以从 1 月 17 日（或更晚，我猜一旦这篇文章变老了）起得到 firmware-brcm80211。然后 apt install iwd。

假设你一直在一个糟糕的非 WPA3 网络中运行你的 Pi，进入 nmtui 或等效的操作，禁用那个网络。一两分钟后，你将不再需要它了。

然后禁用 wpa_supplicant，并在`/etc/NetworkManager/conf.d/iwd.conf`中添加一点配置：

```
[device]
wifi.backend=iwd

```

重新启动…或进行等效的驱动程序和二进制垃圾的摆弄，使其卸载并重新加载新的东西。然后再次运行“iw phy”。如果它显示 SAE_OFFLOAD 和 SAE_OFFLOAD_AP，那么你已经准备好继续了。如果没有，那么，嗯，出了点问题，你应该重新启用那个糟糕的旧的非 WPA3 网络。

假设它工作了，然后进入 nmtui 或其他任何工具，告诉它激活实际的 WPA3-only 网络。粘贴你的 PSK 并让它运行，几秒钟后你应该可以开始工作了。

就是这样。这就是全部所需。

现在，你可能会问起 3B 怎么样。它在一个不做 5 GHz 的不同芯片上，所以改变 43455 固件也没用。看起来像是 43430，我不知道是否有机会得到类似的固件更改。显然，如果情况改变，我也会发帖更新。

我不能评论其他型号，比如 Zeroes 和其他奇怪的小板子。我只能接触到这些相对正常的型号，这也是我能够处理的。

前进吧，拥有更好的网络！

* * *

2024 年 1 月 24 日：这篇帖子有一个更新。
