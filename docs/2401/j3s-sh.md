<!--yml

分类：未分类

日期：2024 年 05 月 27 日 14:23:31

-->

# j3s.sh

> 来源：[`j3s.sh/thought/fail2ban-sux.html`](https://j3s.sh/thought/fail2ban-sux.html)

[fail2ban sucks](https://www.example.org/fail2ban_sucks) 2020-03-22 -> fail2ban sucks 我在互联网上多次提出了这个论点，所以我想把它写下来，这样我就可以直接链接到它。我觉得这通常是一个有争议的观点。重要说明：我并不是说 fail2ban 对每种用例都不好，我主要是以这样的方式写作，试图对抗我在各处看到的狂热的 fail2ban 推荐，我认为这是危险的。如果你喜欢 fail2ban，那就用吧 - 但这是我的想法。对于那些不熟悉 fail2ban 的人，通常来说，它是一款软件，用于监视日志文件中的登录失败，然后与防火墙交互，以阻止属于这些失败的 IP 地址。它是可配置的，以便可以说“如果某个 IP 在 SSH 上连续登录失败 10 次，则阻止它 1 小时。”我在互联网上经常看到 fail2ban 被推荐。通常当一个新的服务器管理员设置服务器并询问所有这些奇怪的 SSH 尝试时，fail2ban 就会出现。这里有一些 fail2ban 粉丝的引用： > 一个方便的服务是 fail2ban，它会自动 > 将 IP 地址添加到防火墙，如果失败尝试足够多的话 > 为了禁止它们，你可以尝试使用 fail2ban。似乎是一种常见的做法 > 对于这种类似机器人的活动，一个好的密码与 iptables 速率限制、fail2ban 和日志监视更好。 > 如果你玩得开心的话，非标准端口和/或 fail2ban 可以防止日志垃圾邮件。 > 我觉得最好/最懒的组合是 ufw/ssh/fail2ban/f2b-loop/logwatch。我有几个论点，这是摘要：不要更改你的标准端口。不要使用 fail2ban。使用内置机制加固你的应用程序。如果你需要为某些应用程序提供超级额外的安全性，请只允许受信任的 IP 范围 - 使用 IP 白名单。大多数人都是在过度设计。fail2ban 糟透了，让我数数它的缺点。fail2ban： * 不会阻止高级持续威胁 * 有时会给你带来麻烦 * 有时可能会给 *你的用户* 带来麻烦 * 使你暴露于 fail2ban 的漏洞 * 可能会让你觉得你的系统比实际上更安全 * 在最佳情况下，fail2ban：不比正确配置的应用程序更安全 * 实际上比正确配置的应用程序 _ 更 _ 不安全 在最好的情况下，fail2ban：什么都没做，在最糟糕的情况下，fail2ban：给你带来巨大的麻烦或完全锁定你出来 让我们设身处地地想象一下一个新的系统管理员的心态。他们启动了一个新的 capsul[1]，他们在他们的新系统周围窥探。突然间，他们注意到他们的 SSH 日志 - 数百个来自俄罗斯和中国的 IP 地址一次又一次地试图登录到他们的系统中。自然地，这引发了人们可能称之为“不好的氛围”。这让系统感觉不够清洁。谁决定这样做是可以的？我刚刚完成了设置这个系统，它已经被攻击了！？不要听他们的建议，新的管理员。只需正确设置 SSH，不用担心任何事情。这是我的理由。首先，让我们想一想这些 IP 到底属于谁。 * 机器人 数以万计的机器人正在尝试对地球上已知的每个服务使用常见的用户名/密码组合 - SSH 并不特殊。这适用于互联网上的每个登录页面，这些页面期望有用户名和密码。想想电子邮件和 neocities。想想 wordpress 管理员页面和留下大门大开的数据库接口。如果你不把你的服务配置为在公共接口上侦听，而这些服务配置的用户名像“admin”和密码像“admin”，你就没什么可担心的。 * 好奇的用户 朋友想要捉弄你，对 SSH 一无所知的孩子，也许是在酒吧惹恼了你的那个女孩，她的笔记本电脑上安装了 Kali。专业提示：这些尝试可能会比机器人的尝试不成功。 * 高级持续威胁 通常是国家行为者，也许是一个有怨恨的僵尸网络操作员。无论哪种情况，fail2ban 无济于事 - 这些用户可以像看到矩阵一样通过代理尖叫。他们可以每秒变换十九百万次 IP 地址而不眨眼。你可以用 fail2ban 禁止地球四分之一的 IP 地址 - 攻击者会使用另一个四分之一。我想说的

在[mastodon！](https://merveilles.town/@j3s)上关注我！

最后更新于 2020-03-22T00:00:00.000Z
