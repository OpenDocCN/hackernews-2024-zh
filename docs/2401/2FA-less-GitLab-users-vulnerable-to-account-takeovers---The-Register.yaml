- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-27 14:50:22'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: 2FA-less GitLab users vulnerable to account takeovers • The Register
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://www.theregister.com/2024/01/15/critical_gitlab_vulnerability/](https://www.theregister.com/2024/01/15/critical_gitlab_vulnerability/)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: GitLab admins should apply the latest batch of security patches pronto given
    the new critical account-bypass vulnerability just disclosed.
  prefs: []
  type: TYPE_NORMAL
- en: Tracked as CVE-2023-7028, the maximum-severity bug exploits a change introduced
    in version 16.1.0 back in May 2023 that allowed users to issue password resets
    through a secondary email address.
  prefs: []
  type: TYPE_NORMAL
- en: Attackers targeting vulnerable self-managed GitLab instances could use a specially
    crafted HTTP request to send a password reset email to an attacker-controlled,
    unverified email address.
  prefs: []
  type: TYPE_NORMAL
- en: An attacker can complete the takeover without any user intervention, and those
    who haven't enabled two factor authentication (2FA) are prime targets for the
    opportunistic crime.
  prefs: []
  type: TYPE_NORMAL
- en: Users with 2FA enabled aren't vulnerable to account takeover, unless the attacker
    also had control of the 2FA authenticator, but a password reset could still be
    achieved.
  prefs: []
  type: TYPE_NORMAL
- en: GitLab doesn't support SMS-based 2FA – the most [commonly hijacked implementation](https://www.theregister.com/2016/12/06/2fa_missed_warning/)
    – only supporting app-based 2FA or that issued via a [WebAuthn device](https://www.theregister.com/2018/04/11/fido_takes_a_bite_out_of_passwords_with_two_authentication_standards/),
    which are much more secure.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are, however, a fair few versions of GitLab''s Community and Enterprise
    editions that are affected and will require patching as soon as possible:'
  prefs: []
  type: TYPE_NORMAL
- en: 16.1 to 16.1.5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 16.2 to 16.2.8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 16.3 to 16.3.6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 16.4 to 16.4.4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 16.5 to 16.5.5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 16.6 to 16.6.3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 16.7 to 16.7.1
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All authentication mechanisms are affected here, GitLab said, even some of those
    that use single sign-on (SSO).
  prefs: []
  type: TYPE_NORMAL
- en: '"Users without SSO enforcement are vulnerable," GitLab said in its [advisory](https://about.gitlab.com/releases/2024/01/11/critical-security-release-gitlab-16-7-2-released/).
    "If your configuration allows a username and password to be used in addition to
    SSO options, then you are impacted. Disabling all password authentication options
    via https://docs.gitlab.com/ee/administration/settings/sign_in_restrictions.html#password-authentication-enabled
    will mitigate the vulnerability for self-managed customers that have an external
    identity provider configured, as this will disable the ability to perform password
    reset."'
  prefs: []
  type: TYPE_NORMAL
- en: Thankfully, at the time of disclosure, there was no evidence to suggest the
    bug had been successfully exploited, but as ever, when a vulnerability is made
    public, with an exploit as simple as this, wider exploitation attempts are likely
    and it becomes a race against the attackers to patch the flaw.
  prefs: []
  type: TYPE_NORMAL
- en: Since admins will need time to apply patches, without skipping upgrade stops
    to prevent instability issues from manifesting, a speedier stop-gap mitigation
    would be to mandate 2FA across all accounts as this will, in the vast majority
    of cases, prevent account takeover attempts.
  prefs: []
  type: TYPE_NORMAL
- en: Ideally, once that's enabled it will stay enabled for good, especially for key
    accounts like those with admin privileges.
  prefs: []
  type: TYPE_NORMAL
- en: We only need to look back to last week to learn the value of enabling 2FA –
    even the biggest names in security [fumble the basics](https://www.theregister.com/2024/01/11/mandiant_x_account_brute_forced/)
    from time to time.
  prefs: []
  type: TYPE_NORMAL
- en: A takeover of a GitLab account could mean serious business for attackers, given
    the amount of intellectual property and source code belonging to organizations
    held in the DevOps platform.
  prefs: []
  type: TYPE_NORMAL
- en: 'GitLab said customers can check their logs for signs of exploitation, highlighting
    two that will reveal any nefarious activity:'
  prefs: []
  type: TYPE_NORMAL
- en: Check gitlab-rails/production_json.log for HTTP requests to the `/users/password`
    path with params.value.email consisting of a JSON array with multiple email addresses.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Check gitlab-rails/audit_json.log for entries with `meta.caller_id` of `PasswordsController#create`
    and `target_details` consisting of a JSON array with multiple email addresses.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Since the vulnerability was brought to GitLab's attention via its bug bounty
    program, the company has added new tests to validate the password reset logic
    to prevent similar vulnerabilities from occurring in the future.
  prefs: []
  type: TYPE_NORMAL
- en: It's also started a root cause analysis process that it expects to generate
    additional follow-up actions to implement, as well as updating its documentation
    to improve awareness of the issue for engineers.
  prefs: []
  type: TYPE_NORMAL
- en: A second critical vulnerability was also addressed in the same round of patches.
    CVE-2023-5356 has been assigned a 9.6 CVSS score and allows attackers to execute
    slash commands in [Slack](https://www.theregister.com/2023/05/30/slack_e2ee_protest/)
    or Mattermost.
  prefs: []
  type: TYPE_NORMAL
- en: While not as serious as an account takeover, a successful exploit could afford
    attackers the chance to add themselves into channels, potentially exposing an
    organization's secret work to unauthorized parties.
  prefs: []
  type: TYPE_NORMAL
- en: Organizations with custom apps and integrations that use slash commands could
    also leak sensitive data, depending on their function, for example.
  prefs: []
  type: TYPE_NORMAL
- en: 'Other, less-severe fixes also include:'
  prefs: []
  type: TYPE_NORMAL
- en: '**CVE-2023-4812**: An issue has been discovered in GitLab affecting all versions
    starting from 15.3 before 16.5.5, all versions starting from 16.6 before 16.6.4,
    all versions starting from 16.7 before 16.7.2\. The required CODEOWNERS approval
    could be bypassed by adding changes to a previously approved merge request.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**CVE-2023-6955**: An improper access control vulnerability exists in GitLab
    Remote Development affecting all versions prior to 16.5.6, 16.6 prior to 16.6.4
    and 16.7 prior to 16.7.2\. This condition allows an attacker to create a workspace
    in one group that is associated with an agent from another group.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**CVE-2023-2030**: An issue has been discovered in GitLab CE/EE affecting all
    versions from 12.2 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2
    in which an attacker could potentially modify the metadata of signed commits.
    ®'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
