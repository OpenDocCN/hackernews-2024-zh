- en: <!--yml
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
- en: 'category: æœªåˆ†ç±»'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-27 15:00:54'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: -->
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: My Toddler Still Loves Planes, So I Upgraded Her Radar
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: æ¥æºï¼š[https://jacobbartlett.substack.com/p/my-toddler-still-loves-planes-so](https://jacobbartlett.substack.com/p/my-toddler-still-loves-planes-so)
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This is part indie dev story, part release notes, and part technical documentation
    as I detail the long-awaited upgrade to [Aviatorâ€Šâ€”â€ŠRadar on your Phone](https://apps.apple.com/app/aviator-radar-on-your-phone/id6469189335)!
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: Late-night plane-spotting using the newly upgraded AviatorÂ 2.0
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: '*For the HackerNews crowdâ€”please [follow me on X/Twitter](https://twitter.com/jacobs_handle)
    if you liked this post!*'
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[My Toddler Loves Planes, So I Built Her A Radar](https://jacobbartlett.substack.com/p/my-toddler-loves-planes-so-i-built)
    was by far the best thing Iâ€™ve written. I managed to hit that sweet spot of wholesome
    and technical, and my sheer enjoyment of the project shined through in my narrative.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: Posting a week after the [OpenAI drama](https://news.ycombinator.com/item?id=38309611),
    I was **this** close to making the top post of the week, but was just beaten out
    by the late, great [CharlieÂ Munger](https://news.ycombinator.com/item?id=38451278)
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: One would think, as an enterprising indie developer, Iâ€™d jump straight on top
    of the hype train, shoot out another release, and begin dreaming up monetisation
    opportunities.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: But there was a stumbling block! Unfortunately, Aviator had been broken since
    early December. [OpenSky Network](https://twitter.com/OpenSkyNetwork) had been
    having an incident which gave all my users an error.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: A power outage in the open-source OpenSkyÂ Network
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: After trying very hard not to think about this for several weeks, a miracle
    happened. I opened the app again, expecting to torture myself with the persistent
    502 error message, when I heard the characteristic beep-boop of planes detected
    on the radar.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: '**It was working again!**'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: Newly energised by this belated Christmas miracle, I dove headfirst into two
    intense evenings* of overhauling Aviator with the ideas that had been brewing
    in the back of my brain.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: '**After getting my toddler to bed, of course.*'
  id: totrans-17
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This release includes several shiny new features, and solves several problems
    my daughter and I experienced while we played with the original.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: Iâ€™ve overhauled the UI so the controls now live in a separate menu. This utilises
    [progressive disclosure](https://jacobbartlett.substack.com/p/enums-and-design-systems)
    to keep the major controls front-and-centre, and the advanced, less frequently
    accessed tools below the fold.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: Yes, picking a colour is absolutely one of the 3 core controls. My daughter
    likes it more than theÂ planes.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: 'This menu is implemented as a modal with two presentation detents:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: It also has a presentation drag indicator so users know they can extend the
    controls menu, and vitally enables background interaction so we donâ€™t cover the
    main radar UI in shadow.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Iâ€™m planning to utilise the new [TipKit](https://developer.apple.com/documentation/tipkit)
    in 2.1 to ensure this progressive disclosure isnâ€™t lost on our younger, less experienced
    Apple fans.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: 'This `presentationBackground` wraps up another piece of polish: I used [Paul
    Hudsonâ€™s emboss effect](https://www.hackingwithswift.com/quick-start/swiftui/how-to-add-metal-shaders-to-swiftui-views-using-layer-effects).
    This is another Metal shader which applies a lovely metallic texture to the menu,
    further improving on the skeuomorphism of a control panel for a real-life radar.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: 'If you want to learn more about making your own shaders in SwiftUI, read my
    tutorial [Metal in SwiftUI: How to Write Shaders](https://jacobbartlett.substack.com/p/metal-in-swiftui-how-to-write-shaders).'
  id: totrans-26
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: While building 1.0, I experienced a persistent problem. The radar was *too damn
    good*.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: More specifically, it was capturing flight details of aircraft I didnâ€™t have
    a hope of seeing, either far beyond the horizon or hidden behind terrain. This
    became a real pain-point in the terraced archipelago of suburban London.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: This wasnâ€™t just a sensitivity issue, howeverâ€Šâ€”â€Šwhen I went out to a lovely
    open space, I could see planes for miles and miles.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: 'The solution was clear: implement zoom.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: Aviatorâ€™s view over London, default (left) and zoomed inÂ (right)
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: The MapKit SDK has the concept of a `camera` which hovers above the planet,
    showing your map. You can feed it a `distance` (in metres) and it zooms in and
    out of the Earthâ€™s surface based on this.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: I also, in my rush to get a competent release out over the weekend, simply removed
    one of the radar circles to emphasise the zoomed-in UI.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Originally, I had a `Slider` component which handled zoom levels, however even
    my nifty A17 chip couldnâ€™t quite handle this at a reasonable frame-rate. Iâ€™m using
    a binary zoom toggle for now, but might brainstorm alternative ways to handle
    this interface.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: '[The OpenSky Network API](https://openskynetwork.github.io/opensky-api/) gathers
    a wealth of information from aircraft transponders, which I was not taking advantage
    of in 1.0\. These helped feed into many of the new features in 2.0.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: Foremost of these is the ability to toggle flagsâ€Šâ€”â€Šdisplaying the countries
    of origin for each plane, as a simple emoji underneath each icon.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: Toggling origin flags on and off
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: This utilised the `origin_country` property from the OpenSky Network API. This
    gave the plane start point as a straightforward text string. Using a comprehensive
    list of country names found online, I could convert the string into a 2-character
    country code, turn this into unicode scalars, and ultimately construct a flag
    emoji.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: It was then simple to add text to the MapKit annotation when the user toggled
    this feature on.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Another problem I regularly ran into was a consequence of my quant life in sunny
    Britain.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: While Aviator shows you all the planes it can find, many of these are obscured
    by cloud cover on drizzly daysâ€Šâ€”â€Šleaving you squinting into the gloom in a quixotic
    quest for flashing lights.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: To address this, I added another button to hide these higher aircraftâ€Šâ€”â€Štoggling
    between sunny-mode and rainy-mode.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: Note the high-altitude planes on the upper-right quadrant disappearing when
    on cloudÂ mode
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: This was dead simple to implement using data retrieved from OpenSky Network.
    I used 2.5km as a benchmark floor for low cloud cover.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This can then be used to filter out high-up flights from the UI:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: My toddler and I found another teething issue with Aviator when running user
    testing in the park. We sighted a helicopter flying directly overhead, however
    Aviator displayed it as a run-of-the-mill airplane.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: 'Fortunately, the OpenSky Network API has one more piece of data to help us
    out. Weâ€™re able to add a query parameter to get a special `category` property,
    which denotes the type of aircraft to which the transponder belongs. This can
    include:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: Light aircraft (under 15,500 lbs)
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Heavy aircraft (over 300,000 lbs)
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Rotorcraft (i.e. a helicopter)
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Space / Trans-atmospheric vehicle
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Parachutist / Skydiver(!)
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With the latest update, Aviator now differentiates between Aircraft size class;
    and even distinguishes satellites and helicopters as separate icons.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: Perhaps Iâ€™ll display skydivers separately in 3.0, lest my users freak out at
    an aircraft rushing towards theÂ ground
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: I first just needed to make some simple code changes to my `AircraftCategory`
    enum.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Originally, I wanted to use a helicopter emoji however, the ğŸš emoji looked overly
    rotund when converted into a flat colour, so I used a more abstract cross in a
    circle SFSymbol.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: I could then take these and adjust the appearance of the flight annotation view
    which makes up the icons that show up on the radar. It was a little awkward to
    get the emoji to behave like an imageâ€Šâ€”â€ŠI used a scaled `Text` view as a mask
    over a simple `Rectangle` so I could apply the colouring and CRT screen effects.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Iâ€™ve implemented many improvements using data from the OpenSky Network API.
    But what about improvements to the use of the API itself?
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: Possibly my most-requested feature, after an Android version*, is to use oneâ€™s
    own credentials for the API, in the hope of avoiding the same rate-limiting which
    the unauthenticated version uses.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, in the full controls menu, I now allow users to enter their own credentials,
    as well as linking to the registration page.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: '**I am still waiting for an enterprising Android engineer to port it themselvesâ€”Iâ€™ve
    placed enough detail in these posts! Youâ€™re welcome to do so, just make it free
    for everybody.*'
  id: totrans-69
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: OpenSky Network API login, linking to the registration screen on their website.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: This was dead simple to build using the standard SwiftUI `TextField` and `SecureField`.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '*In my excitement to get 2.0 into production, I was a little sloppy, placing
    the password in User Defaults. Iâ€™ll put it on the Keychain in the next release,
    but for now avoid re-using any sensitive passwords for this. Iâ€™ll also fix the
    autocapitalisation.*'
  id: totrans-73
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*åœ¨æ¿€åŠ¨åœ°å°† 2.0 æ¨å‘ç”Ÿäº§æ—¶ï¼Œæˆ‘æœ‰äº›ç²—å¿ƒï¼Œåœ¨ç”¨æˆ·é»˜è®¤è®¾ç½®ä¸­æ”¾ç½®äº†å¯†ç ã€‚æˆ‘å°†åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¸­å°†å…¶æ”¾å…¥é’¥åŒ™ä¸²ä¸­ï¼Œä½†ç°åœ¨è¯·é¿å…é‡å¤ä½¿ç”¨ä»»ä½•æ•æ„Ÿå¯†ç ã€‚æˆ‘ä¹Ÿä¼šä¿®å¤è‡ªåŠ¨å¤§å†™ã€‚*'
- en: Finally, I base-64 encoded these to decorate the API request with HTTP basic
    authentication.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘å°†è¿™äº›è¿›è¡Œäº† base-64 ç¼–ç ï¼Œä»¥è£…é¥° API è¯·æ±‚å¹¶è¿›è¡Œ HTTP åŸºæœ¬èº«ä»½éªŒè¯ã€‚
- en: '[PRE10]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: As always, itâ€™s uniquely gratifying to create something my daughter wants to
    play with. I look forward to her developing many more interestsâ€Šâ€”â€Šwith any luck,
    soon sheâ€™ll get super into platforming games or heavy metal.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€å¦‚æ—¢å¾€ï¼Œèƒ½å¤Ÿåˆ›é€ å‡ºæˆ‘å¥³å„¿æƒ³ç©çš„ä¸œè¥¿æ˜¯éå¸¸ä»¤äººæ»¡è¶³çš„ã€‚æˆ‘æœŸå¾…ç€å¥¹èƒ½åŸ¹å…»å‡ºæ›´å¤šçš„å…´è¶£ - ä¹Ÿè®¸å¾ˆå¿«å¥¹ä¼šå¯¹å¹³å°æ¸¸æˆæˆ–é‡é‡‘å±éŸ³ä¹æ„Ÿå…´è¶£ã€‚
- en: If anyone has any feature ideas, or tips for ASO, please drop a comment. And
    most importantly, download [Aviatorâ€Šâ€”â€ŠRadar on your Phone](https://apps.apple.com/app/aviator-radar-on-your-phone/id6469189335)
    2.0 today (and leave a review, please)!
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæœ‰äººæœ‰ä»»ä½•åŠŸèƒ½æƒ³æ³•æˆ– ASO çš„å»ºè®®ï¼Œè¯·ç•™ä¸‹è¯„è®ºã€‚æœ€é‡è¦çš„æ˜¯ï¼Œä»Šå¤©ç«‹å³ä¸‹è½½[é£è¡Œå‘˜ - ä½ æ‰‹æœºä¸Šçš„é›·è¾¾](https://apps.apple.com/app/aviator-radar-on-your-phone/id6469189335)2.0ç‰ˆï¼ˆå¹¶ç•™ä¸‹è¯„è®ºï¼Œè¯·ï¼‰ï¼
- en: If you enjoyed this series, please consider sharing it with your friends and
    colleagues.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ å–œæ¬¢è¿™ä¸ªç³»åˆ—ï¼Œè¯·è€ƒè™‘ä¸ä½ çš„æœ‹å‹å’ŒåŒäº‹åˆ†äº«ã€‚
- en: '[Share](https://jacobbartlett.substack.com/p/my-toddler-still-loves-planes-so?utm_source=substack&utm_medium=email&utm_content=share&action=share)'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '[åˆ†äº«](https://jacobbartlett.substack.com/p/my-toddler-still-loves-planes-so?utm_source=substack&utm_medium=email&utm_content=share&action=share)'
