- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-27 14:25:25'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: '[New date] We are going to start charging for dedicated IPv4 in ~~January 1st~~
    starting February 1st - Fresh Produce - Fly.io'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://community.fly.io/t/we-are-going-to-start-charging-for-dedicated-ipv4-in-january-1st/15970](https://community.fly.io/t/we-are-going-to-start-charging-for-dedicated-ipv4-in-january-1st/15970)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: If you’re a long-time [Fly.io](http://fly.io/) customer you will notice we first
    ship stuff and, later on, we add billing to it. Our pricing page has been for
    a while we charge ~$2 per dedicated IPv4 per month but we never actually did!
  prefs: []
  type: TYPE_NORMAL
- en: 'Dedicated IPv4 is a scarce resource but fortunately last December we had [Announcement:
    Shared Anycast IPv4](https://community.fly.io/t/announcement-shared-anycast-ipv4/9384)
    and that bought us a ton of time until this was an issue and **shared IPv4s are
    free**!'
  prefs: []
  type: TYPE_NORMAL
- en: We promise we would give a good heads up before we charged you and that’s here,
    **we will only start billing in ~~January 1st~~ February 1st**!
  prefs: []
  type: TYPE_NORMAL
- en: Do I need to do something for future apps?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: New apps have been getting shared IPv4 when first deployed for a while, your
    new apps should be good to go with no unexpected charges. Also, just creating
    an app doesn’t assign IPs immediately.
  prefs: []
  type: TYPE_NORMAL
- en: How NOT to be billed?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: I’m glad you asked. All you need to do is remove your dedicated IPv4 and add
    a shared IPv4\. That takes roughly two commands per app (assuming you only have
    one dedicated IPv4 per app).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**If you have certificates** make sure to update your DNS records! Currently
    you can only have either a shared or dedicated IPv4 so make sure to have a dedicated
    IPv6 as a fallback.'
  prefs: []
  type: TYPE_NORMAL
- en: '**If you you’re using a custom domain** make sure to issue certificates for
    your shared IP to work properly like this: [New Shared IPv4 Connection Reset by
    peer - #2 by pavel](https://community.fly.io/t/new-shared-ipv4-connection-reset-by-peer/17567/2)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Originally from Jerome’s post:](https://community.fly.io/t/we-are-going-to-start-charging-for-dedicated-ipv4-in-january-1st/15970/24)
    We now allow having both a shared IPv4 and dedicated IPv4\. This change should
    make it possible to **switch to a shared IPv4 without downtime**.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The produce looks like this:'
  prefs: []
  type: TYPE_NORMAL
- en: Add shared ipv4 via `flyctl ips allocate-v4 --shared`
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '(Optional: add the shared ipv4 as an A record for your hostname if you don’t
    use a CNAME to .fly.dev)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Confirm your app works via shared IP: `curl -Iv http://<your-hostname> --resolve
    <your-hostname>:80:<shared ipv4 you got>` (should respond with a 301 redirect)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wait for DNS caches to clear… probably 5 minutes but that varies wildly, this
    should be the biggest value between your DNS record’s TTL and our `<your-app>.fly.dev`
    record (300 I believe).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Remove the dedicated IPv4 from Fly (and optionally remove from your DNS if you
    set it manually as an A record)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How do I know which apps have dedicated IPv4?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We shipped a new improvement to our [IP usage page](https://fly.io/dashboard/lubien/usage/ip)
    to show which apps have how dedicated IPs. It will show both dedicated IPv6 (which
    are free) and dedicated IPv4 (the ones that will eventually charge you).
  prefs: []
  type: TYPE_NORMAL
- en: Can I preview how much this would charge me?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We also shipped a preview in your [invoice page](https://fly.io/dashboard/personal/billing)
    that tells you how much dedicated IPv4 usage you have so far in the current month.
    **These will not be added to your invoice** right now but by ~~January 1st~~ Feburary
    1st they will be added for Marchs’s invoice. That means yes, you had free dedicated
    IPV4 usage from January 2022 until the end of ~~November 2023~~ January 2023 and
    we will not charge those.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Let us know if there’s any other questions, we’d love to hear them!
  prefs: []
  type: TYPE_NORMAL
