<!--yml

类别：未分类

日期：2024 年 05 月 27 日 14:37:41

-->

# OpenDev：自由软件需要自由工具

> 来源：[`opendev.org/`](https://opendev.org/)

## 什么是 OpenDev？

OpenDev 是一个面向规模的开源软件开发协作平台。其重点是通过 Git、Gerrit、Zuul 和 Gitea 等开源解决方案提供的代码审查、持续集成和项目托管。它还提供了许多外围协作服务（如 Mailman 邮件列表、用于通知和注释基于文本的会议的 IRC 机器人、集成了 Etherpad 用于集体文本编辑的 Jitsi-Meet 视频会议讨论等）。所有这些服务都由社区公开运营，并使用 OpenDev 本身进行持续集成和部署。

## 与 OpenDev 一起开发有何不同

OpenDev 不使用拉取请求（或合并请求）工作流，而是遵循 Gerrit 的迭代更改提议工作流，这使得体验略有不同。

在 GitHub 或 Gitlab 中，贡献通常通过复刻原始存储库的个人副本开始，将其克隆到本地，然后将一个或多个提交推送到该个人副本。一旦你的代码准备好合并，你就可以要求服务在原始存储库中为你的分支创建一个拉取请求。拉取请求将被审核，如果被接受，你的更改将被合并到原始存储库中。如果不被接受，你可以将更多的提交推送到你的副本中，并更新请求以获得更多审查。

相比之下，与 Gerrit 一起贡献是通过在本地克隆原始存储库开始的。你迭代开发一个或多个本地提交，然后使用 git push（或 git-review 工具）将你的提交作为一系列更改提议给 Gerrit 代码审查服务。系列中的每个更改都将进行审查，如果被接受（并通过测试），则将其合并到原始存储库中。如果需要更多的工作，你可以修改相同的提交，并推送它们的新版本进行重新审查。

差异微妙但重要。在拉取请求模型中，你创建一个原始存储库的副本，对其进行更改，最终提出将更改合并回来。在更改提议模型中，你准备一项更改，并提出它。你不创建一个完整的副本，每个人都在同一个原始存储库中为基本上是轻量级的、短暂的主题分支做出贡献。这导致了较少的整体碎片化，并避免了原始存储库及其众多分支之间的混淆。

这种高层次的差异也影响了更低层次的细节。一个拉取请求可能包含多个提交，如果合并了所有这些提交，那么所有这些提交将出现在原始仓库的历史记录中。在 Gerrit 中，每个提交都是一个单独的更改（可选地依赖于其他相关更改），供代码审阅人员审查，因此开发人员会压缩或修改在开发过程中进行的编辑，以代表该更改的期望最终状态。每个更改的先前修订版仍然由服务保留，以及所有审阅意见，因此可以将更新进行比较，以清晰地了解更改的演变过程。这通常会导致更容易的代码审查，但也会产生一个更清晰的分支历史，其中的提交消息被审查为每个更改的整体部分。

总之，Gerrit 工作流程，其用户体验和 UI 与拉取请求工作流不同。虽然对于习惯于拉取请求工作流的开发人员来说可能不是立即熟悉的，但它值得学习。长期利益超过了学习新工具的短期成本，尤其是对于那些打算花费大量时间为该项目开发的人来说。

## 集成的持续集成

OpenDev 的一个关键好处是它集成了强大的持续集成功能，这得益于我们慷慨的基础设施合作伙伴捐赠的计算资源。当提出更改时，会运行测试作业，并为代码审阅人员提供有价值的信息。测试作业还会在合并时再次运行，以防最近批准的更改引入不兼容性，防止未通过测试的代码合并到仓库中。

高级的 Zuul 功能，比如测试的推测执行，允许并行测试序列化的更改，因此开发速度很少受到测试 thoroughness 的限制。一个 Git 仓库的更改可以依赖于另一个仓库中提议的更改，允许跨多个项目积极开发的功能进行集成测试，消除了开发团队之间的人为障碍。

这个高级的持续集成系统是为了支持 OpenStack 开发的复杂性和规模而开发的，这是全球三个最活跃的开源项目之一。OpenDev 使这个系统对其他项目可用，为所有人提供了规模化的开放式开发。

最后，OpenDev 与 GitHub 或 Gitlab.com 等其他开发基础设施服务之间的另一个关键区别是，它纯粹是使用开源软件构建的。GitHub 和 Gitlab.com 为开源项目免费提供，但它们都是使用专有代码实现的。如果您的自由和开源软件的开发需要与专有代码交互，那么它真的是自由的（作为自由）吗？

如今普遍认为，使用开源技术可以减少你对外部方的依赖，促进创新。显然，通过使用开源工具链开发软件具有相同的效果。没有什么能阻止服务提供商更改其服务条款、创建新的限制、阻止来自特定国家的贡献者的访问，甚至完全删除你的项目。专有开发服务造成的是与专有软件相同形式的严格限制、锁定和依赖，阻碍了开放式基础设施领域的开放式创新。

OpenDev 完全使用开源软件构建，但它还走了一步：它也是公开运营的。即使是其操作工具和配置也是开源的，存储在 Git 中，并且是持续部署的。它作为系统管理透明协作的明显例子。就像自由开源软件一样，它需要与其社区互动，以充分利用它 -- OpenDev 不是一个你消费的服务，而是一个你加入的社区。如果你只想专注于开发，尤其是当现成的可消费服务可用时，这可能会有点压力。但这是值得的，尤其是如果你想对所提供的服务发表意见，或者只是支持改进该领域的开源工具的想法。
