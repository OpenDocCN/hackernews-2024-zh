- en: <!--yml
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: æœªåˆ†ç±»'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ†ç±»ï¼šæœªåˆ†ç±»
- en: 'date: 2024-05-27 14:46:23'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: æ—¥æœŸï¼š2024-05-27 14:46:23
- en: -->
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: Crystal 1.11.0 is released! - The Crystal Programming Language
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Crystal 1.11.0 å‘å¸ƒäº†ï¼- Crystal ç¼–ç¨‹è¯­è¨€
- en: æ¥æºï¼š[https://crystal-lang.org/2024/01/08/1.11.0-released/](https://crystal-lang.org/2024/01/08/1.11.0-released/)
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ¥æºï¼š[https://crystal-lang.org/2024/01/08/1.11.0-released/](https://crystal-lang.org/2024/01/08/1.11.0-released/)
- en: We are announcing a new Crystal release with several new features and bug fixes.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®£å¸ƒä¸€ä¸ªæ–°çš„ Crystal å‘å¸ƒï¼Œå…¶ä¸­åŒ…å«å‡ ä¸ªæ–°åŠŸèƒ½å’Œé”™è¯¯ä¿®å¤ã€‚
- en: Pre-built packages are available on [GitHub Releases](https://github.com/crystal-lang/crystal/releases/tag/1.11.0)
    and our official distribution channels. See [crystal-lang.org/install](https://crystal-lang.org/install/)
    for installation instructions.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æ„å»ºçš„è½¯ä»¶åŒ…å¯åœ¨ [GitHub å‘å¸ƒé¡µé¢](https://github.com/crystal-lang/crystal/releases/tag/1.11.0)
    å’Œæˆ‘ä»¬çš„å®˜æ–¹å‘è¡Œæ¸ é“ä¸Šè·å–ã€‚è¯·å‚é˜… [crystal-lang.org/install](https://crystal-lang.org/install/)
    è·å–å®‰è£…è¯´æ˜ã€‚
- en: Stats
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç»Ÿè®¡ä¿¡æ¯
- en: This release includes [178 changes since 1.10.1](https://github.com/crystal-lang/crystal/pulls?q=is%3Apr+milestone%3A1.11.0)
    by 28 contributors. We thank all the contributors for all the effort put into
    improving the language! â¤ï¸
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ¬¡å‘å¸ƒåŒ…å«è‡ª 1.10.1 ç‰ˆä»¥æ¥çš„ [178 ä¸ªæ›´æ”¹](https://github.com/crystal-lang/crystal/pulls?q=is%3Apr+milestone%3A1.11.0)ï¼Œç”±
    28 ä½è´¡çŒ®è€…è´¡çŒ®ã€‚æˆ‘ä»¬æ„Ÿè°¢æ‰€æœ‰ä¸ºæ”¹è¿›è¯­è¨€è€Œä»˜å‡ºåŠªåŠ›çš„è´¡çŒ®è€…ï¼â¤ï¸
- en: Changes
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ›´æ”¹
- en: Below we list the most remarkable changes in the language, compiler and stdlib.
    This is a pretty big release with lots of things going on, so hold tight ğŸš€
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢æˆ‘ä»¬åˆ—å‡ºäº†è¯­è¨€ã€ç¼–è¯‘å™¨å’Œæ ‡å‡†åº“ä¸­æœ€æ˜¾ç€çš„æ›´æ”¹ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å‘å¸ƒç‰ˆæœ¬ï¼Œæœ‰å¾ˆå¤šäº‹æƒ…æ­£åœ¨å‘ç”Ÿï¼Œæ‰€ä»¥è¯·ç´§ç´§æŠ“ä½ ğŸš€
- en: For details, visit the [full changelog](https://github.com/crystal-lang/crystal/releases/tag/1.11.0).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® [å®Œæ•´æ›´æ–°æ—¥å¿—](https://github.com/crystal-lang/crystal/releases/tag/1.11.0)ã€‚
- en: LLVM 18
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: LLVM 18
- en: One of the biggest steps forward is support for upcoming LLVM 18 which allows
    linking LLVM dynamically on Windows ([#14101](https://github.com/crystal-lang/crystal/pull/14101)).
    Additionally, LLVM 18 now provides everything we need in the upstream C API, removing
    the need for our wrapper extension `llvm_ext`. Itâ€™s still necessary for older
    LLVM versions, so weâ€™ll keep it around for a while. But the future tool chain
    is getting simplified. Read more in [#13946](https://github.com/crystal-lang/crystal/issues/13946).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€é‡è¦çš„è¿›æ­¥ä¹‹ä¸€æ˜¯å¯¹å³å°†å‘å¸ƒçš„ LLVM 18 çš„æ”¯æŒï¼Œè¿™ä½¿å¾—åœ¨ Windows ä¸ŠåŠ¨æ€é“¾æ¥ LLVM æˆä¸ºå¯èƒ½ï¼ˆ[#14101](https://github.com/crystal-lang/crystal/pull/14101)ï¼‰ã€‚æ­¤å¤–ï¼ŒLLVM
    18 ç°åœ¨æä¾›äº†æˆ‘ä»¬åœ¨ä¸Šæ¸¸ C API ä¸­æ‰€éœ€çš„ä¸€åˆ‡ï¼Œæ¶ˆé™¤äº†æˆ‘ä»¬å¯¹åŒ…è£…æ‰©å±• `llvm_ext` çš„éœ€è¦ã€‚å¯¹äºè¾ƒæ—§çš„ LLVM ç‰ˆæœ¬ï¼Œä»ç„¶æ˜¯å¿…éœ€çš„ï¼Œå› æ­¤æˆ‘ä»¬å°†ç»§ç»­ä¿ç•™å®ƒä¸€æ®µæ—¶é—´ã€‚ä½†æœªæ¥çš„å·¥å…·é“¾æ­£åœ¨å˜å¾—ç®€åŒ–ã€‚åœ¨
    [#13946](https://github.com/crystal-lang/crystal/issues/13946) ä¸­é˜…è¯»æ›´å¤šå†…å®¹ã€‚
- en: '*Thanks [@HertzDevil](https://github.com/HertzDevil)*'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@HertzDevil](https://github.com/HertzDevil)*'
- en: Compiler Optimization Levels
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ç¼–è¯‘å™¨ä¼˜åŒ–çº§åˆ«
- en: 'The compiler gains four distinct optimization levels:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼–è¯‘å™¨è·å¾—äº†å››ä¸ªä¸åŒçš„ä¼˜åŒ–çº§åˆ«ï¼š
- en: '`-O0`: No optimization'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-O0`ï¼šæ— ä¼˜åŒ–'
- en: '`-O1`: Low optimization'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-O1`ï¼šä½ä¼˜åŒ–'
- en: '`-O2`: Middle optimization'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-O2`ï¼šä¸­ç­‰ä¼˜åŒ–'
- en: '`-O3`: High optimization'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-O3`ï¼šé«˜åº¦ä¼˜åŒ–'
- en: Each level activates the respective LLVM `RunPasses` and `CodeGenOptLevel` optimizations.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯ä¸ªçº§åˆ«æ¿€æ´»ç›¸åº”çš„ LLVM `RunPasses` å’Œ `CodeGenOptLevel` ä¼˜åŒ–ã€‚
- en: '`-O3` corresponds to the existing release mode and `-O0` corresponds to the
    default non-release mode. `-O0` remains the default and `--release` is equivalent
    to `-O3 --single-module`.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '`-O3` å¯¹åº”äºç°æœ‰çš„å‘å¸ƒæ¨¡å¼ï¼Œ`-O0` å¯¹åº”äºé»˜è®¤çš„éå‘å¸ƒæ¨¡å¼ã€‚`-O0` ä¿æŒé»˜è®¤ï¼Œ`--release` ç­‰æ•ˆäº `-O3 --single-module`ã€‚'
- en: Effectively, this introduces two optimization choices between the previous full
    or nothing. And itâ€™s now possible to use high optimization without `--single-module`.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: å®é™…ä¸Šï¼Œè¿™å¼•å…¥äº†ä¸¤ä¸ªä¼˜åŒ–é€‰æ‹©ï¼Œä»‹äºä¹‹å‰çš„å®Œå…¨æˆ–æ— ä»»ä½•ä¼˜åŒ–ä¹‹é—´ã€‚ç°åœ¨å¯ä»¥åœ¨æ²¡æœ‰ `--single-module` çš„æƒ…å†µä¸‹ä½¿ç”¨é«˜åº¦ä¼˜åŒ–ã€‚
- en: Read more in [#13464](https://github.com/crystal-lang/crystal/pull/13464).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ [#13464](https://github.com/crystal-lang/crystal/pull/13464) ä¸­é˜…è¯»æ›´å¤šå†…å®¹ã€‚
- en: '*Thanks [@kostya](https://github.com/kostya)*'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@kostya](https://github.com/kostya)*'
- en: Alignment primitives
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¯¹é½åŸè¯­
- en: 'The language has two new reflection primitives: [`alignof`](https://crystal-lang.org/reference/1.11/syntax_and_semantics/alignof.html)
    and [`instance_alignof`](https://crystal-lang.org/reference/1.11/syntax_and_semantics/instance_alignof.html)
    return a typeâ€™s memory alignment ([#14087](https://github.com/crystal-lang/crystal/pull/14087)).
    This allows implementing type-aware allocators in native Crystal with properly
    aligned pointers. They are siblings of `sizeof` and `instance_sizeof` and can
    be used in the same way.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¥è¯­è¨€æœ‰ä¸¤ä¸ªæ–°çš„åå°„åŸè¯­ï¼š[`alignof`](https://crystal-lang.org/reference/1.11/syntax_and_semantics/alignof.html)
    å’Œ [`instance_alignof`](https://crystal-lang.org/reference/1.11/syntax_and_semantics/instance_alignof.html)
    è¿”å›ç±»å‹çš„å†…å­˜å¯¹é½æ–¹å¼ï¼ˆ[#14087](https://github.com/crystal-lang/crystal/pull/14087)ï¼‰ã€‚è¿™ä½¿å¾—åœ¨æœ¬æœº
    Crystal ä¸­å®ç°ç±»å‹æ„ŸçŸ¥çš„åˆ†é…å™¨æˆä¸ºå¯èƒ½ï¼Œä½¿ç”¨æ­£ç¡®å¯¹é½çš„æŒ‡é’ˆã€‚å®ƒä»¬ä¸ `sizeof` å’Œ `instance_sizeof` æ˜¯åŒçº§çš„ï¼Œå¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼ä½¿ç”¨ã€‚
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Effect on existing code
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹ç°æœ‰ä»£ç çš„å½±å“
- en: The introduction of these primitives makes it impossible to define methods of
    the same names. So `def alignof` or `def instance_alignof` are now invalid syntax.
    We donâ€™t expect there to be a big impact in practice.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: å¼•å…¥è¿™äº›åŸè¯­ä½¿å¾—æ— æ³•å®šä¹‰åŒåçš„æ–¹æ³•ã€‚æ‰€ä»¥`def alignof`æˆ–`def instance_alignof`ç°åœ¨æ˜¯æ— æ•ˆè¯­æ³•ã€‚æˆ‘ä»¬ä¸è®¤ä¸ºè¿™ä¼šåœ¨å®è·µä¸­äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚
- en: '*Thanks [@HertzDevil](https://github.com/HertzDevil)*'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢[@HertzDevil](https://github.com/HertzDevil)*'
- en: '`dll` parameter in `Link` annotation'
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Link`æ³¨è§£ä¸­çš„`dll`å‚æ•°'
- en: The [`Link`](https://crystal-lang.org/api/1.11.0/Link.html) annotation has a
    new parameter `dll` for specifying dynamic link libraries on Windows ([#14131](https://github.com/crystal-lang/crystal/pull/14131)).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '[`Link`](https://crystal-lang.org/api/1.11.0/Link.html)æ³¨è§£æœ‰ä¸€ä¸ªæ–°å‚æ•°`dll`ï¼Œç”¨äºåœ¨Windowsä¸ŠæŒ‡å®šåŠ¨æ€é“¾æ¥åº“
    ([#14131](https://github.com/crystal-lang/crystal/pull/14131)).'
- en: '[PRE1]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '*Thanks [@HertzDevil](https://github.com/HertzDevil)*'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢[@HertzDevil](https://github.com/HertzDevil)*'
- en: Macro `@caller` context
  id: totrans-37
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å®`@caller`ä¸Šä¸‹æ–‡
- en: Macros now have a reference to their calling context via the special instance
    variable [`@caller`](https://crystal-lang.org/reference/1.11/syntax_and_semantics/macros/index.html#call-information)
    ([#14055](https://github.com/crystal-lang/crystal/issues/14055)).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å®é€šè¿‡ç‰¹æ®Šå®ä¾‹å˜é‡[`@caller`](https://crystal-lang.org/reference/1.11/syntax_and_semantics/macros/index.html#call-information)å¼•ç”¨å…¶è°ƒç”¨ä¸Šä¸‹æ–‡
    ([#14055](https://github.com/crystal-lang/crystal/issues/14055)).
- en: '[PRE2]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '*Thanks [@Blacksmoke16](https://github.com/Blacksmoke16)*'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢[@Blacksmoke16](https://github.com/Blacksmoke16)*'
- en: New collection methods
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ–°çš„é›†åˆæ–¹æ³•
- en: '[`Enumerable#present?`](https://crystal-lang.org/api/1.11.0/Enumerable.html#present?:Bool-instance-method)
    is a direct inversion of `#empty?` avoiding some quirks with the similar, but
    not-quite, `#any?` ([#13847](https://github.com/crystal-lang/crystal/issues/13847)).'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '[`Enumerable#present?`](https://crystal-lang.org/api/1.11.0/Enumerable.html#present?:Bool-instance-method)
    æ˜¯`#empty?`çš„ç›´æ¥åè½¬ï¼Œé¿å…äº†ä¸ç›¸ä¼¼ä½†ä¸å®Œå…¨ç›¸åŒçš„`#any?`çš„ä¸€äº›æ€ªç™– ([#13847](https://github.com/crystal-lang/crystal/issues/13847)).'
- en: '*Thanks [@straight-shoota](https://github.com/straight-shoota)*'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢[@straight-shoota](https://github.com/straight-shoota)*'
- en: '[`Enumerable#each_step`](https://crystal-lang.org/api/1.11.0/Enumerable.html#each_step(n:Int,*,offset:Int=0,&:T-%3E):Nil-instance-method)
    and [`Iterable#each_step`](https://crystal-lang.org/api/1.11.0/Iterable.html#each_step(n:Int)-instance-method)
    are direct methods for creating step iterators ([#13610](https://github.com/crystal-lang/crystal/pull/13610)).'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '[`Enumerable#each_step`](https://crystal-lang.org/api/1.11.0/Enumerable.html#each_step(n:Int,*,offset:Int=0,&:T-%3E):Nil-instance-method)
    å’Œ [`Iterable#each_step`](https://crystal-lang.org/api/1.11.0/Iterable.html#each_step(n:Int)-instance-method)
    æ˜¯åˆ›å»ºæ­¥è¿›è¿­ä»£å™¨çš„ç›´æ¥æ–¹æ³• ([#13610](https://github.com/crystal-lang/crystal/pull/13610)).'
- en: '*Thanks [@baseballlover723](https://github.com/baseballlover723)*'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢[@baseballlover723](https://github.com/baseballlover723)*'
- en: '[`Enumerable(T)#to_set(& : T -> U) : Set(U) forall U`](https://crystal-lang.org/api/1.11.0/Enumerable.html#to_set(&block:T-%3EU):Set(U)forallU-instance-method)
    and [`#to_a(& : T -> U) forall U`](https://crystal-lang.org/api/1.11.0/Enumerable.html#to_a%28%26%3AT-%3EU%29%3AArray%28U%29forallU-instance-method)
    allow materialising an `Enumerable` into a pre-defined collection, which gives
    more flexibility than the standard `#to_set` and `#to_a` methods ([#12654](https://github.com/crystal-lang/crystal/pull/12654),
    [#12653](https://github.com/crystal-lang/crystal/pull/12653)).'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '[`Enumerable(T)#to_set(& : T -> U) : Set(U) forall U`](https://crystal-lang.org/api/1.11.0/Enumerable.html#to_set(&block:T-%3EU):Set(U)forallU-instance-method)
    å’Œ [`#to_a(& : T -> U) forall U`](https://crystal-lang.org/api/1.11.0/Enumerable.html#to_a%28%26%3AT-%3EU%29%3AArray%28U%29forallU-instance-method)
    å…è®¸å°†`Enumerable`è½¬æ¢ä¸ºé¢„å®šä¹‰é›†åˆï¼Œæ¯”æ ‡å‡†çš„`#to_set`å’Œ`#to_a`æ–¹æ³•æ›´çµæ´» ([#12654](https://github.com/crystal-lang/crystal/pull/12654),
    [#12653](https://github.com/crystal-lang/crystal/pull/12653)).'
- en: '*Thanks [@caspiano](https://github.com/caspiano)*'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢[@caspiano](https://github.com/caspiano)*'
- en: Numeric enhancements
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ•°å­—å¢å¼º
- en: '[`BigFloat#**`](https://crystal-lang.org/api/1.11.0/BigFloat.html#%2A%2A%28other%3ABigInt%29%3ABigFloat-instance-method)
    now works for all `Int::Primitive` arguments and supports the full exponent range
    for `BitInt` arguments ([#13971](https://github.com/crystal-lang/crystal/pull/13971),
    [#13881](https://github.com/crystal-lang/crystal/pull/13881))'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '[`BigFloat#**`](https://crystal-lang.org/api/1.11.0/BigFloat.html#%2A%2A%28other%3ABigInt%29%3ABigFloat-instance-method)
    ç°åœ¨é€‚ç”¨äºæ‰€æœ‰`Int::Primitive`å‚æ•°ï¼Œå¹¶æ”¯æŒ`BitInt`å‚æ•°çš„å®Œæ•´æŒ‡æ•°èŒƒå›´ ([#13971](https://github.com/crystal-lang/crystal/pull/13971),
    [#13881](https://github.com/crystal-lang/crystal/pull/13881))'
- en: Floating point to string conversion in `printf` uses the Ryu algorithm ([#8441](https://github.com/crystal-lang/crystal/issues/8441)).
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '`printf`ä¸­çš„æµ®ç‚¹åˆ°å­—ç¬¦ä¸²è½¬æ¢ä½¿ç”¨äº†Ryuç®—æ³• ([#8441](https://github.com/crystal-lang/crystal/issues/8441)).'
- en: New methods [`Float::Primitive.to_hexfloat`](https://crystal-lang.org/api/1.11.0/Float64.html#to_hexfloat:String-instance-method),
    [`.parse_hexfloat`](https://crystal-lang.org/api/1.11.0/Float64.html#parse_hexfloat(str:String):self-class-method),
    and [`.parse_hexfloat?`](https://crystal-lang.org/api/1.11.0/Float64.html#parse_hexfloat(str:String):self-class-method)
    allow conversion to and from the hexfloat format ([#14027](https://github.com/crystal-lang/crystal/pull/14027)).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: æ–°æ–¹æ³• [`Float::Primitive.to_hexfloat`](https://crystal-lang.org/api/1.11.0/Float64.html#to_hexfloat:String-instance-method)ã€[`.parse_hexfloat`](https://crystal-lang.org/api/1.11.0/Float64.html#parse_hexfloat(str:String):self-class-method)
    å’Œ [`.parse_hexfloat?`](https://crystal-lang.org/api/1.11.0/Float64.html#parse_hexfloat(str:String):self-class-method)
    å…è®¸åœ¨åå…­è¿›åˆ¶æµ®ç‚¹æ ¼å¼ä¹‹é—´è¿›è¡Œè½¬æ¢ ([#14027](https://github.com/crystal-lang/crystal/pull/14027))ã€‚
- en: 'More math features:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: æ›´å¤šæ•°å­¦ç‰¹æ€§ï¼š
- en: '*Thanks [@HertzDevil](https://github.com/HertzDevil)*'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@HertzDevil](https://github.com/HertzDevil)*'
- en: Enhancements for `crystal spec`
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`crystal spec` çš„å¢å¼º'
- en: '`crystal spec` gets two new commands for introspection:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '`crystal spec` è·å–äº†ä¸¤ä¸ªç”¨äºå†…çœçš„æ–°å‘½ä»¤ï¼š'
- en: '`crystal spec --dry-run` prints all active specs without actually executing
    any spec code ([#13804](https://github.com/crystal-lang/crystal/pull/13804)).'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '`crystal spec --dry-run` æ‰“å°å‡ºæ‰€æœ‰æ´»åŠ¨çš„è§„èŒƒï¼Œè€Œä¸å®é™…æ‰§è¡Œä»»ä½•è§„èŒƒä»£ç  ([#13804](https://github.com/crystal-lang/crystal/pull/13804))ã€‚'
- en: '*Thanks [@nobodywasishere](https://github.com/nobodywasishere)*'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@nobodywasishere](https://github.com/nobodywasishere)*'
- en: '`crystal spec --list-tags` lists all tags defined in the spec suite ([#13616](https://github.com/crystal-lang/crystal/pull/13616)).'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '`crystal spec --list-tags` åˆ—å‡ºäº†è§„èŒƒå¥—ä»¶ä¸­å®šä¹‰çš„æ‰€æœ‰æ ‡ç­¾ ([#13616](https://github.com/crystal-lang/crystal/pull/13616))ã€‚'
- en: '*Thanks [@baseballlover723](https://github.com/baseballlover723)*'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@baseballlover723](https://github.com/baseballlover723)*'
- en: The basic implementation of `crystal tool unreachable` from Crystal 1.10 gets
    some useful enhancements.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '`Crystal 1.10` ä¸­ `crystal tool unreachable` çš„åŸºæœ¬å®ç°å¾—åˆ°äº†ä¸€äº›æœ‰ç”¨çš„å¢å¼ºã€‚'
- en: The `--tallies` option prints all methods and the total number of calls. Those
    with a zero tally are unreachable ([#13969](https://github.com/crystal-lang/crystal/pull/13969)).
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--tallies` é€‰é¡¹æ‰“å°å‡ºæ‰€æœ‰æ–¹æ³•åŠå…¶è°ƒç”¨æ€»æ•°ã€‚é‚£äº›è®¡æ•°ä¸ºé›¶çš„æ–¹æ³•æ˜¯æ— æ³•è®¿é—®çš„ ([#13969](https://github.com/crystal-lang/crystal/pull/13969))ã€‚'
- en: The `--check` flag exits with a failure status if there is any unreachable code
    ([#13930](https://github.com/crystal-lang/crystal/pull/13930)).
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`--check` æ ‡å¿—å¦‚æœå­˜åœ¨ä»»ä½•æ— æ³•è®¿é—®çš„ä»£ç ï¼Œåˆ™ä»¥å¤±è´¥çŠ¶æ€é€€å‡º ([#13930](https://github.com/crystal-lang/crystal/pull/13930))ã€‚'
- en: Annotations show up in the output ([#13927](https://github.com/crystal-lang/crystal/pull/13927)).
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ³¨é‡Šæ˜¾ç¤ºåœ¨è¾“å‡ºä¸­ ([#13927](https://github.com/crystal-lang/crystal/pull/13927))ã€‚
- en: 'New output format: CSV ([#13926](https://github.com/crystal-lang/crystal/pull/13926)).'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ–°çš„è¾“å‡ºæ ¼å¼ï¼šCSV ([#13926](https://github.com/crystal-lang/crystal/pull/13926))ã€‚
- en: Paths in the output are relativized, making it more succinct ([#13929](https://github.com/crystal-lang/crystal/pull/13929)).
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¾“å‡ºä¸­çš„è·¯å¾„è¢«ç›¸å¯¹åŒ–ï¼Œä½¿å…¶æ›´åŠ ç®€æ´ ([#13929](https://github.com/crystal-lang/crystal/pull/13929))ã€‚
- en: '*Thanks [@straight-shoota](https://github.com/straight-shoota)*'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@straight-shoota](https://github.com/straight-shoota)*'
- en: Inherited macros in API docs
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: API æ–‡æ¡£ä¸­çš„ç»§æ‰¿å®
- en: Inherited macros are now exposed in the API docs. They had previously been hidden,
    in contrast to inherited defs ([#13810](https://github.com/crystal-lang/crystal/pull/13810)).
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ç»§æ‰¿çš„å®ç°åœ¨åœ¨ API æ–‡æ¡£ä¸­æš´éœ²å‡ºæ¥äº†ã€‚å®ƒä»¬ä»¥å‰æ˜¯éšè—çš„ï¼Œä¸ç»§æ‰¿çš„å®šä¹‰ç›¸å ([#13810](https://github.com/crystal-lang/crystal/pull/13810))ã€‚
- en: '*Thanks [@Blacksmoke16](https://github.com/Blacksmoke16)*'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '*æ„Ÿè°¢ [@Blacksmoke16](https://github.com/Blacksmoke16)*'
- en: Text
  id: totrans-70
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ–‡æœ¬
- en: Misc
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å…¶ä»–
- en: The capacity of `String::Buffer` and `IO::Memory` was unintentionally limited
    to 1GB. They now support the full range up to `Int32::MAX`, i.e. 2GB ([#13989](https://github.com/crystal-lang/crystal/pull/13989)).
    *Thanks [@straight-shoota](https://github.com/straight-shoota)*
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String::Buffer` å’Œ `IO::Memory` çš„å®¹é‡æ— æ„é—´è¢«é™åˆ¶ä¸º 1GBã€‚å®ƒä»¬ç°åœ¨æ”¯æŒå®Œæ•´èŒƒå›´ï¼Œæœ€å¤šå¯è¾¾åˆ° `Int32::MAX`ï¼Œå³
    2GB ([#13989](https://github.com/crystal-lang/crystal/pull/13989))ã€‚ *æ„Ÿè°¢ [@straight-shoota](https://github.com/straight-shoota)*'
- en: There was a nasty bug in `Number#format` which could mess with the integral
    part. It is now fixed in [#14061](https://github.com/crystal-lang/crystal/pull/14061).
    *Thanks [@HertzDevil](https://github.com/HertzDevil)*
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Number#format` ä¸­æœ‰ä¸€ä¸ªè®¨åŒçš„ bug å¯èƒ½ä¼šå½±å“æ•´æ•°éƒ¨åˆ†ã€‚ç°åœ¨åœ¨ [#14061](https://github.com/crystal-lang/crystal/pull/14061)
    ä¸­å·²ç»ä¿®å¤äº†ã€‚ *æ„Ÿè°¢ [@HertzDevil](https://github.com/HertzDevil)*'
- en: Vendored shards `markd` and `reply` are no longer referenced by paths relative
    to the compiler source tree. This means they can be local dependencies (i.e. in
    `lib`) when using the compiler as a library ([#13992](https://github.com/crystal-lang/crystal/pull/13992)).
    *Thanks [@nobodywasishere](https://github.com/nobodywasishere)*
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vendored shards `markd` å’Œ `reply` ä¸å†é€šè¿‡ç›¸å¯¹äºç¼–è¯‘å™¨æºæ ‘çš„è·¯å¾„å¼•ç”¨ã€‚è¿™æ„å‘³ç€å½“å°†ç¼–è¯‘å™¨ä½œä¸ºåº“ä½¿ç”¨æ—¶ï¼Œå®ƒä»¬å¯ä»¥æ˜¯æœ¬åœ°ä¾èµ–é¡¹ï¼ˆå³åœ¨
    `lib` ä¸­ï¼‰ ([#13992](https://github.com/crystal-lang/crystal/pull/13992))ã€‚ *æ„Ÿè°¢ [@nobodywasishere](https://github.com/nobodywasishere)*
- en: 'There are two new constants which provide information on the compiler host
    and target: `Crystal::HOST_TRIPLE` and `TARGET_TRIPLE` ([#13823](https://github.com/crystal-lang/crystal/pull/13823)).
    *Thanks [@HertzDevil](https://github.com/HertzDevil)*'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Shards 0.17.4
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The bundled shards release was updated to [0.17.4](https://github.com/crystal-lang/shards/releases/tag/v0.17.4)
    which brings a couple minor bugfixes. ([#14133](https://github.com/crystal-lang/crystal/pull/14133)).
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: '*Thanks [@straight-shoota](https://github.com/straight-shoota)*'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: 'Experimental: `ReferenceStorage` and `.pre_initialize`'
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Weâ€™ve started an effort to make it easier to use custom allocation mechanisms
    in Crystal and decouple allocation from initialization. The main tool is [`Reference.pre_initialize`](https://crystal-lang.org/api/1.11.0/Reference.html#pre_initialize(address:Pointer)-class-method)
    which performs the rudimentary object initialization, before actually calling
    `#initialize`.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: '[`Reference.unsafe_construct`](https://crystal-lang.org/api/1.11.0/Reference.html#unsafe_construct%28address%3APointer%2C%2Aargs%2C%2A%2Aopts%29%3Aself-class-method)
    is a higher level API on top of that. [`ReferenceStorage`](https://crystal-lang.org/api/1.11.0/ReferenceStorage.html)
    represents a static buffer for a reference allocation.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: These APIs are experimental and might be subject to change. We expect more features
    in this direction in future releases. Join the discussion about custom reference
    allocation at [#13481](https://github.com/crystal-lang/crystal/issues/13481).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: '*NOTE:* `ReferenceStorage` was removed again in 1.11.1 due to compatibility
    issues with older versions of the standard library ([#14207](https://github.com/crystal-lang/crystal/pull/14207)).
    It will come back with an improved implementation.'
  id: totrans-83
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*Thanks [@HertzDevil](https://github.com/HertzDevil)*'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: Deprecations
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Splat operators in macro expressions are deprecated. Use `.splat` instead ([#13939](https://github.com/crystal-lang/crystal/pull/13939))
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`LLVM.start_multithreaded` and `.stop_multithreaded`. They have no effect ([#13949](https://github.com/crystal-lang/crystal/pull/13949))'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`LLVMExtSetCurrentDebugLocation` from `llvm_ext.cc` for LLVM 9+ ([#13965](https://github.com/crystal-lang/crystal/pull/13965))'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Char::Reader#@end` ([#13920](https://github.com/crystal-lang/crystal/pull/13920))'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Thanks
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
- en: We have been able to do all of this thanks to the continued support of [84codes](https://www.84codes.com/)
    and every other [sponsor](/sponsors). To maintain and increase the development
    pace, donations and sponsorships are essential. [OpenCollective](https://opencollective.com/crystal-lang)
    is available for that.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: Reach out to [crystal@manas.tech](mailto:crystal@manas.tech) if youâ€™d like to
    become a direct sponsor or find other ways to support Crystal. We thank you in
    advance!
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: '[Contribute](/sponsors#contribute)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
