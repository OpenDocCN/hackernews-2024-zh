<!--yml

category: 未分类

date: 2024-05-27 13:19:41

-->

# 我讨厌 Rust（编程语言）- dorinlazar.ro

> 来源：[https://dorinlazar.ro/240228-i-hate-rust-programming-language/](https://dorinlazar.ro/240228-i-hate-rust-programming-language/)

现在，请听我说，这里已经深夜，我的英语感觉有点生疏，但我们将尝试在这篇文章中发挥创造力。有许多方法可以表达我们对有毒社区的看法，我将在本文中列举几种。显然，这是一篇非常主观的文章。它不是关于技术优点的，尽管也会提到这些，而是更多关于围绕[Rust（编程语言）](https://en.wikipedia.org/wiki/Rust_%28programming_language%29)进行的社会工程。但我讨厌它，甚至还没有接触过 Rust 代码（但可能将来会）。因此，请和我一起踏上这段奇妙的发现之旅，看看我们能用多少种方式表达同样的观点，即 Rust 社区很差劲。

## 我对 Rust 的个人经历

我尝试学习 Rust 三次。第一次是在 2020 年之前，当时这门语言初露锋芒开始引起人们的兴趣。可能是在2015年左右，可能是受到1.0版本发布的影响，我可以说它看起来很有趣。那时我试图学习它，但我不记得当时的问题是什么 - 我可能甚至没有完成一个完整的写-编译-执行循环来运行一个“Hello World”程序，很可能是因为我感到疲惫并对此否认。尽管如此，我还是读了一些关于这门语言的内容，记了笔，说“是的，听起来很有趣”，关于它的“默认为常量”的策略，然后继续前行。

我第二次接触 Rust 是在 2020 年前的某个时间点，也就是疫情前的“好旧时光”。那时候我已经完全处于燃尽状态，我打开了一本 Rust 的书，因为学习新事物让我感觉重新连接了我对计算机科学的热爱。由于某种原因，学习新东西是一种很好的燃尽缓解机制，但每个人的燃尽感受都不同。所以我开始阅读 Rust，第一章证明是一个关于包容性的道德课程，我觉得&mldr;朋友。我来这里不是听多样性讲座，我是来学习语言的。但书中却谈到了成为 Rustaceans（我真的讨厌这个术语），热爱多样性，感觉更像是一场洗脑的多样性、公平与包容（DEI）讲座，而不是关于技术话题的严肃对话。不过这一次，我尝试了更多的语言，实际上写了一些程序，使用了一些库完成了一些相对小的任务，但感觉非常不满意 - 主要是因为库还不够成熟。我也不喜欢 `cargo`，以及书中建议我安装 Rust 的方式，看起来现在推荐的方式仍然是通过从互联网上下载并运行脚本。作为80年代和90年代的孩子，我觉得这很不负责任。现在依然如此，但这个问题我们以后再谈。

我的第三次是我放弃这个狗屁东西的时候。2020年末，2021年初，深深的大流行时期，在我休假的居家时间里，试图应对我燃尽的余烬。我跳过了多样性的章节（我不知何故拿了同一本书来读），开始写更多的代码。代码无法编译。我震惊了。真是太神奇了，一个推荐的学习材料居然能让你的第一个程序无法编译。我不会深究我的存档，但那时我确实详细讨论过这个问题，因为真的太搞笑了。问题当然是，我没有正确地复制粘贴设置序列，而是让Cargo下载了最新版本，其中API完全不同，（如果我没记错的话）我想那个程序是一个“猜数字”程序，写下来后编译出错实在是疯狂极了。我有一个非常“醒醒吧”（get to your fucking senses）的时刻，从此放弃了Rust（直到我不得不再次拾起它，因为这就是我的运气）。

现在，听好了，我非常擅长避开技术。我成功地避开了微软胡扯的UI技术浪潮很长时间；我几乎也成功地避开了MFC，尽管2001年我不得不在Linux上实现MFC同步对象，直到（真是我运气）没人再用MFC了，我又不得不在Windows CE上实现东西，正当大家都意识到微软的垄断态度对业务不利，转向Linux时。那段时间真是令人沮丧，看到Linux（我是比较早采用者）周围如此繁忙，而我却必须使用微软技术，但&mldr;呵呵，这就是我的运气。另外，我很长时间也设法避开了Java（尽管为了一个C#面试不得不学一些Java，结果成了我的下一个工作，而C#被证明是一个令人愉快的惊喜，说话者有斯德哥尔摩综合征的我）。我还设法很长时间避开了Javascript（而且我想我仍然感激我可以忽略像leftpad这样的创新）。因此，忽视一种技术产品作为一种经验对我来说并不新鲜，我曾以为我能够希望一生都能忽视Rust。但事实证明这是不可能的。

## 让我来告诉你关于我们的主教和救世主Rust

我认为我开始注意到 Rust 的传教活动是在 2022 年，当它开始无处不在，甚至在你不希望看到它的地方。每个 C++ 的会议上都有关于 Rust 的讲座，Rust 社区渗透到了与 C 或 C++ 相关的互联网的每一个角落（巧合的是，有时搜索引擎会忽略掉那个 # 字符的 C#）。每个人都开始谈论“唯一真正的语言”的优点，基本上不过是在 C++ 编译器的命令行中启用一些检查器，以及那种感觉像是编译时垃圾回收的借用检查器。坦率地说，一旦每个人开始谈论 Rust，就感觉像是一个嘈杂的合唱团，试图唱出计算机未来的曲调，却没有为之贡献太多。“我们可以用 Rust 重写一切！”“我们可以用 Rust 重写 Web！”“用 Rust 重写它”。哎呀，为什么不去重写呢？啊，因为你们忙着在社交媒体平台上写 Rust 有多棒，而不是写代码，对吧？

我并不是说没有很多真正在做事情的忙碌人，而不是只是谈论事情。我想说的是，那些不这么做的人，对于采用 Rust 却非常喧哗。“要是我们能用 Rust 重写这个！”“你们这些老人用你们的 C 代码和内存不安全的语言在门户前站岗！”“你们写内存不安全的语言真是太可恶了！”“在我们主的一年（或 2022 年）用 C 和 C++ 写代码是一个致命的罪过”。与 Rustaceans（Rust 社区成员）没有讨论的空间 - 尽管 Rust 书籍中包含关于 Rust 的社区的讨论，围绕该语言的社区感觉上显得非常具侵略性和排外性。特别是因为他们的讨论除了默认常量和借用检查器之外几乎没有实质性的论点。

## 如此多的问题是由内存不安全语言引起的

或许 Rust 最虚伪的一件事情是声称世界的问题是因为在 C++ 中（Rust 的主要目标）你仍然可以写非常糟糕的代码。这些说法后面有数据支持，的确，有很多糟糕的代码存在。我确实同意软件世界需要重写 - 我曾经辩论过完全放弃 POSIX，因为 POSIX 传播了计算机历史上最糟糕的一个想法。我还争论说，在操作系统领域没有足够的研究，绝对没有足够的努力来替换 Linux，它本身现在已成为每个人的负担。该死，人们一直在抱怨 `systemd` 的存在，尽管它绝对是朝正确方向迈出的一步。但人们是习惯性动物 - 我们创造出途径让自己感到正义，同时继续做坏事。`rust` 就是这样一种方式，让人感到正义，同时继续旧的行为。

我称`rust`为回收塑料的类似物。我们知道回收塑料并不实际，最好的办法是不再使用塑料，但对于现代社会来说，不使用塑料非常困难。因此，我们发明了这个小漏洞，让我们对我们生活的每个方面都在污染世界中感到满意——我们*回收*，而我们对此感到良好。*rust重写*也是如此。我们“用Rust重新编写一切”，我们会因为没有改变我们做事情的基本方式而感到高兴。

到现在你可能会问自己，“这小子在说什么？”你问得对。那么，朋友们，请允许我来教育你们。人们列出的大多数“内存不安全语言”的问题都是由于糟糕的基本选择综合征引起的，而大多数糟糕的基本选择的起源是所有人，包括Rust在内，使用的基本API。POSIX和Win32作为基本操作系统接口，沿袭了计算历史上最昂贵的错误，即**零终止字符串**。无论你做什么，无论你如何做以及如何打包你的数据，最终你都需要通过某种形式传递零终止字符串与你的操作系统通信。在从操作系统接口以及基本库中完全消除这个错误之前。

Rust并没有改变这一点；它只是隐藏了它。但有人可能会争辩说C++也可以隐藏这个问题——确实，Rust在隐藏这个细节上做得更好，但C++并没有不同。这就是为什么我更喜欢**重写成Pascal**而不是**重写成rust**。Pascal字符串是基本类型，始终包含字符串的大小。如果你从头开始在Pascal中编写一切，就不需要这个零终止的废话。不幸的是，Pascal在80年代失去了成为主导平台的竞争，这是遗憾，但事实就是这样。

这里的关键是，你来到这里并向你的互联网服务提供商支付了一大笔钱来显示在你的计算机屏幕上的一件事。

## Rust **不是**一种内存安全的语言

但是借用检查器！但是默认的const！不！你在撒谎，拉扎尔先生，你是故事中的邦德恶棍。[你怎么敢？！](https://knowyourmeme.com/memes/how-dare-you)

现在，请听好，只要你的语言中存在愚蠢的行为，你的语言就不是内存安全的；只要在你的语言中做愚蠢的事情是常规做法，你的语言就不是傻瓜证明的。作为一个入门，我将使用[Rust官方文档站点上String类的文档](https://doc.rust-lang.org/std/string/struct.String.html)的当前版本。其中的一个最初的例子看起来像这样：

```
// some bytes, in a vector let sparkle_heart = vec![240, 159, 146, 150]; // We know these bytes are valid, so we'll use `unwrap()`. let sparkle_heart = String::from_utf8(sparkle_heart).unwrap(); assert_eq!("💖", sparkle_heart); 
```

我非常喜欢“我们知道这些字节是有效的”，这看起来相当糟糕。这样做可能是安全的，但是如果我们进一步深入，我们会看到这样的东西：

```
let s = unsafe { String::from_raw_parts(ptr, len, capacity) }; 
```

现在，我并不是在说这不好。标记你的`unsafe`代码很好，几乎和告诉你的函数会抛出什么异常一样好（是的，这是对Java的一种挑衅）。但是当你在代码中写`unsafe`时，你就可以逃脱做一些愚蠢的事情，基本上是在说“我们知道我们不能这样做。我们不能写安全的代码”。你必须非常天真才会认为`unsafe`这样的特性不会被滥用。不要误会，我理解。你和你的朋友们肯定不会毫无必要地使用`unsafe`语句。你们只会在容易证明的情况下使用它，你们写的是好代码，安全的代码。但是在某个地方，深藏在下面，有一些`unsafe`语句使你写的代码被称为安全。这就像在你回收时仍在生产的塑料一样。这是这种语言虚伪的主要观点。朋友，你的语言并不安全。它根本不安全。

我甚至不想谈论“[以100%安全Rust编写的“火速🔥快🚀内存漏洞”](https://github.com/Speykious/cve-rs)”（说实话，我对Rust并不那么在意，所以我并没有详细检查过这个项目，但我确信浏览这个项目对所有的Rust爱好者来说都会是一次有趣的体验）。我只想讨论`unsafe`特性的事情，以及`unsafe`语句带来的虚假安全感。只要真相对你是隐藏的，你就可以感到安全。请允许我告诉你，这与在C++中编写代码没有什么不同 - 你可以在C++中编写非常安全的代码，自从90年代中期甚至更早以来，防御性编程就已经存在了。但你的防御性可以延伸到你使用的库，这些库可能会让你的防御性骗了回来。你无法确定你的库是否真的安全，还是只是一个等待爆炸的大炸弹。你的系统有多安全，你就有多安全。但请允许我告诉你，在你的Rust可执行文件中可能有一大堆你不知道的不安全性。但你感觉安全，因为你并没有自己写下那个`unsafe`标签。是别人写的，别人**应该**比你更懂。对吧？对吧？请告诉我这是真的！

## Cargo仪式主义

或许让C++社区的每个人都热血沸腾的最大原因是`cargo`。天哪，拥有`cargo`编译所有东西并下载所有东西，真是太好了&mldr;

朋友们，去他的`cargo`。`cargo`真的没有任何好处，除了你开车撞墙时速度之快。我是说，我理解。`cargo`是一个极好的生产工具。它如此惊人，允许你从互联网上下载代码，非常高效，并且&mldr;

-   朋友。不要从互联网上下载代码。不要复制/粘贴互联网上的代码，也不要相信来自互联网的人。为什么你要信任来自5000英里之外的程序员？他与你有何不同，他比你更有能力吗？为什么你如此信任人类（你怎么能信任由人类生成数据训练的LLM）？人类很擅长写代码，你不应该自动信任这些东西。

-   而且你可以说，你知道，你可以配置`cargo`，以避免随机引入东西。冻结依赖项。冻结版本。但如果你冻结版本，你就得不到安全更新。但如果你不冻结版本，你可能会得到新的依赖项。但是，但是，但是。

这不是一个新问题，而是一个旧问题，只是随着向行业中每只脚交付一把散弹枪而变得更加严重了。此外，正如上文所述的`unsafe`问题，仅仅因为一个工具可以配置为正确使用并不意味着它会被正确使用。也许普纳的拉吉特知道如何安全配置和使用`cargo`，但是加利福尼亚山景城的杰克对此毫不在意，并决定忽略拉吉特的指导。安全的栏杆存在并不意味着它们会被使用，而且仅仅因为你将某些滥用宣传为不好的事情并不能阻止人们做坏事。而且`cargo`几乎自动迫使你信任那些开了GitHub账户的人。

我不是说没有像`cargo`这样的东西更好。然而，这个世界上大部分软件都是由进行过分发测试并提供某些保证的人构建的。如果你从RedHat购买东西，你可能会得到他们的一些支持，并且你可以期待，如果某个库有问题，他们会在几个小时、几天或几周内修复它，这取决于问题的严重程度。`cargo`提供什么样的保证呢？要么你不遵循所有与你获取的所有依赖相关的CVE（公共漏洞及其利用），你就不能解决你的问题；要么你将有一些来自GitHub的随机人员提供与分发商曾经提供的相同的保证。这可行吗？有些人说可以。我看到在这方面确实有一些真正的努力。现在安全了吗？不。很快会安全吗？不，很可能永远不会。但它总会让你感觉相对安全。足以让你不太在乎这个问题。

现在让我们回到抨击社区，因为这样你就不会在这里交朋友了。

## 妄想不是解决问题的办法

所以到目前为止，我们了解到Rust不是一种更安全的语言，也不鼓励安全实践，还剩下什么？精英主义、自鸣得意和难以置信的正义感，这都是这个领域特有的。大多数问题来自于他们展示的数字，“看，由于不安全的语言造成了这么多问题”。朋友，你的语言之所以不会出问题，是因为全球只有0.001%的人使用你的语言编写的代码。

所有社区都被Rust爱好者渗透了。在C++论坛上，我看不到一个好的讨论不提到Rust，好像Rust能治愈这门语言的所有病痛一样。我在阅读关于C标准更新的信息时，总会听到有些白痴在叫嚣说Rust做得更好，我们都应该皈依他的宗教。我希望我能够忽视这些白痴一直在重复的事情。

我还讨厌这个社区的非官方游说机构，他们充满热情地发布大量信息，并给人一种错觉，即我们拥有有缺陷的技术的原因是内存安全，即被定义为“Rust所做的任何事情”。当像“不要使用C和C++，使用Rust”这样的话从白宫新闻发言人那里传播出来时，这是危险的，特别是因为整个世界建立在30%的C代码、30%的C++代码和其他不包括Rust的代码基础上。

Rust的人们坚持说他们是解决方案，但事实是，真相在那里，真相说Rust只是一时的风尚。一个非常喧嚣的风尚，无疑是一个有趣的风尚，也许会流行起来，就像C当年在其他更好的语言如FORTRAN和LISP存在时一样。但目前来看，我们需要更少的噪音，直到你学会如何指挥整个交响乐团，因为我们听到的只是一片嘈杂声音，令人疲倦。

Rust确实有一些技术优点，但我可以说它还没有被广泛应用到足以改变生活的程度。现在说来还为时过早。目前，与Rust的人合作很困难，对于他们来说，要么用Rust，要么什么也不用（但可以用neovim和lua）。如果你用Go、C++或C编写代码，你不能使用Rust库（或许你可以，但为什么要呢？）。我不知道有没有基础库是用Rust编写的，而不是某些已经存在于C++、C或Python的库的稍微改进版本。我听到的都是一些妄想的人们嘈杂的声音，他们声称写糟糕的C++代码会导致世界末日。

所以，基本上，Rust需要闭嘴，停止谎称它的能力。Rust并不是一种内存安全的语言，也没有体现安全实践。还有很多工作要做，世界上还有很多问题需要解决，我可以不用噪音来掩盖工作不足。这就引出了最后一点。那些实际在Rust中做出贡献的人们，可能因为太忙而没有时间去骚扰其他基础技术栈，因为他们不是Rust。如果这些人存在的话，他们是默默无闻地工作，我对他们的努力表示感谢。就像我对亿万行潜在不安全的C和C++代码感到感激，这些代码让我能够在今天把这篇文章发布到互联网上。
