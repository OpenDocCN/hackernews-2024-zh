["```\nfrom datasets import load_dataset\n\ndataset = load_dataset(\"teknium/OpenHermes-2.5\")\n```", "```\ndef _return_header(message)-> str:\n    role = message[\"from\"]\n    header = \"\"\n    if role == \"system\":\n        header = \"system\"\n    elif role == \"gpt\":\n        header = \"assistant\"\n    elif role == \"human\":\n        header = \"user\"\n    return header\n\ndef encode_header(message):\n    text = ''\n    text = text + \"<|start_header_id|>\"\n    header = _return_header(message)\n    text = text + header\n    text = text + \"<|end_header_id|>\"\n    text = text + \"\\n\\n\"\n    return text\n\ndef encode_message(message)->str:\n    text = encode_header(message)\n    text = text + message[\"value\"].strip()\n    text = text + \"<|eot_id|>\"\n    return text\n\ndef encode_dialog_prompt(dialog):\n    text = ''\n    text = text + \"<|begin_of_text|>\"\n    for message in dialog:\n        text = text + encode_message(message)\n    return text\n```", "```\nds = dataset.map(lambda x: {\"content\":encode_dialog_prompt(x['conversations'])}, num_proc=10)\n```", "```\nds = ds.remove_columns(['custom_instruction', 'topic', 'model_name', 'model', 'skip_prompt_formatting', 'category', 'conversations', 'views', 'language', 'id', 'title', 'idx', 'hash', 'avatarUrl', 'system_prompt', 'source'])\ntrain_test_split = ds[\"train\"].train_test_split(test_size=0.3)\n```", "```\ntrain_test_split.push_to_hub(\"sumandas/openhermes-2.5-llama3\")\n```", "```\n<|begin_of_text|><|start_header_id|>system<|end_header_id|> You are an AI assistant. Provide a detailed answer so user donâ€™t need to search outside to understand the answer.<|eot_id|><|start_header_id|>user<|end_header_id|> Instructions: Given a sentence, generate what should be the most likely next statement. The next statement should be reasonable and logically correct. Input: The screen is full of white bubbles and words, while a pair of hands plays the piano. The bubbles and words disappear and it Output:<|eot_id|><|start_header_id|>assistant<|end_header_id|> Output: becomes apparent that the hands are creating a visual representation of the music being played, captivating the audience with this unique sensory experience.<|eot_id|>\n```", "```\ngit+https://github.com/huggingface/transformers\ngit+https://github.com/huggingface/accelerate\ngit+https://github.com/huggingface/peft\ngit+https://github.com/huggingface/trl\nhuggingface-hub\nbitsandbytes\nevaluate\ndatasets\neinops\nwandb\ntiktoken\nxformers\nsentencepiece\ndeepspeed\ntorch==2.2.2\n```", "```\naccelerate launch --config_file \"deepspeed_config.yaml\"  train.py \\\n--seed 100 \\\n--model_name_or_path \"meta-llama/Meta-Llama-3-8B-Instruct\" \\\n--dataset_name \"sumandas/openhermes-2.5-llama3\" \\\n--chat_template_format \"none\" \\\n--add_special_tokens False \\\n--append_concat_token False \\\n--splits \"train,test\" \\\n--max_seq_len 2048 \\\n--num_train_epochs 1 \\\n--logging_steps 5 \\\n--log_level \"info\" \\\n--logging_strategy \"steps\" \\\n--evaluation_strategy \"epoch\" \\\n--save_strategy \"steps\" \\\n--push_to_hub \\\n--hub_private_repo True \\\n--report_to \"wandb\" \\\n--hub_strategy \"every_save\" \\\n--bf16 True \\\n--packing True \\\n--learning_rate 1e-4 \\\n--lr_scheduler_type \"cosine\" \\\n--weight_decay 1e-4 \\\n--warmup_ratio 0.0 \\\n--max_grad_norm 1.0 \\\n--output_dir \"llama3-openhermes-2.5\" \\\n--per_device_train_batch_size 4\\\n--per_device_eval_batch_size 4\\\n--gradient_accumulation_steps 2 \\\n--gradient_checkpointing True \\\n--use_reentrant True \\\n--dataset_text_field \"content\" \\\n--use_flash_attn True \\\n--use_peft_lora True \\\n--lora_r 8 \\\n--lora_alpha 16 \\\n--lora_dropout 0.1 \\\n--lora_target_modules \"all-linear\" \\\n--use_4bit_quantization True \\\n--use_nested_quant True \\\n--bnb_4bit_compute_dtype \"bfloat16\" \\\n--bnb_4bit_quant_storage_dtype \"bfloat16\"\n```", "```\n{\n  \"train/learning_rate\": 0.00004551803455482833,\n  \"eval/steps_per_second\": 0.893,\n  \"_wandb.runtime\": 51487,\n  \"_runtime\": 51480.36651659012,\n  \"_timestamp\": 1713698971.6200776,\n  \"train/epoch\": 1.0571428571428572,\n  \"train/grad_norm\": 0.14189070214353952,\n  \"train/global_step\": 8325,\n  \"eval/samples_per_second\": 7.141,\n  \"_step\": 1665,\n  \"eval/loss\": 0.963840126991272,\n  \"train/loss\": 0.9674,\n  \"eval/runtime\": 7532.9797\n}\n```", "```\nfrom peft import PeftModel\nfrom transformers import AutoModelForCausalLM\n\nbase_model = AutoModelForCausalLM.from_pretrained(\"meta-llama/Meta-Llama-3-8B-Instruct\",torch_dtype=torch.bfloat16, device_map=\"auto\")\nadapter_model = PeftModel.from_pretrained(base_model, \"sumandas/llama3-openhermes-2.5\")\nadapter_model.merge_and_unload()\n```", "```\nadapter_model.push_to_hub(\"sumandas/llama3-openhermes-2.5\")\n```", "```\nimport torch\nimport transformers\nfrom transformers import pipeline\n\npipe = pipeline(\"text-generation\", model=\"sumandas/llama3-openhermes-2.5\",model_kwargs={\"torch_dtype\": torch.bfloat16},\n    device=\"cuda\")\n\ngenerate_kwargs = {\n    \"do_sample\": True,\n    \"temperature\": 0.7,\n    \"max_new_tokens\": 35,\n} \n```", "```\npipe(\"<|begin_of_text|><|start_header_id|>user<|end_header_id|> Describe the food of Thailand<|eot_id|><|start_header_id|>assistant<|end_header_id|>\",max_length=2048)\n```", "```\nThai cuisine is a blend of bold flavors and aromatic ingredients that create a harmonious balance of sweet, sour, salty, bitter, and spicy taste. The food in Thailand varies between different regions, but some common ingredients found throughout include rice, noodles, vegetables, herbs, and spices. Rice is a staple of Thai cuisine and is served with almost every meal, whether it is stir-fried, boiled, or used to make congee or fried rice. Noodles, made from rice or wheat, are also very popular and can be found served with various broths, sauces, and toppings in many Thai dishes. Thai food is known for its use of fresh herbs and spices such as lemongrass, galangal, coriander, basil, kaffir lime leaves, ginger, and garlic, which give the dishes their distinct flavors. Thai chilies are also widely used to add varying levels of heat to the food. Some popular Thai dishes include Tom Yum soup (hot and sour soup with lemongrass, kaffir lime leaves, and chilies), Pad Thai (stir-fried rice noodles with vegetables, peanuts, and a tangy sauce), and green curry (a spicy curry made with green chilies, coconut milk, and Thai basil). Many Thai dishes are also accompanied by a variety of sauces and condiments, including fish sauce, soy sauce, chili paste, and tamarind sauce. Fresh fruits like mango, papaya, and pineapple are also commonly enjoyed as a sweet ending to a meal. Overall, Thai food is a vibrant and flavorful cuisine that combines traditional ingredients and cooking techniques with a balance of flavors that tantalize the taste buds.<|eot_id|>\n```"]