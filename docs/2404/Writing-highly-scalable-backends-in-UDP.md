<!--yml

category: 未分类

date: 2024-05-27 13:03:26

-->

# 用UDP编写高度可扩展的后端

> 来源：[https://mas-bandwidth.com/writing-highly-scalable-backends-in-udp/](https://mas-bandwidth.com/writing-highly-scalable-backends-in-udp/)

我是[Glenn Fiedler](https://www.linkedin.com/in/glenn-fiedler-11b735302/?ref=mas-bandwidth.com)，欢迎来到**Más Bandwidth**，这是我在游戏网络编程和可扩展后端工程交汇处的新博客。

想象一下你有一个系统需要编码，并且需要扩展到成百上千万个请求每秒。常规的做法是在HTTPS中实现，使用负载均衡器在一些自动按需扩展的虚拟机（VM）前面。例如，你可以在Google Cloud中使用负载均衡器在一个MIG前面实现HTTPS处理程序（非常简单）。关于如何做这些的信息在网上很多，而且将这些扩展到每秒成百上千万个请求也相对容易。

但是如果你需要在UDP而不是HTTPS中做同样的事情呢？

现在你走上了不被熟知的路线，你会发现几乎没有关于如何做这件事的信息。这实际上是我们在[Network Next](https://networknext.com/?ref=mas-bandwidth.com)需要做的事情，我的初创公司提供多人游戏网络加速技术。我们的SDK可以在如PS4、PS5、Nintendo Switch和XBox等游戏主机以及Windows、MacOS和Linux上运行，避免在游戏主机上移植和维护像**libcurl**或**mbedtls**这样的东西的开销和复杂性对我们的客户有好处。

明确一点，我不是在呼吁你停止使用HTTPS并将后端切换到UDP。如果你对HTTPS感到满意，并且它正在满足你的需求，那太棒了！继续走被熟知的路线。但是，如果像我一样，你有一些更适合使用UDP的用例，或者只是好奇这种奇怪方法如何工作，那就继续往下看吧。

* * *

## 完美的面试问题

使用UDP构建可扩展的后端的想法实在是*有点另类*，多年来我一直把它作为面试题用于[Network Next](https://networknext.com/?ref=mas-bandwidth.com)。你不能仅仅通过谷歌搜索就找到示例源代码来展示如何做这件事。要解决这个问题，你需要吸收多方面的信息并创造性地综合出自己的结果。这正是我从Network Next工程师身上期望看到的。

这个问题本身看起来非常简单：

> 你的任务是在Google Cloud中用Golang创建一个运行在UDP上的客户端/服务器应用程序。在这个应用程序中，客户端必须通过UDP与服务器通信。
> 
> 每个客户端每秒发送100个请求。每个请求长度为100字节。服务器处理接收到的每个请求，并通过HTTP转发到后端。
> 
> 后端处理请求，并返回包含请求数据的FNV1a 64位哈希的响应。服务器通过UDP将从后端收到的响应返回给客户端。
> 
> 在Golang中实现客户端、服务器和后端。提供每月在稳定负载下1M客户端运行解决方案的成本估算，以及您建议的减少成本的下一步选项。

虽然我相信经验丰富的高级工程师可能在周末找到解决方案，但我给工程师足够的时间在家里研究和解决问题。重要的是工程师的思维过程，而不是他们实现的速度。当然，我也希望尊重工程师可能在工作之余实施这些解决方案的事实。

如果您想自己解决这个问题，现在是时候了。

***我将于2024年4月16日发布完整解决方案，即从今天起一周。***

* * *
