- en: <!--yml
  id: totrans-split-0
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  id: totrans-split-1
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-27 13:39:29'
  id: totrans-split-2
  prefs: []
  type: TYPE_NORMAL
- en: -->
  id: totrans-split-3
  prefs: []
  type: TYPE_NORMAL
- en: The only two log levels you need are INFO and ERROR | nicole@web
  id: totrans-split-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://ntietz.com/blog/the-only-two-log-levels-you-need-are-info-and-error/](https://ntietz.com/blog/the-only-two-log-levels-you-need-are-info-and-error/)
  id: totrans-split-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Logging is a critical tool for maintaining any web application, and yet we're
    getting it wrong.
  id: totrans-split-6
  prefs: []
  type: TYPE_NORMAL
- en: With great logs, you can see what your application is doing. And without them?
    Things can be broken left and right without you ever finding out. Instead, you
    wonder why your customers don't come back, and shrug, and blame someone other
    than engineering.
  id: totrans-split-7
  prefs: []
  type: TYPE_NORMAL
- en: Unfortunately, it's common for us to log in ways that are unhelpful. Log levels
    are inconsistent, and logs are added to fix bugs then removed afterwards. But
    come on, you saw the title, this is about the log levels, mostly.
  id: totrans-split-8
  prefs: []
  type: TYPE_NORMAL
- en: The typical log levels
  id: totrans-split-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Most languages and logging libraries have a handful of log levels, at least
    five. But they vary! Here are three examples:'
  id: totrans-split-10
  prefs: []
  type: TYPE_NORMAL
- en: 'Rust''s `tracing` has [five log levels](https://docs.rs/tracing/latest/tracing/struct.Level.html):
    ERROR, WARN, INFO, DEBUG, and TRACE.'
  id: totrans-split-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Python''s `logging` also has [five log levels](https://docs.python.org/3/howto/logging.html):
    CRITICAL, ERROR, WARNING, INFO, and DEBUG.'
  id: totrans-split-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The infamous `log4j` has [six log levels](https://logging.apache.org/log4j/1.x/apidocs/org/apache/log4j/Level.html):
    FATAL, ERROR, WARN, INFO, DEBUG, and TRACE.'
  id: totrans-split-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Three examples and three wholly different sets of log levels. They all function
    in about the same way: you log certain information at different levels, based
    on your ideas of "severity" and "granularity", and then as you get toward the
    fatal/error end of the log levels you see only the most critical alerts, and toward
    the other end you see *everything* to help you debug your application.'
  id: totrans-split-14
  prefs: []
  type: TYPE_NORMAL
- en: There's really no typical set of log levels, nor common cross-language guidance
    on what to log at which level. There can't be that advice, because the levels
    vary so much!
  id: totrans-split-15
  prefs: []
  type: TYPE_NORMAL
- en: What do we do with logs?
  id: totrans-split-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When we add log statements, that's typically because we think that we will need
    those logs sometime in the future. We think they'll help us debug something, or
    help us audit that it happened, or discover a critical error.
  id: totrans-split-17
  prefs: []
  type: TYPE_NORMAL
- en: 'Think about a time when you went to debug a deployed web application (not on
    your local machine) and used the logs. Typically, we''re doing a few things:'
  id: totrans-split-18
  prefs: []
  type: TYPE_NORMAL
- en: '**Discovering errors to fix.** We want to know when something has gone wrong,
    so we look for errors in the logs. Typically, you also want to get alerted if
    something needs to be fixed. And related, you *don''t* want to be alerted if something
    happens that doesn''t deserve attention. Alert fatigue is a serious problem.'
  id: totrans-split-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Debugging a problem.** When something does go wrong, whether you were alerted
    from logs or not, you''ll turn to them to understand what''s up. The logs can
    tell you what''s happening that''s unexpected. They should include any stack traces,
    related errors, and conditions leading up to the problem.'
  id: totrans-split-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Understanding usage.** Sometimes logs are good for understanding how things
    are used! You can see generally which portions of the application are accessed
    or left untouched. They''re not a substitute for metrics or distributed tracing,
    though!'
  id: totrans-split-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Understanding how it works.** Logs can also help you understand how a system
    works! If you have just the code, you''ll see a lot of functions and request handlers
    and data and where do you start? With the logs, you can generally find an entry
    point where a request or session starts. From there, you can follow along with
    those logs through the life cycle of the session and follow the execution!'
  id: totrans-split-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'These can be split into two categories: logs that wake me up, and logs that
    help me fix things.'
  id: totrans-split-23
  prefs: []
  type: TYPE_NORMAL
- en: For logs that wake me up, I want to know a few things. What's the problem *precisely*?
    When did it happen? And where can I find related logs?
  id: totrans-split-24
  prefs: []
  type: TYPE_NORMAL
- en: And then for logs that help me fix things, I really want to know everything.
    Well, when debugging, everything relevant, I don't need to go down a rabbit hole
    about CNCs right *then*. And you don't know what's going to be relevant until
    you know the answer to your question! You might have a guess, but it's a guess.
  id: totrans-split-25
  prefs: []
  type: TYPE_NORMAL
- en: The levels you need
  id: totrans-split-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In practice, I tend to find that you only really want two log levels: ERROR
    and INFO. That''s because we really do only care if something should alert us
    or not. For all the other uses of logs, we want to see *all* the context.'
  id: totrans-split-27
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s use WARNING as an example. Suppose you *should* have a WARNING log level,
    and some of those show up in your logs. What should you do when you see them?
    There are three choices:'
  id: totrans-split-28
  prefs: []
  type: TYPE_NORMAL
- en: If the information isn't useful at *all*, in any scenario, delete them entirely!
  id: totrans-split-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If it helps you make sense of other logs, potentially related to an error, then
    these are just info logs for debugging! They should be INFO level to reflect that.
  id: totrans-split-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: And if it is an error you need to fix, well, it's not a warning now is it? Make
    that an ERROR log.
  id: totrans-split-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: And similar for things like DEBUG or TRACE. Usually you reach for those log
    levels when you want to see extremely verbose information, but... That's not practical
    to enable in production environments, because the volume of logs you produce would
    be way too high. And if you can't use it in production, you probably shouldn't
    use it elsewhere! That's what your local debugger is for.
  id: totrans-split-32
  prefs: []
  type: TYPE_NORMAL
- en: Things like FATAL? Yep, that's *also* an ERROR log, because you do want to be
    alerted on it!
  id: totrans-split-33
  prefs: []
  type: TYPE_NORMAL
- en: In every situation that I've run into in production, a single log line at a
    given level is never sufficient to debug something, only to know it happened.
    And even then, what actually happened? Shrug. Let's look at more log lines.
  id: totrans-split-34
  prefs: []
  type: TYPE_NORMAL
- en: And so if you separate things out into different log levels, you end up looking
    at all of them together *anyway*, because to understand your warnings or errors
    you need all the info logs to see what was going on! You need that broader context
    to make sense of the overall situation. It's very slight semantic information,
    similar to syntax highlighting, but there are better ways to deliver that information.
  id: totrans-split-35
  prefs: []
  type: TYPE_NORMAL
- en: Enhance your logs in other ways
  id: totrans-split-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are better ways to increase the usability of your logs than with strict
    adherence to different log levels. Structured logging is the practice of emitting
    logs in a machine-readable format. They're often created from maps, and then output
    in the logs as JSON or output for humans to see in a more readable format. Using
    structured logging, you can attach a lot more detail to each log in a way that's
    *useful*.
  id: totrans-split-37
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are a few practices I like to use:'
  id: totrans-split-38
  prefs: []
  type: TYPE_NORMAL
- en: '**Attach a request/trace id.** This goes along with distributed tracing, and
    helps you filter effectively. Filtering down by log level won''t give you context,
    but correlating by request id will give you all the logs for a given event!'
  id: totrans-split-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Include timestamps.** All logs should include timestamps, but let''s just
    make *sure* we have them and at a useful precision. Having these in a structured
    format makes it easier to use them for calculations.'
  id: totrans-split-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Add related ids.** When an incoming request relates to a given user, document,
    or other data, adding that id into the logs is so helpful! Then when you''re debugging,
    you can see either all the logs for a particular object, or you can see if a particular
    set of data is related to the issue you''re working on. Without this, you are
    just guessing "Maybe this is just a BigCo issue," and with it you know whether
    other customers see it too.'
  id: totrans-split-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Note information for auditing.** If you log information for audit purposes,
    how will you find it? By including something in the logs that let you look for
    the needle in that haystack (and retain the needles when you toss out the haystack
    because paying the haystack storage company is akin to setting a pile of cash
    on fire—not to torture the metaphor). This can be as simple as a boolean for if
    it''s an audit log, or more complicated if you need that.'
  id: totrans-split-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Flags which were set.** Your application probably has feature flags. Which
    ones were enabled for this request? Let''s put them in the logs so we can tell.'
  id: totrans-split-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Where the log came from.** Including the module or function name that a log
    came from can be really helpful for looking at surrounding context later. Too
    often, I''ve not had this, and had to grep for a specific string to find where
    that log was emitted. Hopefully only in one spot.'
  id: totrans-split-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You do want to avoid adding too much information, because it can be an overwhelming
    amount! But if you add in this information tastefully, it's really helpful.
  id: totrans-split-45
  prefs: []
  type: TYPE_NORMAL
- en: And don't add logs in to fix one issue, then remove them later, okay? I've seen
    that done, and what that says is you did not have enough logs in the first place
    to understand what was going on! You might not have known exactly what you need,
    but after you do, then make sure the logs you would have needed for *this* issue
    are present. Ideally they're in a more general form, so that other related but
    different issues can also be debugged in the future.
  id: totrans-split-46
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  id: totrans-split-47
  prefs: []
  type: TYPE_NORMAL
- en: Look.
  id: totrans-split-48
  prefs: []
  type: TYPE_NORMAL
- en: I know, log levels are useful. I'm not actually terribly dogmatic about this,
    because there *can* be situations where you want to tune the amount of detail
    (especially helpful for libraries to limit their log levels, so you don't get
    everything from them on INFO).
  id: totrans-split-49
  prefs: []
  type: TYPE_NORMAL
- en: 'I just don''t think it''s useful, most of the time, for the kind of work I
    do—web applications, mostly—to worry about anything beyond: wake me up, or don''t.
    If you do it differently, I''d love to hear about your experience.'
  id: totrans-split-50
  prefs: []
  type: TYPE_NORMAL
