<!--yml

category: 未分类

date: 2024-05-27 12:48:00

-->

# 书评：先整理？ | Path-Sensitive

> 来源：[https://www.pathsensitive.com/2024/04/book-review-tidy-first.html](https://www.pathsensitive.com/2024/04/book-review-tidy-first.html)

# 书评：先整理？

在日常工作中，偶尔停下来改善一下是件不错的事情。

有些改变需要对事物是如何进行和为何这样做有深刻理解，但可能会带来巨大的好处。想想：厨师找到更好的方法来腌制家禽以保留风味，或找到一个烘焙时间表，让大多数顾客都能吃到刚出炉的面包。

其他改变会带来稍微愉悦的环境，但当你经过时可以毫不费力地完成。想想：整理餐厅区的椅子，或者扔掉破碎的盘子。

重构代码库可能会很紧张和可怕。肯特·贝克的“Tidy First?”建议我们从小处着手，减少障碍。它提供了一个“整理”的目录：小的、毫无争议的改进，可以在编码之前立即完成。有点像软件版本的摆放椅子。

然后它进一步发展。它讨论了在烹饪之前还是之后应该摆放椅子的问题。关于是一次性整理椅子和清理碗橱还是分两批次。关于为什么整理椅子会导致更愉悦的环境和改善业务的理论。

到最后，你可能已经忘记了更深层次的改进甚至存在。

## 先缩短？

这本书有一个致命的错误：不理解何时详细信息有助于，何时是多余的。

在有害的简洁性方面，第12章讨论了何时以及如何提取辅助方法。我认为这一章的内容都是正确的和好的建议，但它也太过模糊，以至于我认为除非已经理解，否则对任何人都没有用。其中一个核心整理只用几行文本和以函数foo和foo_body为特色的示例代码描述，因此我自己在理解他推荐的东西时也感到困难，特别是它主要适用于几种语言。

但在冗长方面，有很多段落都是这样的：

> 行为创造价值。与其手动计算大量数字，不如让电脑每秒计算数百万个。事实证明，人们愿意为了不用手动计算数字而支付费用。如果运行软件耗电1美元，而你可以向用户收取10美元来代为运行，则你有了一个生意。
> 
> （第23章）

你知道什么不创造价值吗？花4句话说自动化事务是有价值的。

这种模式——在显而易见的地方提供额外细节，而在有帮助的地方省略细节——贯穿整本书。因此，即使《Tidy First?》只有大约100页，我觉得它还在不断地填充空间。

有时候空间问题更深远。比如，我想起了一个[故事](https://web.archive.org/web/20150407223525/http://squid314.livejournal.com/297579.html)，讲的是在一个没有电脑的第三世界教室里教授“计算机技能”课程。想象一下：一位讲师站在黑板前，唠叨道，“当你点击‘开始’按钮时，会出现一个菜单。然后你会鼠标悬停在……”

第17章，“链接”，就像这样。它应该是一个关于如何通过整理一种可能导致另一种的例子列表，就像你可能在删除一个从未运行的分支后看到重新排序代码的新机会一样。但如果你没有尝试过整理并看到这一情况的发生，要理解这一点是很困难的，如果你已经尝试过，那么你自己的经验将比这一章节更好地展示给你。

实际的整理清单还不错。大多数都是非常普遍且小幅改进。他对代码重新排序提出了一些我觉得过于简化的观点，一般而言，这比添加[好的代码段](https://www.pathsensitive.com/2023/12/should-you-split-that-file.html)的改进要小。他重复了“删除未使用的代码而不是将其注释掉，因为你随时可以从VCS恢复它”的典型说法。（这是一个我开始有异议的观点，原因和“你可以从备份中恢复它”并不是删除当前未使用文件的令人信服的理由一样。）他举了一些例子，说明程序员们，即使在介绍课程中被告知不要使用魔术数字，仍然会在他们的代码中填充像404这样的常量。但我希望他告诉Python程序员停止设计API，其中你写字符串常量如“r--”和“bs”来表示你的散点图应该使用红色虚线和蓝色正方形。他的目录列出了“在阅读代码时希望有的注释添加”和“删除仅仅描述代码内容的注释”。但我更希望有一场更深入的讨论，提供更多如何改进注释的工具。（《软件设计的哲学》中的讨论是我喜欢那本书的一个重要部分。）

## 最后连接这些思想吗？

总体而言，贝克试图提供一系列你在驱动代码时可以获得的轻松胜利。我认为他在这个目标上取得了成功，尽管这是一个相当贫乏的库存。例如：它们无法解决我最近运行的[重构挑战](https://twitter.com/jimmykoppel/status/1742794903216689212)中的任何一个。但如果你是完全缺乏库存的人，我可以看到它们作为很好的训练轮来使用。

但然后他花了书的2/3的篇幅讨论如何安排整理时间，如何减少耦合度以及做出决策可逆的好处，以及其他与删除无用注释和添加空行以分割代码无关的事情。感觉他有点像写了一本关于这些浅显整理的书，然后又写了一本关于深层重构的书，然后不小心把章节搞混了。

然后当我问他关于这个问题时，他实际上说我是对的，但应该等待他的下一本书：“我从底层向上提供概念——整理——和从顶层向下提供理论。我*会*在中间见面，我保证。”他正在追求这种策略，因为：“我认为让人们有意识地设计一年是准备好理解下一层的好方法。”

也许他设想读者随着系列作品的成熟而成长，从微小的代码改进到团队的协调？也许我对其他人的看法比他高，但我不明白他如何在向高级工程师推广的同时说出这些话。

如果你读了这本书，我建议只是浏览第一部分的整理清单，并弄清楚每样东西是什么。他确实稍后说了一些关于如何发送代码审查整理清单以及为什么它们提供价值的内容，但我预计大多数读者在几次尝试后也能自己得出相同的见解。

但实际上，有趣的内容可以缩短为推文列表。我已经在[这里](https://twitter.com/jimmykoppel/status/1770028266017239059)做了。

肯特·贝克是一位相当著名的软件工程师，他创造了测试驱动开发、极限编程和JUnit。他的Substack有很多我喜欢的作品，比如他关于[bitemporality](https://tidyfirst.substack.com/p/eventual-business-consistency)和[衡量开发者生产力](https://tidyfirst.substack.com/p/measuring-developer-productivity)的文章。在我们的互动中，他一直是绅士的榜样，并且写下了使他如此的见解。总的来说，他有很多有趣的观点，无论是关于软件工程还是处理人与情感的。但你在这本书中找不到它们。

所以，如果你考虑购买这本书，不如直接订阅他的Substack。他会赚更多，你会学到更多。唯一吃亏的是出版商。

*感谢[Hillel Wayne](https://www.hillelwayne.com/)在本文早期草稿中的评论。*
